(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.KuboRpcClient = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var KuboRpcClient=(()=>{var Hu=Object.create;var zr=Object.defineProperty;var Gu=Object.getOwnPropertyDescriptor;var qu=Object.getOwnPropertyNames;var Wu=Object.getPrototypeOf,Ju=Object.prototype.hasOwnProperty;var pe=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),B=(e,r)=>{for(var t in r)zr(e,t,{get:r[t],enumerable:!0})},Do=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of qu(r))!Ju.call(e,o)&&o!==t&&zr(e,o,{get:()=>r[o],enumerable:!(n=Gu(r,o))||n.enumerable});return e};var Pe=(e,r,t)=>(t=e!=null?Hu(Wu(e)):{},Do(r||!e||!e.__esModule?zr(t,"default",{value:e,enumerable:!0}):t,e)),Ku=e=>Do(zr({},"__esModule",{value:!0}),e);var Yi=pe((Dw,Qi)=>{function sp(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}Qi.exports=sp});var _r=pe((jw,oa)=>{"use strict";function na(e,r){for(let t in r)Object.defineProperty(e,t,{value:r[t],enumerable:!0,configurable:!0});return e}function ip(e,r,t){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof r=="object"&&(t=r,r=""),r&&(t.code=r);try{return na(e,t)}catch{t.message=e.message,t.stack=e.stack;let o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(e)),na(new o,t)}}oa.exports=ip});var ic=pe((R1,sc)=>{var cr=1e3,ur=cr*60,fr=ur*60,je=fr*24,Np=je*7,Bp=je*365.25;sc.exports=function(e,r){r=r||{};var t=typeof e;if(t==="string"&&e.length>0)return Rp(e);if(t==="number"&&isFinite(e))return r.long?$p(e):Dp(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Rp(e){if(e=String(e),!(e.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*Bp;case"weeks":case"week":case"w":return t*Np;case"days":case"day":case"d":return t*je;case"hours":case"hour":case"hrs":case"hr":case"h":return t*fr;case"minutes":case"minute":case"mins":case"min":case"m":return t*ur;case"seconds":case"second":case"secs":case"sec":case"s":return t*cr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Dp(e){var r=Math.abs(e);return r>=je?Math.round(e/je)+"d":r>=fr?Math.round(e/fr)+"h":r>=ur?Math.round(e/ur)+"m":r>=cr?Math.round(e/cr)+"s":e+"ms"}function $p(e){var r=Math.abs(e);return r>=je?Ct(e,r,je,"day"):r>=fr?Ct(e,r,fr,"hour"):r>=ur?Ct(e,r,ur,"minute"):r>=cr?Ct(e,r,cr,"second"):e+" ms"}function Ct(e,r,t,n){var o=r>=t*1.5;return Math.round(e/t)+" "+n+(o?"s":"")}});var cc=pe((D1,ac)=>{function Lp(e){t.debug=t,t.default=t,t.coerce=f,t.disable=s,t.enable=o,t.enabled=i,t.humanize=ic(),t.destroy=g,Object.keys(e).forEach(l=>{t[l]=e[l]}),t.names=[],t.skips=[],t.formatters={};function r(l){let m=0;for(let E=0;E<l.length;E++)m=(m<<5)-m+l.charCodeAt(E),m|=0;return t.colors[Math.abs(m)%t.colors.length]}t.selectColor=r;function t(l){let m,E=null,v,x;function A(...U){if(!A.enabled)return;let T=A,M=Number(new Date),Y=M-(m||M);T.diff=Y,T.prev=m,T.curr=M,m=M,U[0]=t.coerce(U[0]),typeof U[0]!="string"&&U.unshift("%O");let L=0;U[0]=U[0].replace(/%([a-zA-Z%])/g,(Z,H)=>{if(Z==="%%")return"%";L++;let ee=t.formatters[H];if(typeof ee=="function"){let Me=U[L];Z=ee.call(T,Me),U.splice(L,1),L--}return Z}),t.formatArgs.call(T,U),(T.log||t.log).apply(T,U)}return A.namespace=l,A.useColors=t.useColors(),A.color=t.selectColor(l),A.extend=n,A.destroy=t.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(v!==t.namespaces&&(v=t.namespaces,x=t.enabled(l)),x),set:U=>{E=U}}),typeof t.init=="function"&&t.init(A),A}function n(l,m){let E=t(this.namespace+(typeof m>"u"?":":m)+l);return E.log=this.log,E}function o(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let m,E=(typeof l=="string"?l:"").split(/[\s,]+/),v=E.length;for(m=0;m<v;m++)E[m]&&(l=E[m].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.slice(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...t.names.map(a),...t.skips.map(a).map(m=>"-"+m)].join(",");return t.enable(""),l}function i(l){if(l[l.length-1]==="*")return!0;let m,E;for(m=0,E=t.skips.length;m<E;m++)if(t.skips[m].test(l))return!1;for(m=0,E=t.names.length;m<E;m++)if(t.names[m].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function f(l){return l instanceof Error?l.stack||l.message:l}function g(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}ac.exports=Lp});var uc=pe((K,It)=>{K.formatArgs=Op;K.save=jp;K.load=Mp;K.useColors=Fp;K.storage=zp();K.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();K.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Fp(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Op(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+It.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;e.splice(1,0,r,"color: inherit");let t=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),e.splice(n,0,r)}K.log=console.debug||console.log||(()=>{});function jp(e){try{e?K.storage.setItem("debug",e):K.storage.removeItem("debug")}catch{}}function Mp(){let e;try{e=K.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function zp(){try{return localStorage}catch{}}It.exports=cc()(K);var{formatters:Vp}=It.exports;Vp.j=function(e){try{return JSON.stringify(e)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}});var lc=pe((j1,fc)=>{"use strict";fc.exports=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let r=Object.getPrototypeOf(e);return r===null||r===Object.prototype}});var yc=pe((hc,gc)=>{"use strict";var vt=lc(),{hasOwnProperty:pc}=Object.prototype,{propertyIsEnumerable:Gp}=Object,dr=(e,r,t)=>Object.defineProperty(e,r,{value:t,writable:!0,enumerable:!0,configurable:!0}),qp=hc,dc={concatArrays:!1,ignoreUndefined:!1},Ut=e=>{let r=[];for(let t in e)pc.call(e,t)&&r.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(e);for(let n of t)Gp.call(e,n)&&r.push(n)}return r};function pr(e){return Array.isArray(e)?Wp(e):vt(e)?Jp(e):e}function Wp(e){let r=e.slice(0,0);return Ut(e).forEach(t=>{dr(r,t,pr(e[t]))}),r}function Jp(e){let r=Object.getPrototypeOf(e)===null?Object.create(null):{};return Ut(e).forEach(t=>{dr(r,t,pr(e[t]))}),r}var mc=(e,r,t,n)=>(t.forEach(o=>{typeof r[o]>"u"&&n.ignoreUndefined||(o in e&&e[o]!==Object.getPrototypeOf(e)?dr(e,o,yo(e[o],r[o],n)):dr(e,o,pr(r[o])))}),e),Kp=(e,r,t)=>{let n=e.slice(0,0),o=0;return[e,r].forEach(s=>{let i=[];for(let a=0;a<s.length;a++)pc.call(s,a)&&(i.push(String(a)),s===e?dr(n,o++,s[a]):dr(n,o++,pr(s[a])));n=mc(n,s,Ut(s).filter(a=>!i.includes(a)),t)}),n};function yo(e,r,t){return t.concatArrays&&Array.isArray(e)&&Array.isArray(r)?Kp(e,r,t):!vt(r)||!vt(e)?pr(r):mc(e,r,Ut(r),t)}gc.exports=function(...e){let r=yo(pr(dc),this!==qp&&this||{},dc),t={_:{}};for(let n of e)if(n!==void 0){if(!vt(n))throw new TypeError("`"+n+"` is not an Option Object");t=yo(t,{_:n},r)}return t._}});var xo=pe((H1,Pc)=>{"use strict";var Qp=typeof navigator<"u"&&navigator.product==="ReactNative";function Yp(){return Qp?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var Or=self.URL,Sc=Yp(),wo=class{constructor(r="",t=Sc){this.super=new Or(r,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(r){this.super.hash=r}set host(r){this.super.host=r}set hostname(r){this.super.hostname=r}set href(r){this.super.href=r}set password(r){this.super.password=r}set pathname(r){this.super.pathname=r}set port(r){this.super.port=r}set protocol(r){this.super.protocol=r}set search(r){this.super.search=r}set username(r){this.super.username=r}static createObjectURL(r){return Or.createObjectURL(r)}static revokeObjectURL(r){Or.revokeObjectURL(r)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Zp(e){if(typeof e=="string")return new Or(e).toString();if(!(e instanceof Or)){let r=e.username&&e.password?`${e.username}:${e.password}@`:"",t=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",o=e.protocol?e.protocol+"//":"",s=e.host||"",i=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),f=e.hash||"",g=e.pathname||"",l=e.path||g+a;return`${o}${r||t}${s||i+n}${l}${f}`}}Pc.exports={URLWithLegacySupport:wo,URLSearchParams:self.URLSearchParams,defaultBase:Sc,format:Zp}});var Ic=pe((G1,Cc)=>{"use strict";var{URLWithLegacySupport:Ac,format:em}=xo();Cc.exports=(e,r={},t={},n)=>{let o=r.protocol?r.protocol.replace(":",""):"http";o=(t[o]||n||o)+":";let s;try{s=new Ac(e)}catch{s={}}let i=Object.assign({},r,{protocol:o||s.protocol,host:r.host||s.host});return new Ac(e,em(i)).toString()}});var Uc=pe((q1,vc)=>{"use strict";var{URLWithLegacySupport:rm,format:tm,URLSearchParams:nm,defaultBase:om}=xo(),sm=Ic();vc.exports={URL:rm,URLSearchParams:nm,format:tm,relative:sm,defaultBase:om}});var $m={};B($m,{CID:()=>p,RoutingEventTypes:()=>uo,RoutingMessageType:()=>fo,create:()=>Rm,createBitswap:()=>to,createBlock:()=>no,createBootstrap:()=>oo,createConfig:()=>so,createDAG:()=>co,createDHT:()=>lo,createDiag:()=>po,createFiles:()=>ho,createKey:()=>go,createLog:()=>Ao,createName:()=>Co,createObject:()=>Io,createPin:()=>vo,createPubsub:()=>Uo,createRefs:()=>To,createRepo:()=>ko,createRouting:()=>_o,createStats:()=>No,createSwarm:()=>Bo,multiaddr:()=>I,readURLContent:()=>Vu,urlSource:()=>Dm});var $o=Symbol.for("@libp2p/peer-id");var V=class extends Error{code;props;constructor(r,t,n){super(r),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}};var Wt={};B(Wt,{base58btc:()=>R,base58flickr:()=>rf});var jm=new Uint8Array(0);function Lo(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function ie(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function Fo(e){return new TextEncoder().encode(e)}function Oo(e){return new TextDecoder().decode(e)}function Xu(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(t[i]!==255)throw new TypeError(s+" is ambiguous");t[i]=o}var a=e.length,f=e.charAt(0),g=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function m(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var A=0,U=0,T=0,M=x.length;T!==M&&x[T]===0;)T++,A++;for(var Y=(M-T)*l+1>>>0,L=new Uint8Array(Y);T!==M;){for(var se=x[T],Z=0,H=Y-1;(se!==0||Z<U)&&H!==-1;H--,Z++)se+=256*L[H]>>>0,L[H]=se%a>>>0,se=se/a>>>0;if(se!==0)throw new Error("Non-zero carry");U=Z,T++}for(var ee=Y-U;ee!==Y&&L[ee]===0;)ee++;for(var Me=f.repeat(A);ee<Y;++ee)Me+=e.charAt(L[ee]);return Me}function E(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var A=0;if(x[A]!==" "){for(var U=0,T=0;x[A]===f;)U++,A++;for(var M=(x.length-A)*g+1>>>0,Y=new Uint8Array(M);x[A];){var L=t[x.charCodeAt(A)];if(L===255)return;for(var se=0,Z=M-1;(L!==0||se<T)&&Z!==-1;Z--,se++)L+=a*Y[Z]>>>0,Y[Z]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");T=se,A++}if(x[A]!==" "){for(var H=M-T;H!==M&&Y[H]===0;)H++;for(var ee=new Uint8Array(U+(M-H)),Me=U;H!==M;)ee[Me++]=Y[H++];return ee}}}function v(x){var A=E(x);if(A)return A;throw new Error(`Non-${r} character`)}return{encode:m,decodeUnsafe:E,decode:v}}var Qu=Xu,Yu=Qu,Mo=Yu;var Vt=class{name;prefix;baseEncode;constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}},Ht=class{name;prefix;baseDecode;prefixCodePoint;constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return zo(this,r)}},Gt=class{decoders;constructor(r){this.decoders=r}or(r){return zo(this,r)}decode(r){let t=r[0],n=this.decoders[t];if(n!=null)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function zo(e,r){return new Gt({...e.decoders??{[e.prefix]:e},...r.decoders??{[r.prefix]:r}})}var qt=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(r,t,n,o){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new Vt(r,t,n),this.decoder=new Ht(r,t,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}};function ze({name:e,prefix:r,encode:t,decode:n}){return new qt(e,r,t,n)}function Ae({name:e,prefix:r,alphabet:t}){let{encode:n,decode:o}=Mo(t,e);return ze({prefix:r,name:e,encode:n,decode:s=>ie(o(s))})}function Zu(e,r,t,n){let o={};for(let l=0;l<r.length;++l)o[r[l]]=l;let s=e.length;for(;e[s-1]==="=";)--s;let i=new Uint8Array(s*t/8|0),a=0,f=0,g=0;for(let l=0;l<s;++l){let m=o[e[l]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<t|m,a+=t,a>=8&&(a-=8,i[g++]=255&f>>a)}if(a>=t||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return i}function ef(e,r,t){let n=r[r.length-1]==="=",o=(1<<t)-1,s="",i=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],i+=8;i>t;)i-=t,s+=r[o&a>>i];if(i!==0&&(s+=r[o&a<<t-i]),n)for(;s.length*t&7;)s+="=";return s}function k({name:e,prefix:r,bitsPerChar:t,alphabet:n}){return ze({prefix:r,name:e,encode(o){return ef(o,n,t)},decode(o){return Zu(o,n,t,e)}})}var R=Ae({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),rf=Ae({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Jt={};B(Jt,{base32:()=>ae,base32hex:()=>sf,base32hexpad:()=>cf,base32hexpadupper:()=>uf,base32hexupper:()=>af,base32pad:()=>nf,base32padupper:()=>of,base32upper:()=>tf,base32z:()=>ff});var ae=k({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),tf=k({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),nf=k({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),of=k({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),sf=k({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),af=k({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cf=k({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),uf=k({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ff=k({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var lf=Go,Vo=128,df=127,pf=~df,mf=Math.pow(2,31);function Go(e,r,t){r=r||[],t=t||0;for(var n=t;e>=mf;)r[t++]=e&255|Vo,e/=128;for(;e&pf;)r[t++]=e&255|Vo,e>>>=7;return r[t]=e|0,Go.bytes=t-n+1,r}var hf=Kt,gf=128,Ho=127;function Kt(e,n){var t=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw Kt.bytes=0,new RangeError("Could not decode varint");i=e[s++],t+=o<28?(i&Ho)<<o:(i&Ho)*Math.pow(2,o),o+=7}while(i>=gf);return Kt.bytes=s-n,t}var yf=Math.pow(2,7),wf=Math.pow(2,14),xf=Math.pow(2,21),bf=Math.pow(2,28),Ef=Math.pow(2,35),Sf=Math.pow(2,42),Pf=Math.pow(2,49),Af=Math.pow(2,56),Cf=Math.pow(2,63),If=function(e){return e<yf?1:e<wf?2:e<xf?3:e<bf?4:e<Ef?5:e<Sf?6:e<Pf?7:e<Af?8:e<Cf?9:10},vf={encode:lf,decode:hf,encodingLength:If},Uf=vf,xr=Uf;function br(e,r=0){return[xr.decode(e,r),xr.decode.bytes]}function Ve(e,r,t=0){return xr.encode(e,r,t),r}function He(e){return xr.encodingLength(e)}function Ce(e,r){let t=r.byteLength,n=He(e),o=n+He(t),s=new Uint8Array(o+t);return Ve(e,s,0),Ve(t,s,n),s.set(r,o),new Ge(e,t,r,s)}function Ne(e){let r=ie(e),[t,n]=br(r),[o,s]=br(r.subarray(n)),i=r.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Ge(t,o,i,r)}function qo(e,r){if(e===r)return!0;{let t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&Lo(e.bytes,t.bytes)}}var Ge=class{code;size;digest;bytes;constructor(r,t,n,o){this.code=r,this.size=t,this.digest=n,this.bytes=o}};function Wo(e,r){let{bytes:t,version:n}=e;switch(n){case 0:return kf(t,Xt(e),r??R.encoder);default:return _f(t,Xt(e),r??ae.encoder)}}var Jo=new WeakMap;function Xt(e){let r=Jo.get(e);if(r==null){let t=new Map;return Jo.set(e,t),t}return r}var p=class e{code;version;multihash;bytes;"/";constructor(r,t,n,o){this.code=t,this.version=r,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:r,multihash:t}=this;if(r!==Er)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Nf)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:r,digest:t}=this.multihash,n=Ce(r,t);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return e.equals(this,r)}static equals(r,t){let n=t;return n!=null&&r.code===n.code&&r.version===n.version&&qo(r.multihash,n.multihash)}toString(r){return Wo(this,r)}toJSON(){return{"/":Wo(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(r){if(r==null)return null;let t=r;if(t instanceof e)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:o,multihash:s,bytes:i}=t;return new e(n,o,s,i??Ko(n,o,s.bytes))}else if(t[Bf]===!0){let{version:n,multihash:o,code:s}=t,i=Ne(o);return e.create(n,s,i)}else return null}static create(r,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:{if(t!==Er)throw new Error(`Version 0 CID must use dag-pb (code: ${Er}) block encoding`);return new e(r,t,n,n.bytes)}case 1:{let o=Ko(r,t,n.bytes);return new e(r,t,n,o)}default:throw new Error("Invalid version")}}static createV0(r){return e.create(0,Er,r)}static createV1(r,t){return e.create(1,r,t)}static decode(r){let[t,n]=e.decodeFirst(r);if(n.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(r){let t=e.inspectBytes(r),n=t.size-t.multihashSize,o=ie(r.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=o.subarray(t.multihashSize-t.digestSize),i=new Ge(t.multihashCode,t.digestSize,s,o);return[t.version===0?e.createV0(i):e.createV1(t.codec,i),r.subarray(t.size)]}static inspectBytes(r){let t=0,n=()=>{let[m,E]=br(r.subarray(t));return t+=E,m},o=n(),s=Er;if(o===18?(o=0,t=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=t,a=n(),f=n(),g=t+f,l=g-i;return{version:o,codec:s,multihashCode:a,digestSize:f,multihashSize:l,size:g}}static parse(r,t){let[n,o]=Tf(r,t),s=e.decode(o);if(s.version===0&&r[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Xt(s).set(n,r),s}};function Tf(e,r){switch(e[0]){case"Q":{let t=r??R;return[R.prefix,t.decode(`${R.prefix}${e}`)]}case R.prefix:{let t=r??R;return[R.prefix,t.decode(e)]}case ae.prefix:{let t=r??ae;return[ae.prefix,t.decode(e)]}default:{if(r==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}}}function kf(e,r,t){let{prefix:n}=t;if(n!==R.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let o=r.get(n);if(o==null){let s=t.encode(e).slice(1);return r.set(n,s),s}else return o}function _f(e,r,t){let{prefix:n}=t,o=r.get(n);if(o==null){let s=t.encode(e);return r.set(n,s),s}else return o}var Er=112,Nf=18;function Ko(e,r,t){let n=He(e),o=n+He(r),s=new Uint8Array(o+t.byteLength);return Ve(e,s,0),Ve(r,s,n),s.set(t,o),s}var Bf=Symbol.for("@ipld/js-cid/CID");function Sr(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}var Qt={};B(Qt,{base10:()=>Rf});var Rf=Ae({prefix:"9",name:"base10",alphabet:"0123456789"});var Yt={};B(Yt,{base16:()=>Df,base16upper:()=>$f});var Df=k({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),$f=k({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Zt={};B(Zt,{base2:()=>Lf});var Lf=k({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var en={};B(en,{base256emoji:()=>zf});var Xo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ff=Xo.reduce((e,r,t)=>(e[t]=r,e),[]),Of=Xo.reduce((e,r,t)=>(e[r.codePointAt(0)]=t,e),[]);function jf(e){return e.reduce((r,t)=>(r+=Ff[t],r),"")}function Mf(e){let r=[];for(let t of e){let n=Of[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}var zf=ze({prefix:"\u{1F680}",name:"base256emoji",encode:jf,decode:Mf});var rn={};B(rn,{base36:()=>Vf,base36upper:()=>Hf});var Vf=Ae({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hf=Ae({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var tn={};B(tn,{base64:()=>qe,base64pad:()=>Gf,base64url:()=>Ie,base64urlpad:()=>qf});var qe=k({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Gf=k({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ie=k({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qf=k({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var nn={};B(nn,{base8:()=>Wf});var Wf=k({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var on={};B(on,{identity:()=>Jf});var Jf=ze({prefix:"\0",name:"identity",encode:e=>Oo(e),decode:e=>Fo(e)});var sn={};B(sn,{code:()=>Yf,decode:()=>el,encode:()=>Zf,name:()=>Qf});var Kf=new TextEncoder,Xf=new TextDecoder,Qf="json",Yf=512;function Zf(e){return Kf.encode(JSON.stringify(e))}function el(e){return JSON.parse(Xf.decode(e))}var an={};B(an,{code:()=>tl,decode:()=>ol,encode:()=>nl,name:()=>rl});var rl="raw",tl=85;function nl(e){return ie(e)}function ol(e){return ie(e)}var cn={};B(cn,{identity:()=>Re});var Qo=0,sl="identity",Yo=ie;function il(e){return Ce(Qo,Yo(e))}var Re={code:Qo,name:sl,encode:Yo,digest:il};var ln={};B(ln,{sha256:()=>Hr,sha512:()=>al});function fn({name:e,code:r,encode:t}){return new un(e,r,t)}var un=class{name;code;encode;constructor(r,t,n){this.name=r,this.code=t,this.encode=n}digest(r){if(r instanceof Uint8Array){let t=this.encode(r);return t instanceof Uint8Array?Ce(this.code,t):t.then(n=>Ce(this.code,n))}else throw Error("Unknown type, must be binary type")}};function es(e){return async r=>new Uint8Array(await crypto.subtle.digest(e,r))}var Hr=fn({name:"sha2-256",code:18,encode:es("SHA-256")}),al=fn({name:"sha2-512",code:19,encode:es("SHA-512")});var me={...on,...Zt,...nn,...Qt,...Yt,...Jt,...rn,...Wt,...tn,...en},rs={...ln,...cn},ts={raw:an,json:sn};function We(e=0){return new Uint8Array(e)}function os(e,r,t,n){return{name:e,prefix:r,encoder:{name:e,prefix:r,encode:t},decoder:{decode:n}}}var ns=os("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),dn=os("ascii","a",e=>{let r="a";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},e=>{e=e.substring(1);let r=We(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}),cl={utf8:ns,"utf-8":ns,hex:me.base16,latin1:dn,ascii:dn,binary:dn,...me},Gr=cl;function _(e,r="utf8"){let t=Gr[r];if(t==null)throw new Error(`Unsupported encoding "${r}"`);return t.encoder.encode(e).substring(1)}var ul=Math.pow(2,7),fl=Math.pow(2,14),ll=Math.pow(2,21),pn=Math.pow(2,28),mn=Math.pow(2,35),hn=Math.pow(2,42),gn=Math.pow(2,49),C=128,O=127;function he(e){if(e<ul)return 1;if(e<fl)return 2;if(e<ll)return 3;if(e<pn)return 4;if(e<mn)return 5;if(e<hn)return 6;if(e<gn)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function dl(e,r,t=0){switch(he(e)){case 8:r[t++]=e&255|C,e/=128;case 7:r[t++]=e&255|C,e/=128;case 6:r[t++]=e&255|C,e/=128;case 5:r[t++]=e&255|C,e/=128;case 4:r[t++]=e&255|C,e>>>=7;case 3:r[t++]=e&255|C,e>>>=7;case 2:r[t++]=e&255|C,e>>>=7;case 1:{r[t++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return r}function pl(e,r,t=0){switch(he(e)){case 8:r.set(t++,e&255|C),e/=128;case 7:r.set(t++,e&255|C),e/=128;case 6:r.set(t++,e&255|C),e/=128;case 5:r.set(t++,e&255|C),e/=128;case 4:r.set(t++,e&255|C),e>>>=7;case 3:r.set(t++,e&255|C),e>>>=7;case 2:r.set(t++,e&255|C),e>>>=7;case 1:{r.set(t++,e&255),e>>>=7;break}default:throw new Error("unreachable")}return r}function ml(e,r){let t=e[r],n=0;if(n+=t&O,t<C||(t=e[r+1],n+=(t&O)<<7,t<C)||(t=e[r+2],n+=(t&O)<<14,t<C)||(t=e[r+3],n+=(t&O)<<21,t<C)||(t=e[r+4],n+=(t&O)*pn,t<C)||(t=e[r+5],n+=(t&O)*mn,t<C)||(t=e[r+6],n+=(t&O)*hn,t<C)||(t=e[r+7],n+=(t&O)*gn,t<C))return n;throw new RangeError("Could not decode varint")}function hl(e,r){let t=e.get(r),n=0;if(n+=t&O,t<C||(t=e.get(r+1),n+=(t&O)<<7,t<C)||(t=e.get(r+2),n+=(t&O)<<14,t<C)||(t=e.get(r+3),n+=(t&O)<<21,t<C)||(t=e.get(r+4),n+=(t&O)*pn,t<C)||(t=e.get(r+5),n+=(t&O)*mn,t<C)||(t=e.get(r+6),n+=(t&O)*hn,t<C)||(t=e.get(r+7),n+=(t&O)*gn,t<C))return n;throw new RangeError("Could not decode varint")}function Je(e,r,t=0){return r==null&&(r=We(he(e))),r instanceof Uint8Array?dl(e,r,t):pl(e,r,t)}function De(e,r=0){return e instanceof Uint8Array?ml(e,r):hl(e,r)}function ye(e,r){r==null&&(r=e.reduce((o,s)=>o+s.length,0));let t=We(r),n=0;for(let o of e)t.set(o,n),n+=o.length;return t}var qr=class{index=0;input="";new(r){return this.index=0,this.input=r,this}readAtomically(r){let t=this.index,n=r();return n===void 0&&(this.index=t),n}parseWith(r){let t=r();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(r){return this.readAtomically(()=>{let t=this.readChar();if(t===r)return t})}readSeparator(r,t,n){return this.readAtomically(()=>{if(!(t>0&&this.readGivenChar(r)===void 0))return n()})}readNumber(r,t,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let f=a==="0",g=2**(8*o)-1;for(;;){let l=this.readAtomically(()=>{let m=this.readChar();if(m===void 0)return;let E=Number.parseInt(m,r);if(!Number.isNaN(E))return E});if(l===void 0)break;if(s*=r,s+=l,s>g||(i+=1,t!==void 0&&i>t))return}if(i!==0)return!n&&f&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let r=new Uint8Array(4);for(let t=0;t<r.length;t++){let n=this.readSeparator(".",t,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;r[t]=n}return r})}readIPv6Addr(){let r=t=>{for(let n=0;n<t.length/2;n++){let o=n*2;if(n<t.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return t[o]=i[0],t[o+1]=i[1],t[o+2]=i[2],t[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];t[o]=s>>8,t[o+1]=s&255}return[t.length,!1]};return this.readAtomically(()=>{let t=new Uint8Array(16),[n,o]=r(t);if(n===16)return t;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=r(s.subarray(0,i));return t.set(s.subarray(0,a),16-a),t})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var is=45,gl=15,Ke=new qr;function yn(e){if(!(e.length>gl))return Ke.new(e).parseWith(()=>Ke.readIPv4Addr())}function wn(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>is))return Ke.new(e).parseWith(()=>Ke.readIPv6Addr())}function Wr(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>is))return Ke.new(e).parseWith(()=>Ke.readIPAddr())}var Gh=parseInt("0xFFFF",16),qh=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function we(e,r="utf8"){let t=Gr[r];if(t==null)throw new Error(`Unsupported encoding "${r}"`);return t.decoder.decode(`${t.prefix}${e}`)}function us(e){return!!yn(e)}function fs(e){return!!wn(e)}function Jr(e){return!!Wr(e)}var ls=us,El=fs,xn=function(e){let r=0;if(e=e.toString().trim(),ls(e)){let t=new Uint8Array(r+4);return e.split(/\./g).forEach(n=>{t[r++]=parseInt(n,10)&255}),t}if(El(e)){let t=e.split(":",8),n;for(n=0;n<t.length;n++){let s=ls(t[n]),i;s&&(i=xn(t[n]),t[n]=_(i.slice(0,2),"base16")),i!=null&&++n<8&&t.splice(n,0,_(i.slice(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&t[n]!=="";n++);let s=[n,1];for(n=9-t.length;n>0;n--)s.push("0");t.splice.apply(t,s)}let o=new Uint8Array(r+16);for(n=0;n<t.length;n++){let s=parseInt(t[n],16);o[r++]=s>>8&255,o[r++]=s&255}return o}throw new Error("invalid ip address")},ds=function(e,r=0,t){r=~~r,t=t??e.length-r;let n=new DataView(e.buffer);if(t===4){let o=[];for(let s=0;s<t;s++)o.push(e[r+s]);return o.join(".")}if(t===16){let o=[];for(let s=0;s<t;s+=2)o.push(n.getUint16(r+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Xe={},bn={},Pl=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Pl.forEach(e=>{let r=Al(...e);bn[r.code]=r,Xe[r.name]=r});function Al(e,r,t,n,o){return{code:e,size:r,name:t,resolvable:!!n,path:!!o}}function w(e){if(typeof e=="number"){if(bn[e]!=null)return bn[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Xe[e]!=null)return Xe[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var _g=w("ip4"),Ng=w("ip6"),Bg=w("ipcidr");function Sn(e,r){switch(w(e).code){case 4:case 41:return Il(r);case 42:return hs(r);case 6:case 273:case 33:case 132:return ys(r).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return hs(r);case 421:return kl(r);case 444:return gs(r);case 445:return gs(r);case 466:return Tl(r);default:return _(r,"base16")}}function Pn(e,r){switch(w(e).code){case 4:return ps(r);case 41:return ps(r);case 42:return ms(r);case 6:case 273:case 33:case 132:return An(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return ms(r);case 421:return vl(r);case 444:return _l(r);case 445:return Nl(r);case 466:return Ul(r);default:return we(r,"base16")}}var En=Object.values(me).map(e=>e.decoder),Cl=function(){let e=En[0].or(En[1]);return En.slice(2).forEach(r=>e=e.or(r)),e}();function ps(e){if(!Jr(e))throw new Error("invalid ip address");return xn(e)}function Il(e){let r=ds(e,0,e.length);if(r==null)throw new Error("ipBuff is required");if(!Jr(r))throw new Error("invalid ip address");return r}function An(e){let r=new ArrayBuffer(2);return new DataView(r).setUint16(0,e),new Uint8Array(r)}function ys(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function ms(e){let r=we(e),t=Uint8Array.from(Je(r.length));return ye([t,r],t.length+r.length)}function hs(e){let r=De(e);if(e=e.slice(he(r)),e.length!==r)throw new Error("inconsistent lengths");return _(e)}function vl(e){let r;e[0]==="Q"||e[0]==="1"?r=Ne(R.decode(`z${e}`)).bytes:r=p.parse(e).multihash.bytes;let t=Uint8Array.from(Je(r.length));return ye([t,r],t.length+r.length)}function Ul(e){let r=Cl.decode(e),t=Uint8Array.from(Je(r.length));return ye([t,r],t.length+r.length)}function Tl(e){let r=De(e),t=e.slice(he(r));if(t.length!==r)throw new Error("inconsistent lengths");return"u"+_(t,"base64url")}function kl(e){let r=De(e),t=e.slice(he(r));if(t.length!==r)throw new Error("inconsistent lengths");return _(t,"base58btc")}function _l(e){let r=e.split(":");if(r.length!==2)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(r[0].length!==16)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion address.`);let t=ae.decode("b"+r[0]),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=An(n);return ye([t,o],t.length+o.length)}function Nl(e){let r=e.split(":");if(r.length!==2)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(r[0].length!==56)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion3 address.`);let t=ae.decode(`b${r[0]}`),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=An(n);return ye([t,o],t.length+o.length)}function gs(e){let r=e.slice(0,e.length-2),t=e.slice(e.length-2),n=_(r,"base32"),o=ys(t);return`${n}:${o}`}function ws(e){e=Cn(e);let r=[],t=[],n=null,o=e.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=w(i);if(a.size===0){r.push([a.code]),t.push([a.code]);continue}if(s++,s>=o.length)throw bs("invalid address: "+e);if(a.path===!0){n=Cn(o.slice(s).join("/")),r.push([a.code,Pn(a.code,n)]),t.push([a.code,n]);break}let f=Pn(a.code,o[s]);r.push([a.code,f]),t.push([a.code,Sn(a.code,f)])}return{string:xs(t),bytes:vn(r),tuples:r,stringTuples:t,path:n}}function In(e){let r=[],t=[],n=null,o=0;for(;o<e.length;){let s=De(e,o),i=he(s),a=w(s),f=Bl(a,e.slice(o+i));if(f===0){r.push([s]),t.push([s]),o+=i;continue}let g=e.slice(o+i,o+i+f);if(o+=f+i,o>e.length)throw bs("Invalid address Uint8Array: "+_(e,"base16"));r.push([s,g]);let l=Sn(s,g);if(t.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(e),string:xs(t),tuples:r,stringTuples:t,path:n}}function xs(e){let r=[];return e.map(t=>{let n=w(t[0]);return r.push(n.name),t.length>1&&t[1]!=null&&r.push(t[1]),null}),Cn(r.join("/"))}function vn(e){return ye(e.map(r=>{let t=w(r[0]),n=Uint8Array.from(Je(t.code));return r.length>1&&r[1]!=null&&(n=ye([n,r[1]])),n}))}function Bl(e,r){if(e.size>0)return e.size/8;if(e.size===0)return 0;{let t=De(r instanceof Uint8Array?r:Uint8Array.from(r));return t+he(t)}}function Cn(e){return"/"+e.trim().split("/").filter(r=>r).join("/")}function bs(e){return new Error("Error parsing address: "+e)}var Rl=Symbol.for("nodejs.util.inspect.custom"),Un=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Dl=[w("dns").code,w("dns4").code,w("dns6").code,w("dnsaddr").code],Kr=class e{bytes;#r;#e;#t;#n;[Un]=!0;constructor(r){r==null&&(r="");let t;if(r instanceof Uint8Array)t=In(r);else if(typeof r=="string"){if(r.length>0&&r.charAt(0)!=="/")throw new Error(`multiaddr "${r}" must start with a "/"`);t=ws(r)}else if($e(r))t=In(r.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=t.bytes,this.#r=t.string,this.#e=t.tuples,this.#t=t.stringTuples,this.#n=t.path}toString(){return this.#r}toJSON(){return this.toString()}toOptions(){let r,t,n,o,s="",i=w("tcp"),a=w("udp"),f=w("ip4"),g=w("ip6"),l=w("dns6"),m=w("ip6zone");for(let[v,x]of this.stringTuples())v===m.code&&(s=`%${x??""}`),Dl.includes(v)&&(t=i.name,o=443,n=`${x??""}${s}`,r=v===l.code?6:4),(v===i.code||v===a.code)&&(t=w(v).name,o=parseInt(x??"")),(v===f.code||v===g.code)&&(t=w(v).name,n=`${x??""}${s}`,r=v===g.code?6:4);if(r==null||t==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:r,host:n,transport:t,port:o}}protos(){return this.#e.map(([r])=>Object.assign({},w(r)))}protoCodes(){return this.#e.map(([r])=>r)}protoNames(){return this.#e.map(([r])=>w(r).name)}tuples(){return this.#e}stringTuples(){return this.#t}encapsulate(r){return r=new e(r),new e(this.toString()+r.toString())}decapsulate(r){let t=r.toString(),n=this.toString(),o=n.lastIndexOf(t);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${r.toString()}`);return new e(n.slice(0,o))}decapsulateCode(r){let t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===r)return new e(vn(t.slice(0,n)));return this}getPeerId(){try{let r=[];this.stringTuples().forEach(([n,o])=>{n===Xe.p2p.code&&r.push([n,o]),n===Xe["p2p-circuit"].code&&(r=[])});let t=r.pop();if(t?.[1]!=null){let n=t[1];return n[0]==="Q"||n[0]==="1"?_(R.decode(`z${n}`),"base58btc"):_(p.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(r){return Sr(this.bytes,r.bytes)}async resolve(r){let t=this.protos().find(s=>s.resolvable);if(t==null)return[this];let n=Es.get(t.name);if(n==null)throw new V(`no available resolver for ${t.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,r)).map(s=>I(s))}nodeAddress(){let r=this.toOptions();if(r.transport!=="tcp"&&r.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${r.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:r.family,address:r.host,port:r.port}}isThinWaistAddress(r){let t=(r??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}[Rl](){return`Multiaddr(${this.#r})`}};var Es=new Map;function $e(e){return!!e?.[Un]}function I(e){return new Kr(e)}var ft={};B(ft,{code:()=>yd,decode:()=>jn,decodeOptions:()=>hd,encode:()=>On,encodeOptions:()=>pd,name:()=>gd,toByteView:()=>Ii});var $l=["string","number","bigint","symbol"],Ll=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Ss(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let r=typeof e;if($l.includes(r))return r;if(r==="function")return"Function";if(Array.isArray(e))return"Array";if(Fl(e))return"Buffer";let t=Ol(e);return t||"Object"}function Fl(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Ol(e){let r=Object.prototype.toString.call(e).slice(8,-1);if(Ll.includes(r))return r}var c=class{constructor(r,t,n){this.major=r,this.majorEncoded=r<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(r){return this.major<r.major?-1:this.major>r.major?1:0}};c.uint=new c(0,"uint",!0);c.negint=new c(1,"negint",!0);c.bytes=new c(2,"bytes",!0);c.string=new c(3,"string",!0);c.array=new c(4,"array",!1);c.map=new c(5,"map",!1);c.tag=new c(6,"tag",!1);c.float=new c(7,"float",!0);c.false=new c(7,"false",!0);c.true=new c(7,"true",!0);c.null=new c(7,"null",!0);c.undefined=new c(7,"undefined",!0);c.break=new c(7,"break",!0);var d=class{constructor(r,t,n){this.type=r,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var Qe=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",jl=new TextDecoder,Ml=new TextEncoder;function Xr(e){return Qe&&globalThis.Buffer.isBuffer(e)}function Pr(e){return e instanceof Uint8Array?Xr(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var Is=Qe?(e,r,t)=>t-r>64?globalThis.Buffer.from(e.subarray(r,t)).toString("utf8"):As(e,r,t):(e,r,t)=>t-r>64?jl.decode(e.subarray(r,t)):As(e,r,t),Qr=Qe?e=>e.length>64?globalThis.Buffer.from(e):Ps(e):e=>e.length>64?Ml.encode(e):Ps(e),ge=e=>Uint8Array.from(e),Ye=Qe?(e,r,t)=>Xr(e)?new Uint8Array(e.subarray(r,t)):e.slice(r,t):(e,r,t)=>e.slice(r,t),vs=Qe?(e,r)=>(e=e.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Pr(globalThis.Buffer.concat(e,r))):(e,r)=>{let t=new Uint8Array(r),n=0;for(let o of e)n+o.length>t.length&&(o=o.subarray(0,t.length-n)),t.set(o,n),n+=o.length;return t},Us=Qe?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Ts(e,r){if(Xr(e)&&Xr(r))return e.compare(r);for(let t=0;t<e.length;t++)if(e[t]!==r[t])return e[t]<r[t]?-1:1;return 0}function Ps(e){let r=[],t=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?r[t++]=o:o<2048?(r[t++]=o>>6|192,r[t++]=o&63|128):(o&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++n)&1023),r[t++]=o>>18|240,r[t++]=o>>12&63|128,r[t++]=o>>6&63|128,r[t++]=o&63|128):(r[t++]=o>>12|224,r[t++]=o>>6&63|128,r[t++]=o&63|128)}return r}function As(e,r,t){let n=[];for(;r<t;){let o=e[r],s=null,i=o>239?4:o>223?3:o>191?2:1;if(r+i<=t){let a,f,g,l;switch(i){case 1:o<128&&(s=o);break;case 2:a=e[r+1],(a&192)===128&&(l=(o&31)<<6|a&63,l>127&&(s=l));break;case 3:a=e[r+1],f=e[r+2],(a&192)===128&&(f&192)===128&&(l=(o&15)<<12|(a&63)<<6|f&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:a=e[r+1],f=e[r+2],g=e[r+3],(a&192)===128&&(f&192)===128&&(g&192)===128&&(l=(o&15)<<18|(a&63)<<12|(f&63)<<6|g&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,i=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),r+=i}return Tn(n)}var Cs=4096;function Tn(e){let r=e.length;if(r<=Cs)return String.fromCharCode.apply(String,e);let t="",n=0;for(;n<r;)t+=String.fromCharCode.apply(String,e.slice(n,n+=Cs));return t}var zl=256,Ar=class{constructor(r=zl){this.chunkSize=r,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(r){let t=this.chunks[this.chunks.length-1];if(this.cursor+r.length<=this.maxCursor+1){let o=t.length-(this.maxCursor-this.cursor)-1;t.set(r,o)}else{if(t){let o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}r.length<64&&r.length<this.chunkSize?(t=Us(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(r,0)):(this.chunks.push(r),this.maxCursor+=r.length)}this.cursor+=r.length}toBytes(r=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];r&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ye(n,0,this.cursor)}else t=vs(this.chunks,this.cursor);return r&&this.reset(),t}};var y="CBOR decode error:",xe="CBOR encode error:",Cr=[];Cr[23]=1;Cr[24]=2;Cr[25]=3;Cr[26]=5;Cr[27]=9;function be(e,r,t){if(e.length-r<t)throw new Error(`${y} not enough data for type`)}var D=[24,256,65536,4294967296,BigInt("18446744073709551616")];function G(e,r,t){be(e,r,1);let n=e[r];if(t.strict===!0&&n<D[0])throw new Error(`${y} integer encoded in more bytes than necessary (strict decode)`);return n}function q(e,r,t){be(e,r,2);let n=e[r]<<8|e[r+1];if(t.strict===!0&&n<D[1])throw new Error(`${y} integer encoded in more bytes than necessary (strict decode)`);return n}function W(e,r,t){be(e,r,4);let n=e[r]*16777216+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];if(t.strict===!0&&n<D[2])throw new Error(`${y} integer encoded in more bytes than necessary (strict decode)`);return n}function J(e,r,t){be(e,r,8);let n=e[r]*16777216+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3],o=e[r+4]*16777216+(e[r+5]<<16)+(e[r+6]<<8)+e[r+7],s=(BigInt(n)<<BigInt(32))+BigInt(o);if(t.strict===!0&&s<D[3])throw new Error(`${y} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(t.allowBigInt===!0)return s;throw new Error(`${y} integers outside of the safe integer range are not supported`)}function ks(e,r,t,n){return new d(c.uint,G(e,r+1,n),2)}function _s(e,r,t,n){return new d(c.uint,q(e,r+1,n),3)}function Ns(e,r,t,n){return new d(c.uint,W(e,r+1,n),5)}function Bs(e,r,t,n){return new d(c.uint,J(e,r+1,n),9)}function re(e,r){return F(e,0,r.value)}function F(e,r,t){if(t<D[0]){let n=Number(t);e.push([r|n])}else if(t<D[1]){let n=Number(t);e.push([r|24,n])}else if(t<D[2]){let n=Number(t);e.push([r|25,n>>>8,n&255])}else if(t<D[3]){let n=Number(t);e.push([r|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<D[4]){let o=[r|27,0,0,0,0,0,0,0],s=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=s&255,s=s>>8,o[7]=s&255,s=s>>8,o[6]=s&255,s=s>>8,o[5]=s&255,o[4]=i&255,i=i>>8,o[3]=i&255,i=i>>8,o[2]=i&255,i=i>>8,o[1]=i&255,e.push(o)}else throw new Error(`${y} encountered BigInt larger than allowable range`)}}re.encodedSize=function(r){return F.encodedSize(r.value)};F.encodedSize=function(r){return r<D[0]?1:r<D[1]?2:r<D[2]?3:r<D[3]?5:9};re.compareTokens=function(r,t){return r.value<t.value?-1:r.value>t.value?1:0};function Rs(e,r,t,n){return new d(c.negint,-1-G(e,r+1,n),2)}function Ds(e,r,t,n){return new d(c.negint,-1-q(e,r+1,n),3)}function $s(e,r,t,n){return new d(c.negint,-1-W(e,r+1,n),5)}var kn=BigInt(-1),Ls=BigInt(1);function Fs(e,r,t,n){let o=J(e,r+1,n);if(typeof o!="bigint"){let s=-1-o;if(s>=Number.MIN_SAFE_INTEGER)return new d(c.negint,s,9)}if(n.allowBigInt!==!0)throw new Error(`${y} integers outside of the safe integer range are not supported`);return new d(c.negint,kn-BigInt(o),9)}function Yr(e,r){let t=r.value,n=typeof t=="bigint"?t*kn-Ls:t*-1-1;F(e,r.type.majorEncoded,n)}Yr.encodedSize=function(r){let t=r.value,n=typeof t=="bigint"?t*kn-Ls:t*-1-1;return n<D[0]?1:n<D[1]?2:n<D[2]?3:n<D[3]?5:9};Yr.compareTokens=function(r,t){return r.value<t.value?1:r.value>t.value?-1:0};function Ir(e,r,t,n){be(e,r,t+n);let o=Ye(e,r+t,r+t+n);return new d(c.bytes,o,t+n)}function Os(e,r,t,n){return Ir(e,r,1,t)}function js(e,r,t,n){return Ir(e,r,2,G(e,r+1,n))}function Ms(e,r,t,n){return Ir(e,r,3,q(e,r+1,n))}function zs(e,r,t,n){return Ir(e,r,5,W(e,r+1,n))}function Vs(e,r,t,n){let o=J(e,r+1,n);if(typeof o=="bigint")throw new Error(`${y} 64-bit integer bytes lengths not supported`);return Ir(e,r,9,o)}function Zr(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===c.string?Qr(e.value):e.value),e.encodedBytes}function Ze(e,r){let t=Zr(r);F(e,r.type.majorEncoded,t.length),e.push(t)}Ze.encodedSize=function(r){let t=Zr(r);return F.encodedSize(t.length)+t.length};Ze.compareTokens=function(r,t){return Hl(Zr(r),Zr(t))};function Hl(e,r){return e.length<r.length?-1:e.length>r.length?1:Ts(e,r)}function vr(e,r,t,n,o){let s=t+n;be(e,r,s);let i=new d(c.string,Is(e,r+t,r+s),s);return o.retainStringBytes===!0&&(i.byteValue=Ye(e,r+t,r+s)),i}function Hs(e,r,t,n){return vr(e,r,1,t,n)}function Gs(e,r,t,n){return vr(e,r,2,G(e,r+1,n),n)}function qs(e,r,t,n){return vr(e,r,3,q(e,r+1,n),n)}function Ws(e,r,t,n){return vr(e,r,5,W(e,r+1,n),n)}function Js(e,r,t,n){let o=J(e,r+1,n);if(typeof o=="bigint")throw new Error(`${y} 64-bit integer string lengths not supported`);return vr(e,r,9,o,n)}var Ks=Ze;function er(e,r,t,n){return new d(c.array,n,t)}function Xs(e,r,t,n){return er(e,r,1,t)}function Qs(e,r,t,n){return er(e,r,2,G(e,r+1,n))}function Ys(e,r,t,n){return er(e,r,3,q(e,r+1,n))}function Zs(e,r,t,n){return er(e,r,5,W(e,r+1,n))}function ei(e,r,t,n){let o=J(e,r+1,n);if(typeof o=="bigint")throw new Error(`${y} 64-bit integer array lengths not supported`);return er(e,r,9,o)}function ri(e,r,t,n){if(n.allowIndefinite===!1)throw new Error(`${y} indefinite length items not allowed`);return er(e,r,1,1/0)}function et(e,r){F(e,c.array.majorEncoded,r.value)}et.compareTokens=re.compareTokens;et.encodedSize=function(r){return F.encodedSize(r.value)};function rr(e,r,t,n){return new d(c.map,n,t)}function ti(e,r,t,n){return rr(e,r,1,t)}function ni(e,r,t,n){return rr(e,r,2,G(e,r+1,n))}function oi(e,r,t,n){return rr(e,r,3,q(e,r+1,n))}function si(e,r,t,n){return rr(e,r,5,W(e,r+1,n))}function ii(e,r,t,n){let o=J(e,r+1,n);if(typeof o=="bigint")throw new Error(`${y} 64-bit integer map lengths not supported`);return rr(e,r,9,o)}function ai(e,r,t,n){if(n.allowIndefinite===!1)throw new Error(`${y} indefinite length items not allowed`);return rr(e,r,1,1/0)}function rt(e,r){F(e,c.map.majorEncoded,r.value)}rt.compareTokens=re.compareTokens;rt.encodedSize=function(r){return F.encodedSize(r.value)};function ci(e,r,t,n){return new d(c.tag,t,1)}function ui(e,r,t,n){return new d(c.tag,G(e,r+1,n),2)}function fi(e,r,t,n){return new d(c.tag,q(e,r+1,n),3)}function li(e,r,t,n){return new d(c.tag,W(e,r+1,n),5)}function di(e,r,t,n){return new d(c.tag,J(e,r+1,n),9)}function tt(e,r){F(e,c.tag.majorEncoded,r.value)}tt.compareTokens=re.compareTokens;tt.encodedSize=function(r){return F.encodedSize(r.value)};var Xl=20,Ql=21,Yl=22,Zl=23;function pi(e,r,t,n){if(n.allowUndefined===!1)throw new Error(`${y} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new d(c.null,null,1):new d(c.undefined,void 0,1)}function mi(e,r,t,n){if(n.allowIndefinite===!1)throw new Error(`${y} indefinite length items not allowed`);return new d(c.break,void 0,1)}function _n(e,r,t){if(t){if(t.allowNaN===!1&&Number.isNaN(e))throw new Error(`${y} NaN values are not supported`);if(t.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${y} Infinity values are not supported`)}return new d(c.float,e,r)}function hi(e,r,t,n){return _n(Nn(e,r+1),3,n)}function gi(e,r,t,n){return _n(Bn(e,r+1),5,n)}function yi(e,r,t,n){return _n(Ei(e,r+1),9,n)}function nt(e,r,t){let n=r.value;if(n===!1)e.push([c.float.majorEncoded|Xl]);else if(n===!0)e.push([c.float.majorEncoded|Ql]);else if(n===null)e.push([c.float.majorEncoded|Yl]);else if(n===void 0)e.push([c.float.majorEncoded|Zl]);else{let o,s=!1;(!t||t.float64!==!0)&&(xi(n),o=Nn(ce,1),n===o||Number.isNaN(n)?(ce[0]=249,e.push(ce.slice(0,3)),s=!0):(bi(n),o=Bn(ce,1),n===o&&(ce[0]=250,e.push(ce.slice(0,5)),s=!0))),s||(ed(n),o=Ei(ce,1),ce[0]=251,e.push(ce.slice(0,9)))}}nt.encodedSize=function(r,t){let n=r.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){xi(n);let o=Nn(ce,1);if(n===o||Number.isNaN(n))return 3;if(bi(n),o=Bn(ce,1),n===o)return 5}return 9};var wi=new ArrayBuffer(9),te=new DataView(wi,1),ce=new Uint8Array(wi,0);function xi(e){if(e===1/0)te.setUint16(0,31744,!1);else if(e===-1/0)te.setUint16(0,64512,!1);else if(Number.isNaN(e))te.setUint16(0,32256,!1);else{te.setFloat32(0,e);let r=te.getUint32(0),t=(r&2139095040)>>23,n=r&8388607;if(t===255)te.setUint16(0,31744,!1);else if(t===0)te.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let o=t-127;o<-24?te.setUint16(0,0):o<-14?te.setUint16(0,(r&2147483648)>>16|1<<24+o,!1):te.setUint16(0,(r&2147483648)>>16|o+15<<10|n>>13,!1)}}}function Nn(e,r){if(e.length-r<2)throw new Error(`${y} not enough data for float16`);let t=(e[r]<<8)+e[r+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,o=t&1023,s;return n===0?s=o*2**-24:n!==31?s=(o+1024)*2**(n-25):s=o===0?1/0:NaN,t&32768?-s:s}function bi(e){te.setFloat32(0,e,!1)}function Bn(e,r){if(e.length-r<4)throw new Error(`${y} not enough data for float32`);let t=(e.byteOffset||0)+r;return new DataView(e.buffer,t,4).getFloat32(0,!1)}function ed(e){te.setFloat64(0,e,!1)}function Ei(e,r){if(e.length-r<8)throw new Error(`${y} not enough data for float64`);let t=(e.byteOffset||0)+r;return new DataView(e.buffer,t,8).getFloat64(0,!1)}nt.compareTokens=re.compareTokens;function P(e,r,t){throw new Error(`${y} encountered invalid minor (${t}) for major ${e[r]>>>5}`)}function ot(e){return()=>{throw new Error(`${y} ${e}`)}}var h=[];for(let e=0;e<=23;e++)h[e]=P;h[24]=ks;h[25]=_s;h[26]=Ns;h[27]=Bs;h[28]=P;h[29]=P;h[30]=P;h[31]=P;for(let e=32;e<=55;e++)h[e]=P;h[56]=Rs;h[57]=Ds;h[58]=$s;h[59]=Fs;h[60]=P;h[61]=P;h[62]=P;h[63]=P;for(let e=64;e<=87;e++)h[e]=Os;h[88]=js;h[89]=Ms;h[90]=zs;h[91]=Vs;h[92]=P;h[93]=P;h[94]=P;h[95]=ot("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)h[e]=Hs;h[120]=Gs;h[121]=qs;h[122]=Ws;h[123]=Js;h[124]=P;h[125]=P;h[126]=P;h[127]=ot("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)h[e]=Xs;h[152]=Qs;h[153]=Ys;h[154]=Zs;h[155]=ei;h[156]=P;h[157]=P;h[158]=P;h[159]=ri;for(let e=160;e<=183;e++)h[e]=ti;h[184]=ni;h[185]=oi;h[186]=si;h[187]=ii;h[188]=P;h[189]=P;h[190]=P;h[191]=ai;for(let e=192;e<=215;e++)h[e]=ci;h[216]=ui;h[217]=fi;h[218]=li;h[219]=di;h[220]=P;h[221]=P;h[222]=P;h[223]=P;for(let e=224;e<=243;e++)h[e]=ot("simple values are not supported");h[244]=P;h[245]=P;h[246]=P;h[247]=pi;h[248]=ot("simple values are not supported");h[249]=hi;h[250]=gi;h[251]=yi;h[252]=P;h[253]=P;h[254]=P;h[255]=mi;var ue=[];for(let e=0;e<24;e++)ue[e]=new d(c.uint,e,1);for(let e=-1;e>=-24;e--)ue[31-e]=new d(c.negint,e,1);ue[64]=new d(c.bytes,new Uint8Array(0),1);ue[96]=new d(c.string,"",1);ue[128]=new d(c.array,0,1);ue[160]=new d(c.map,0,1);ue[244]=new d(c.false,!1,1);ue[245]=new d(c.true,!0,1);ue[246]=new d(c.null,null,1);function Si(e){switch(e.type){case c.false:return ge([244]);case c.true:return ge([245]);case c.null:return ge([246]);case c.bytes:return e.value.length?void 0:ge([64]);case c.string:return e.value===""?ge([96]):void 0;case c.array:return e.value===0?ge([128]):void 0;case c.map:return e.value===0?ge([160]):void 0;case c.uint:return e.value<24?ge([Number(e.value)]):void 0;case c.negint:if(e.value>=-24)return ge([31-Number(e.value)])}}var td={float64:!1,mapSorter:sd,quickEncodeToken:Si};function nd(){let e=[];return e[c.uint.major]=re,e[c.negint.major]=Yr,e[c.bytes.major]=Ze,e[c.string.major]=Ks,e[c.array.major]=et,e[c.map.major]=rt,e[c.tag.major]=tt,e[c.float.major]=nt,e}var Pi=nd(),Rn=new Ar,it=class e{constructor(r,t){this.obj=r,this.parent=t}includes(r){let t=this;do if(t.obj===r)return!0;while(t=t.parent);return!1}static createCheck(r,t){if(r&&r.includes(t))throw new Error(`${xe} object contains circular references`);return new e(t,r)}},ve={null:new d(c.null,null),undefined:new d(c.undefined,void 0),true:new d(c.true,!0),false:new d(c.false,!1),emptyArray:new d(c.array,0),emptyMap:new d(c.map,0)},Ue={number(e,r,t,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new d(c.float,e):e>=0?new d(c.uint,e):new d(c.negint,e)},bigint(e,r,t,n){return e>=BigInt(0)?new d(c.uint,e):new d(c.negint,e)},Uint8Array(e,r,t,n){return new d(c.bytes,e)},string(e,r,t,n){return new d(c.string,e)},boolean(e,r,t,n){return e?ve.true:ve.false},null(e,r,t,n){return ve.null},undefined(e,r,t,n){return ve.undefined},ArrayBuffer(e,r,t,n){return new d(c.bytes,new Uint8Array(e))},DataView(e,r,t,n){return new d(c.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,r,t,n){if(!e.length)return t.addBreakTokens===!0?[ve.emptyArray,new d(c.break)]:ve.emptyArray;n=it.createCheck(n,e);let o=[],s=0;for(let i of e)o[s++]=st(i,t,n);return t.addBreakTokens?[new d(c.array,e.length),o,new d(c.break)]:[new d(c.array,e.length),o]},Object(e,r,t,n){let o=r!=="Object",s=o?e.keys():Object.keys(e),i=o?e.size:s.length;if(!i)return t.addBreakTokens===!0?[ve.emptyMap,new d(c.break)]:ve.emptyMap;n=it.createCheck(n,e);let a=[],f=0;for(let g of s)a[f++]=[st(g,t,n),st(o?e.get(g):e[g],t,n)];return od(a,t),t.addBreakTokens?[new d(c.map,i),a,new d(c.break)]:[new d(c.map,i),a]}};Ue.Map=Ue.Object;Ue.Buffer=Ue.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ue[`${e}Array`]=Ue.DataView;function st(e,r={},t){let n=Ss(e),o=r&&r.typeEncoders&&r.typeEncoders[n]||Ue[n];if(typeof o=="function"){let i=o(e,n,r,t);if(i!=null)return i}let s=Ue[n];if(!s)throw new Error(`${xe} unsupported type: ${n}`);return s(e,n,r,t)}function od(e,r){r.mapSorter&&e.sort(r.mapSorter)}function sd(e,r){let t=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(r[0])?r[0][0]:r[0];if(t.type!==n.type)return t.type.compare(n.type);let o=t.type.major,s=Pi[o].compareTokens(t,n);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function Ai(e,r,t,n){if(Array.isArray(r))for(let o of r)Ai(e,o,t,n);else t[r.type.major](e,r,n)}function Dn(e,r,t){let n=st(e,t);if(!Array.isArray(n)&&t.quickEncodeToken){let o=t.quickEncodeToken(n);if(o)return o;let s=r[n.type.major];if(s.encodedSize){let i=s.encodedSize(n,t),a=new Ar(i);if(s(a,n,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Pr(a.chunks[0])}}return Rn.reset(),Ai(Rn,n,r,t),Rn.toBytes(!0)}function $n(e,r){return r=Object.assign({},td,r),Dn(e,Pi,r)}var id={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},at=class{constructor(r,t={}){this._pos=0,this.data=r,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){let r=this.data[this._pos],t=ue[r];if(t===void 0){let n=h[r];if(!n)throw new Error(`${y} no decoder for major type ${r>>>5} (byte 0x${r.toString(16).padStart(2,"0")})`);let o=r&31;t=n(this.data,this._pos,o,this.options)}return this._pos+=t.encodedLength,t}},Ur=Symbol.for("DONE"),ct=Symbol.for("BREAK");function ad(e,r,t){let n=[];for(let o=0;o<e.value;o++){let s=tr(r,t);if(s===ct){if(e.value===1/0)break;throw new Error(`${y} got unexpected break to lengthed array`)}if(s===Ur)throw new Error(`${y} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=s}return n}function cd(e,r,t){let n=t.useMaps===!0,o=n?void 0:{},s=n?new Map:void 0;for(let i=0;i<e.value;i++){let a=tr(r,t);if(a===ct){if(e.value===1/0)break;throw new Error(`${y} got unexpected break to lengthed map`)}if(a===Ur)throw new Error(`${y} found map but not enough entries (got ${i} [no key], expected ${e.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${y} non-string keys not supported (got ${typeof a})`);if(t.rejectDuplicateMapKeys===!0&&(n&&s.has(a)||!n&&a in o))throw new Error(`${y} found repeat map key "${a}"`);let f=tr(r,t);if(f===Ur)throw new Error(`${y} found map but not enough entries (got ${i} [no value], expected ${e.value})`);n?s.set(a,f):o[a]=f}return n?s:o}function tr(e,r){if(e.done())return Ur;let t=e.next();if(t.type===c.break)return ct;if(t.type.terminal)return t.value;if(t.type===c.array)return ad(t,e,r);if(t.type===c.map)return cd(t,e,r);if(t.type===c.tag){if(r.tags&&typeof r.tags[t.value]=="function"){let n=tr(e,r);return r.tags[t.value](n)}throw new Error(`${y} tag not supported (${t.value})`)}throw new Error("unsupported")}function Ln(e,r){if(!(e instanceof Uint8Array))throw new Error(`${y} data to decode must be a Uint8Array`);r=Object.assign({},id,r);let t=r.tokenizer||new at(e,r),n=tr(t,r);if(n===Ur)throw new Error(`${y} did not find any content to decode`);if(n===ct)throw new Error(`${y} got unexpected break`);return[n,e.subarray(t.pos())]}function Tr(e,r){let[t,n]=Ln(e,r);if(n.length>0)throw new Error(`${y} too many terminals, data makes no sense`);return t}var Ci=42;function Ii(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function fd(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;let r=p.asCID(e);if(!r)return null;let t=new Uint8Array(r.bytes.byteLength+1);return t.set(r.bytes,1),[new d(c.tag,Ci),new d(c.bytes,t)]}function ld(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function dd(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var Fn={float64:!0,typeEncoders:{Object:fd,undefined:ld,number:dd}},pd={...Fn,typeEncoders:{...Fn.typeEncoders}};function md(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return p.decode(e.subarray(1))}var ut={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ut.tags[Ci]=md;var hd={...ut,tags:ut.tags.slice()},gd="dag-cbor",yd=113,On=e=>$n(e,Fn),jn=e=>Tr(Ii(e),ut);var qn={};B(qn,{code:()=>Ud,decode:()=>Ui,encode:()=>vi,format:()=>Td,name:()=>vd,parse:()=>_d,stringify:()=>Td});var Mn=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(r){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===c.array&&(t.elements++,t.elements!==1&&r.push([44])),t.type===c.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?r.push([44]):r.push([58]))))}[c.uint.major](r,t){this.prefix(r);let n=String(t.value),o=[];for(let s=0;s<n.length;s++)o[s]=n.charCodeAt(s);r.push(o)}[c.negint.major](r,t){this[c.uint.major](r,t)}[c.bytes.major](r,t){throw new Error(`${xe} unsupported type: Uint8Array`)}[c.string.major](r,t){this.prefix(r);let n=Qr(JSON.stringify(t.value));r.push(n.length>32?Pr(n):n)}[c.array.major](r,t){this.prefix(r),this.inRecursive.push({type:c.array,elements:0}),r.push([91])}[c.map.major](r,t){this.prefix(r),this.inRecursive.push({type:c.map,elements:0}),r.push([123])}[c.tag.major](r,t){}[c.float.major](r,t){if(t.type.name==="break"){let i=this.inRecursive.pop();if(i){if(i.type===c.array)r.push([93]);else if(i.type===c.map)r.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${xe} unsupported type: undefined`);if(this.prefix(r),t.type.name==="true"){r.push([116,114,117,101]);return}else if(t.type.name==="false"){r.push([102,97,108,115,101]);return}else if(t.type.name==="null"){r.push([110,117,108,108]);return}let n=String(t.value),o=[],s=!1;for(let i=0;i<n.length;i++)o[i]=n.charCodeAt(i),!s&&(o[i]===46||o[i]===101||o[i]===69)&&(s=!0);s||(o.push(46),o.push(48)),r.push(o)}};function wd(e,r){if(Array.isArray(e[0])||Array.isArray(r[0]))throw new Error(`${xe} complex map keys are not supported`);let t=e[0],n=r[0];if(t.type!==c.string||n.type!==c.string)throw new Error(`${xe} non-string map keys are not supported`);if(t<n)return-1;if(t>n)return 1;throw new Error(`${xe} unexpected duplicate map keys, this is not supported`)}var xd={addBreakTokens:!0,mapSorter:wd};function zn(e,r){return r=Object.assign({},xd,r),Dn(e,new Mn,r)}var nr=class{constructor(r,t={}){this._pos=0,this.data=r,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let r=this.ch();for(;r===32||r===9||r===13||r===10;)r=this.data[++this._pos]}expect(r){if(this.data.length-this._pos<r.length)throw new Error(`${y} unexpected end of input at position ${this._pos}`);for(let t=0;t<r.length;t++)if(this.data[this._pos++]!==r[t])throw new Error(`${y} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...r)}'`)}parseNumber(){let r=this._pos,t=!1,n=!1,o=a=>{for(;!this.done();){let f=this.ch();if(a.includes(f))this._pos++;else break}};if(this.ch()===45&&(t=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,n=!0;else return new d(c.uint,0,this._pos-r);if(o([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===r+1)throw new Error(`${y} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${y} unexpected token at position ${this._pos}`);n=!0,this._pos++,o([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,o([48,49,50,51,52,53,54,55,56,57]));let s=String.fromCharCode.apply(null,this.data.subarray(r,this._pos)),i=parseFloat(s);return n?new d(c.float,i,this._pos-r):this.options.allowBigInt!==!0||Number.isSafeInteger(i)?new d(i>=0?c.uint:c.negint,i,this._pos-r):new d(i>=0?c.uint:c.negint,BigInt(s),this._pos-r)}parseString(){if(this.ch()!==34)throw new Error(`${y} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let s=this._pos,i=0;s<this.data.length&&i<65536;s++,i++){let a=this.data[s];if(a===92||a<32||a>=128)break;if(a===34){let f=String.fromCharCode.apply(null,this.data.subarray(this._pos,s));return this._pos=s+1,new d(c.string,f,i)}}let r=this._pos,t=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error(`${y} unexpected end of unicode escape sequence at position ${this._pos}`);let s=0;for(let i=0;i<4;i++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${y} unexpected unicode escape character at position ${this._pos}`);s=s*16+a,this._pos++}return s},o=()=>{let s=this.ch(),i=null,a=s>239?4:s>223?3:s>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${y} unexpected unicode sequence at position ${this._pos}`);let f,g,l,m;switch(a){case 1:s<128&&(i=s);break;case 2:f=this.data[this._pos+1],(f&192)===128&&(m=(s&31)<<6|f&63,m>127&&(i=m));break;case 3:f=this.data[this._pos+1],g=this.data[this._pos+2],(f&192)===128&&(g&192)===128&&(m=(s&15)<<12|(f&63)<<6|g&63,m>2047&&(m<55296||m>57343)&&(i=m));break;case 4:f=this.data[this._pos+1],g=this.data[this._pos+2],l=this.data[this._pos+3],(f&192)===128&&(g&192)===128&&(l&192)===128&&(m=(s&15)<<18|(f&63)<<12|(g&63)<<6|l&63,m>65535&&m<1114112&&(i=m))}i===null?(i=65533,a=1):i>65535&&(i-=65536,t.push(i>>>10&1023|55296),i=56320|i&1023),t.push(i),this._pos+=a};for(;!this.done();){let s=this.ch(),i;switch(s){case 92:if(this._pos++,this.done())throw new Error(`${y} unexpected string termination at position ${this._pos}`);switch(i=this.ch(),this._pos++,i){case 34:case 39:case 92:case 47:t.push(i);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error(`${y} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new d(c.string,Tn(t),this._pos-r);default:if(s<32)throw new Error(`${y} invalid control character at position ${this._pos}`);s<128?(t.push(s),this._pos++):o()}}throw new Error(`${y} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new d(c.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new d(c.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new d(c.null,null,4);case 102:return this.expect([102,97,108,115,101]),new d(c.false,!1,5);case 116:return this.expect([116,114,117,101]),new d(c.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${y} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new d(c.break,void 0,1);if(this.ch()!==44)throw new Error(`${y} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new d(c.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new d(c.break,void 0,1);if(this.ch()!==44)throw new Error(`${y} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new d(c.break,void 0,1);let r=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${y} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),r}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${y} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}};function Vn(e,r){return r=Object.assign({tokenizer:new nr(e,r)},r),Tr(e,r)}function Ed(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function Sd(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;let r=p.asCID(e);if(!r)return null;let t=r.toString();return[new d(c.map,1/0,1),new d(c.string,"/",1),new d(c.string,t,t.length),new d(c.break,void 0,1)]}function lt(e){let r=qe.encode(e).slice(1);return[new d(c.map,1/0,1),new d(c.string,"/",1),new d(c.map,1/0,1),new d(c.string,"bytes",5),new d(c.string,r,r.length),new d(c.break,void 0,1),new d(c.break,void 0,1)]}function fe(e){return lt(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function Pd(e){return lt(new Uint8Array(e))}function Ad(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Cd(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var Id={typeEncoders:{Object:Sd,Buffer:lt,Uint8Array:lt,Int8Array:fe,Uint16Array:fe,Int16Array:fe,Uint32Array:fe,Int32Array:fe,Float32Array:fe,Float64Array:fe,Uint8ClampedArray:fe,BigInt64Array:fe,BigUint64Array:fe,DataView:fe,ArrayBuffer:Pd,undefined:Ad,number:Cd}},Hn=class extends nr{constructor(r,t){super(r,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let r=this._next();if(r.type===c.map){let t=this._next();if(t.type===c.string&&t.value==="/"){let n=this._next();if(n.type===c.string){if(this._next().type!==c.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new d(c.tag,42,0)}if(n.type===c.map){let o=this._next();if(o.type===c.string&&o.value==="bytes"){let s=this._next();if(s.type===c.string){for(let a=0;a<2;a++)if(this._next().type!==c.break)throw new Error("Invalid encoded Bytes form");let i=qe.decode(`m${s.value}`);return new d(c.bytes,i,s.value.length)}this.tokenBuffer.push(s)}this.tokenBuffer.push(o)}this.tokenBuffer.push(n)}this.tokenBuffer.push(t)}return r}},Gn={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Gn.tags[42]=p.parse;var vd="dag-json",Ud=297,vi=e=>zn(e,Id),Ui=e=>{let r=Ed(e),t=Object.assign(Gn,{tokenizer:new Hn(r,Gn)});return Vn(r,t)},Td=e=>kd.decode(vi(e));var kd=new TextDecoder,_d=e=>Ui(Nd.encode(e)),Nd=new TextEncoder;var Qn={};B(Qn,{code:()=>Hd,createLink:()=>Fi,createNode:()=>Li,decode:()=>qd,encode:()=>Gd,name:()=>Vd,prepare:()=>Kn,validate:()=>Xn});var Bd=new TextDecoder;function Wn(e,r){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(r>=e.length)throw new Error("protobuf: unexpected end of data");let o=e[r++];if(t+=n<28?(o&127)<<n:(o&127)*2**n,o<128)break}return[t,r]}function dt(e,r){let t;[t,r]=Wn(e,r);let n=r+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(r,n),n]}function Ti(e,r){let t;return[t,r]=Wn(e,r),[t&7,t>>3,r]}function Rd(e){let r={},t=e.length,n=0;for(;n<t;){let o,s;if([o,s,n]=Ti(e,n),s===1){if(r.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(r.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[r.Hash,n]=dt(e,n)}else if(s===2){if(r.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=dt(e,n),r.Name=Bd.decode(i)}else if(s===3){if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[r.Tsize,n]=Wn(e,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return r}function ki(e){let r=e.length,t=0,n,o=!1,s;for(;t<r;){let a,f;if([a,f,t]=Ti(e,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(f===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,t]=dt(e,t),n&&(o=!0)}else if(f===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let g;[g,t]=dt(e,t),n.push(Rd(g))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${f}`)}if(t>r)throw new Error("protobuf: (PBNode) unexpected end of data");let i={};return s&&(i.Data=s),i.Links=n||[],i}var Ni=new TextEncoder,_i=2**32,Dd=2**31;function $d(e,r){let t=r.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");t=kr(r,t,e.Tsize)-1,r[t]=24}if(typeof e.Name=="string"){let n=Ni.encode(e.Name);t-=n.length,r.set(n,t),t=kr(r,t,n.length)-1,r[t]=18}return e.Hash&&(t-=e.Hash.length,r.set(e.Hash,t),t=kr(r,t,e.Hash.length)-1,r[t]=10),r.length-t}function Bi(e){let r=Fd(e),t=new Uint8Array(r),n=r;if(e.Data&&(n-=e.Data.length,t.set(e.Data,n),n=kr(t,n,e.Data.length)-1,t[n]=10),e.Links)for(let o=e.Links.length-1;o>=0;o--){let s=$d(e.Links[o],t.subarray(0,n));n-=s,n=kr(t,n,s)-1,t[n]=18}return t}function Ld(e){let r=0;if(e.Hash){let t=e.Hash.length;r+=1+t+or(t)}if(typeof e.Name=="string"){let t=Ni.encode(e.Name).length;r+=1+t+or(t)}return typeof e.Tsize=="number"&&(r+=1+or(e.Tsize)),r}function Fd(e){let r=0;if(e.Data){let t=e.Data.length;r+=1+t+or(t)}if(e.Links)for(let t of e.Links){let n=Ld(t);r+=1+n+or(n)}return r}function kr(e,r,t){r-=or(t);let n=r;for(;t>=Dd;)e[r++]=t&127|128,t/=128;for(;t>=128;)e[r++]=t&127|128,t>>>=7;return e[r]=t,n}function or(e){return e%2===0&&e++,Math.floor((Od(e)+6)/7)}function Od(e){let r=0;return e>=_i&&(e=Math.floor(e/_i),r=32),e>=65536&&(e>>>=16,r+=16),e>=256&&(e>>>=8,r+=8),r+jd[e]}var jd=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];var Md=["Data","Links"],zd=["Hash","Name","Tsize"],Jn=new TextEncoder;function Di(e,r){if(e===r)return 0;let t=e.Name?Jn.encode(e.Name):[],n=r.Name?Jn.encode(r.Name):[],o=t.length,s=n.length;for(let i=0,a=Math.min(o,s);i<a;++i)if(t[i]!==n[i]){o=t[i],s=n[i];break}return o<s?-1:s<o?1:0}function Ri(e,r){return!Object.keys(e).some(t=>!r.includes(t))}function $i(e){if(typeof e.asCID=="object"){let t=p.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");let r={};if(e.Hash){let t=p.asCID(e.Hash);try{t||(typeof e.Hash=="string"?t=p.parse(e.Hash):e.Hash instanceof Uint8Array&&(t=p.decode(e.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}t&&(r.Hash=t)}if(!r.Hash)throw new TypeError("Invalid DAG-PB form");return typeof e.Name=="string"&&(r.Name=e.Name),typeof e.Tsize=="number"&&(r.Tsize=e.Tsize),r}function Kn(e){if((e instanceof Uint8Array||typeof e=="string")&&(e={Data:e}),typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");let r={};if(e.Data!==void 0)if(typeof e.Data=="string")r.Data=Jn.encode(e.Data);else if(e.Data instanceof Uint8Array)r.Data=e.Data;else throw new TypeError("Invalid DAG-PB form");if(e.Links!==void 0)if(Array.isArray(e.Links))r.Links=e.Links.map($i),r.Links.sort(Di);else throw new TypeError("Invalid DAG-PB form");else r.Links=[];return r}function Xn(e){if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!Ri(e,Md))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let r=0;r<e.Links.length;r++){let t=e.Links[r];if(!t||typeof t!="object"||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!Ri(t,zd))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(t.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash==null||!t.Hash["/"]||t.Hash["/"]!==t.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0){if(typeof t.Tsize!="number"||t.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(r>0&&Di(t,e.Links[r-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function Li(e,r=[]){return Kn({Data:e,Links:r})}function Fi(e,r,t){return $i({Hash:t,Name:e,Tsize:r})}function Oi(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}var Vd="dag-pb",Hd=112;function Gd(e){Xn(e);let r={};return e.Links&&(r.Links=e.Links.map(t=>{let n={};return t.Hash&&(n.Hash=t.Hash.bytes),t.Name!==void 0&&(n.Name=t.Name),t.Tsize!==void 0&&(n.Tsize=t.Tsize),n})),e.Data&&(r.Data=e.Data),Bi(r)}function qd(e){let r=Oi(e),t=ki(r),n={};return t.Data&&(n.Data=t.Data),t.Links&&(n.Links=t.Links.map(o=>{let s={};try{s.Hash=p.decode(o.Hash)}catch{}if(!s.Hash)throw new Error("Invalid Hash field found in link, expected CID");return o.Name!==void 0&&(s.Name=o.Name),o.Tsize!==void 0&&(s.Tsize=o.Tsize),s})),n}var Yn={};B(Yn,{code:()=>ep,decode:()=>op,encode:()=>np,name:()=>Zd,toGeneral:()=>Ji});function le(e){return Ie.encode(e).slice(1)}function ne(e){return Ie.decode(`u${e}`)}function ji(e){let[r,t,n]=e;return{payload:t,signatures:[{protected:r,signature:n}],link:p.decode(ne(t))}}function Wd(e){let r={signature:ne(e.signature)};return e.header&&(r.header=e.header),e.protected&&(r.protected=ne(e.protected)),r}function Mi(e){let r=ne(e.payload);try{p.decode(r)}catch{throw new Error("Not a valid DagJWS")}return{payload:r,signatures:e.signatures.map(Wd)}}function Jd(e){let r={signature:le(e.signature)};return e.header&&(r.header=e.header),e.protected&&(r.protected=le(e.protected)),r}function zi(e){let r={payload:le(e.payload),signatures:e.signatures.map(Jd)};return r.link=p.decode(new Uint8Array(e.payload)),r}function Vi(e){let[r,t,n,o,s]=e,i={ciphertext:o,iv:n,protected:r,tag:s};return t&&(i.recipients=[{encrypted_key:t}]),i}function Xd(e){let r={};return e.encrypted_key&&(r.encrypted_key=ne(e.encrypted_key)),e.header&&(r.header=e.header),r}function Hi(e){let r={ciphertext:ne(e.ciphertext),protected:ne(e.protected),iv:ne(e.iv),tag:ne(e.tag)};return e.aad&&(r.aad=ne(e.aad)),e.recipients&&(r.recipients=e.recipients.map(Xd)),e.unprotected&&(r.unprotected=e.unprotected),r}function Qd(e){let r={};return e.encrypted_key&&(r.encrypted_key=le(e.encrypted_key)),e.header&&(r.header=e.header),r}function Gi(e){let r={ciphertext:le(e.ciphertext),protected:le(e.protected),iv:le(e.iv),tag:le(e.tag)};return e.aad&&(r.aad=le(e.aad)),e.recipients&&(r.recipients=e.recipients.map(Qd)),e.unprotected&&(r.unprotected=e.unprotected),r}var Zd="dag-jose",ep=133;function qi(e){return"payload"in e&&typeof e.payload=="string"&&"signatures"in e&&Array.isArray(e.signatures)}function rp(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function tp(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function Wi(e){return"ciphertext"in e&&typeof e.ciphertext=="string"&&"iv"in e&&typeof e.iv=="string"&&"protected"in e&&typeof e.protected=="string"&&"tag"in e&&typeof e.tag=="string"}function Ji(e){if(typeof e=="string"){let r=e.split(".");if(r.length===3)return ji(r);if(r.length===5)return Vi(r);throw new Error("Not a valid JOSE string")}if(qi(e)||Wi(e))return e;throw new Error("Not a valid unencoded JOSE object")}function np(e){typeof e=="string"&&(e=Ji(e));let r;if(qi(e))r=Mi(e);else if(Wi(e))r=Hi(e);else throw new Error("Not a valid JOSE object");return new Uint8Array(On(r))}function op(e){let r;try{r=jn(e)}catch{throw new Error("Not a valid DAG-JOSE object")}if(rp(r))return zi(r);if(tp(r))return Gi(r);throw new Error("Not a valid DAG-JOSE object")}function $(e){let r=new globalThis.AbortController;function t(){r.abort();for(let s of e)s?.removeEventListener!=null&&s.removeEventListener("abort",t)}for(let s of e){if(s?.aborted===!0){t();break}s?.addEventListener!=null&&s.addEventListener("abort",t)}function n(){for(let s of e)s?.removeEventListener!=null&&s.removeEventListener("abort",t)}let o=r.signal;return o.clear=n,o}var Ki="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var Xi=(e=21)=>{let r="",t=crypto.getRandomValues(new Uint8Array(e));for(;e--;)r+=Ki[t[e]&63];return r};var Zi=Pe(Yi(),1),ea=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Zn=(0,Zi.default)(),sr=ea&&!Zn;var ra=Zn&&ea,ta=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!Zn,ir=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,$w=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+"_"+"ENV"]==="test",Lw=typeof navigator<"u"&&navigator.product==="ReactNative";async function*Ee(e,r={}){let t=e.getReader();try{for(;;){let n=await t.read();if(n.done)return;yield n.value}}finally{r.preventCancel!==!0&&await t.cancel(),t.releaseLock()}}var Br=Pe(_r(),1);function ap(e){let[r,t]=e[Symbol.asyncIterator]!=null?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>r.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:r.next(),[t](){return this}}}var Te=ap;function cp(e){return e[Symbol.asyncIterator]!=null}function up(e,r){if(cp(e))return async function*(){for await(let a of e)yield r(a)}();let t=Te(e),{value:n,done:o}=t.next();if(o===!0)return function*(){}();let s=r(n);if(typeof s.then=="function")return async function*(){yield await s;for await(let a of t)yield r(a)}();let i=r;return function*(){yield s;for(let a of t)yield i(a)}()}var eo=up;function Se(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function Fe(e){return e.constructor!=null&&(e.constructor.name==="Blob"||e.constructor.name==="File")&&typeof e.stream=="function"}function Nr(e){return typeof e=="object"&&(e.path!=null||e.content!=null)}function Oe(e){return typeof e?.getReader=="function"}function pt(e){if(e!=null)return typeof e=="string"&&(e=parseInt(e,8)),e&4095}function fp(e){return Object.prototype.hasOwnProperty.call(e,"secs")}function lp(e){return Object.prototype.hasOwnProperty.call(e,"Seconds")}function dp(e){return Array.isArray(e)}function ke(e){if(e!=null){if(fp(e)&&(e={secs:e.secs,nsecs:e.nsecs}),lp(e)&&(e={secs:BigInt(e.Seconds),nsecs:e.FractionalNanoseconds}),dp(e)&&(e={secs:BigInt(e[0]),nsecs:e[1]}),e instanceof Date){let r=e.getTime(),t=Math.floor(r/1e3);e={secs:BigInt(t),nsecs:(r-t*1e3)*1e3}}if(typeof e=="bigint"){let r=e/BigInt(1e9),t=e-r*BigInt(1e9);e={secs:r,nsecs:Number(t)}}if(Object.prototype.hasOwnProperty.call(e,"secs")){if(e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw new V("mtime-nsecs must be within the range [0,999999999]","ERR_INVALID_MTIME_NSECS");return e}}}async function*sa(e,r){if(typeof e=="string"||e instanceof String||Se(e)||Fe(e)||e._readableState!=null)throw(0,Br.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(Oe(e)&&(e=Ee(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let t=Te(e),{value:n,done:o}=await t.peek();if(o===!0){yield*[];return}if(t.push(n),Number.isInteger(n))throw(0,Br.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState!=null){yield*eo(t,async s=>ro({content:s},r));return}if(Se(n)){yield ro({content:t},r);return}if(Nr(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||Oe(n)||Fe(n)){yield*eo(t,async s=>ro(s,r));return}}throw Nr(e)?(0,Br.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):(0,Br.default)(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function ro(e,r){let{path:t,mode:n,mtime:o,content:s}=e,i={path:t??"",mode:pt(n),mtime:ke(o)};return s!=null?i.content=await r(s):t==null&&(i.content=await r(e)),i}function pp(e){return e[Symbol.asyncIterator]!=null}function mp(e){if(pp(e))return(async()=>{let t=[];for await(let n of e)t.push(n);return t})();let r=[];for(let t of e)r.push(t);return r}var mt=mp;async function ht(e){if(Se(e))return new Blob([e]);if(typeof e=="string"||e instanceof String)return new Blob([e.toString()]);if(Fe(e))return e;if(Oe(e)&&(e=Ee(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let r=Te(e),{value:t,done:n}=await r.peek();if(n===!0)return ia(r);if(r.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(await mt(r))]);if(Se(t)||typeof t=="string"||t instanceof String)return ia(r)}throw new V(`Unexpected input: ${e}`,"ERR_UNEXPECTED_INPUT")}async function ia(e){let r=[];for await(let t of e)r.push(t);return new Blob(r)}function aa(e){return sa(e,ht,!0)}function ar(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}async function gt(e,r,t={},n){let o=[],s=new FormData,i=0,a=0;for await(let{content:f,path:g,mode:l,mtime:m}of aa(e)){let E="",v=f!=null?"file":"dir";i>0&&(E=`-${i}`);let x=v+E,A=[];if(l!=null&&A.push(`mode=${ar(l)}`),m!=null){let{secs:U,nsecs:T}=m;A.push(`mtime=${U}`),T!=null&&A.push(`mtime-nsecs=${T}`)}if(A.length>0&&(x=`${x}?${A.join("&")}`),f!=null){s.set(x,f,g!=null?encodeURIComponent(g):void 0);let U=a+f.size;o.push({name:g,start:a,end:U}),a=U}else if(g!=null)s.set(x,new File([""],encodeURIComponent(g),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");i++}return{total:a,parts:o,headers:t,body:s}}async function j(e,r,t={},n=`-----------------------------${Xi()}`){let o=gt;return ra&&(o=gt),o(e,r,t,n)}function S(e){if(e==null)return e;let r=/^[A-Z]+$/,t={};return Object.keys(e).reduce((n,o)=>(r.test(o)?n[o.toLowerCase()]=e[o]:r.test(o[0])?n[o[0].toLowerCase()+o.slice(1)]=e[o]:n[o]=e[o],n),t)}function u({arg:e,searchParams:r,hashAlg:t,mtime:n,mode:o,...s}={}){r!=null&&(s={...s,...r}),t!=null&&(s.hash=t),n!=null&&(n=ke(n),s.mtime=n.secs,s.mtimeNsecs=n.nsecs),o!=null&&(s.mode=ar(o)),isNaN(s.timeout)||(s.timeout=`${s.timeout}ms`),e==null?e=[]:Array.isArray(e)||(e=[e]);let i=new URLSearchParams(s);return e.forEach(a=>{i.append("arg",a)}),i}function yt(e){return async function*(t,n={}){let o=new AbortController,s=$([o.signal,n.signal]);try{let{headers:i,body:a,total:f,parts:g}=await j(t,o,n.headers),[l,m]=typeof n.progress=="function"?hp(f,n.progress,g):[void 0,void 0],E=await e.post("add",{searchParams:u({"stream-channels":!0,...n,progress:!!l}),onUploadProgress:m,signal:s,headers:i,body:a});for await(let v of E.ndjson())v=S(v),v.hash!==void 0?yield yp(v):l?.(v.bytes??0,v.name)}finally{s.clear()}}}var hp=(e,r,t)=>t!=null?[void 0,gp(e,t,r)]:[r,void 0],gp=(e,r,t)=>{let n=0,o=r.length;return({loaded:s,total:i})=>{let a=Math.floor(s/i*e);for(;n<o;){let{start:f,end:g,name:l}=r[n];if(a<g){t(a-f,l);break}else t(g-f,l),n+=1}}};function yp({name:e,hash:r,size:t,mode:n,mtime:o,mtimeNsecs:s}){let i={path:e,cid:p.parse(r),size:parseInt(t)};return n!=null&&(i.mode=parseInt(n,8)),o!=null&&(i.mtime={secs:o,nsecs:s??0}),i}function wp(e){return e[Symbol.asyncIterator]!=null}function xp(e){if(wp(e))return(async()=>{let t;for await(let n of e)t=n;return t})();let r;for(let t of e)r=t;return r}var _e=xp;var xt=Pe(_r(),1);async function*ca(e,r){if(e==null)throw(0,xt.default)(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield wt(e.toString(),r);return}if(Se(e)||Fe(e)){yield wt(e,r);return}if(Oe(e)&&(e=Ee(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let t=Te(e),{value:n,done:o}=await t.peek();if(o===!0){yield{content:[]};return}if(t.push(n),Number.isInteger(n)||Se(n)||typeof n=="string"||n instanceof String){yield wt(t,r);return}throw(0,xt.default)(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(Nr(e)){yield wt(e,r);return}throw(0,xt.default)(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function wt(e,r){let{path:t,mode:n,mtime:o,content:s}=e,i={path:t??"",mode:pt(n),mtime:ke(o)};return s!=null?i.content=await r(s):t==null&&(i.content=await r(e)),i}function ua(e){return ca(e,ht)}function fa(e){let r=yt(e);return async function(n,o={}){let s=ua(n),i=r(s,o),a=await _e(i);if(a==null)throw new Error("Invalid body");return a}}var bp=Symbol.for("nodejs.util.inspect.custom"),la=Object.values(me).map(e=>e.decoder).reduce((e,r)=>e.or(r),me.identity.decoder),da=114,pa=36,ma=37,Rr=class{type;multihash;privateKey;publicKey;string;constructor(r){this.type=r.type,this.multihash=r.multihash,this.privateKey=r.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[$o]=!0;toString(){return this.string==null&&(this.string=R.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return p.createV1(da,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(r){if(r==null)return!1;if(r instanceof Uint8Array)return Sr(this.multihash.bytes,r);if(typeof r=="string")return N(r).equals(this);if(r?.multihash?.bytes!=null)return Sr(this.multihash.bytes,r.multihash.bytes);throw new Error("not valid Id")}[bp](){return`PeerId(${this.toString()})`}},Dr=class extends Rr{type="RSA";publicKey;constructor(r){super({...r,type:"RSA"}),this.publicKey=r.publicKey}},$r=class extends Rr{type="Ed25519";publicKey;constructor(r){super({...r,type:"Ed25519"}),this.publicKey=r.multihash.digest}},Lr=class extends Rr{type="secp256k1";publicKey;constructor(r){super({...r,type:"secp256k1"}),this.publicKey=r.multihash.digest}};function N(e,r){if(r=r??la,e.charAt(0)==="1"||e.charAt(0)==="Q"){let t=Ne(R.decode(`z${e}`));return e.startsWith("12D")?new $r({multihash:t}):e.startsWith("16U")?new Lr({multihash:t}):new Dr({multihash:t})}return Ep(la.decode(e))}function Ep(e){try{let r=Ne(e);if(r.code===Re.code){if(r.digest.length===pa)return new $r({multihash:r});if(r.digest.length===ma)return new Lr({multihash:r})}if(r.code===Hr.code)return new Dr({multihash:r})}catch{return Sp(p.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Sp(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==da)throw new Error("Supplied PeerID CID is invalid");let r=e.multihash;if(r.code===Hr.code)return new Dr({multihash:e.multihash});if(r.code===Re.code){if(r.digest.length===pa)return new $r({multihash:e.multihash});if(r.digest.length===ma)return new Lr({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}function bt(e){return async function(t={}){let n=await e.post("bitswap/stat",{searchParams:u(t),signal:t.signal,headers:t.headers});return Pp(await n.json())}}function Pp(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist??[]).map(r=>p.parse(r["/"])),peers:(e.Peers??[]).map(r=>N(r)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}function ha(e){return async function(t,n={}){return((await(await e.post("bitswap/wantlist",{signal:n.signal,searchParams:u({...n,peer:t.toString()}),headers:n.headers})).json()).Keys??[]).map(s=>p.parse(s["/"]))}}function ga(e){return async function(t={}){return((await(await e.post("bitswap/wantlist",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Keys??[]).map(o=>p.parse(o["/"]))}}function to(e){return{wantlist:ga(e),wantlistForPeer:ha(e),stat:bt(e)}}function Et(e){return async function(t,n={}){let o=await e.post("block/get",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers});return new Uint8Array(await o.arrayBuffer())}}function ya(e){return async function r(t,n={}){let o=new AbortController,s=$([o.signal,n.signal]),i;try{i=await(await e.post("block/put",{signal:s,searchParams:u(n),...await j([t],o,n.headers)})).json()}catch(a){if(n.format==="dag-pb")return await r(t,{...n,format:"protobuf"});if(n.format==="dag-cbor")return await r(t,{...n,format:"cbor"});throw a}finally{s.clear()}return p.parse(i.Key)}}function wa(e){return async function*(t,n={}){Array.isArray(t)||(t=[t]);let o=await e.post("block/rm",{signal:n.signal,searchParams:u({arg:t.map(s=>s.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(let s of o.ndjson())yield Ap(s)}}function Ap(e){let r={cid:p.parse(e.Hash)};return e.Error!=null&&(r.error=new Error(e.Error)),r}function xa(e){return async function(t,n={}){let s=await(await e.post("block/stat",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers})).json();return{cid:p.parse(s.Key),size:s.Size}}}function no(e){return{get:Et(e),put:ya(e),rm:wa(e),stat:xa(e)}}function ba(e){return async function(t,n={}){let o=await e.post("bootstrap/add",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Peers:s}=await o.json();return{Peers:s.map(i=>I(i))}}}function Ea(e){return async function(t={}){let n=await e.post("bootstrap/list",{signal:t.signal,searchParams:u(t),headers:t.headers}),{Peers:o}=await n.json();return{Peers:o.map(s=>I(s))}}}function Sa(e){return async function(t,n={}){let o=await e.post("bootstrap/rm",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Peers:s}=await o.json();return{Peers:s.map(i=>I(i))}}}function oo(e){return{add:ba(e),list:Ea(e),rm:Sa(e)}}function Pa(e){return async function*(t,n={}){yield*(await e.post("cat",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers})).iterator()}}function Aa(e){return async function(t={}){return(await e.post("commands",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function Ca(e){return async function(t={}){return await(await e.post("config/show",{signal:t.signal,searchParams:u({...t}),headers:t.headers})).json()}}function Ia(e){return async function(t,n={}){if(t==null)throw new Error("key argument is required");return(await(await e.post("config",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json()).Value}}function va(e){return async function(t,n={}){let s=await(await e.post("config/profile/apply",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}}function Ua(e){return{apply:va(e)}}function Ta(e){return async function(t,n={}){let o=new AbortController,s=$([o.signal,n.signal]);try{await(await e.post("config/replace",{signal:s,searchParams:u(n),...await j([we(JSON.stringify(t))],o,n.headers)})).text()}finally{s.clear()}}}function ka(e){return async function(t,n,o={}){if(typeof t!="string")throw new Error("Invalid key type");let s={...o,...Cp(t,n)};await(await e.post("config",{signal:o.signal,searchParams:u(s),headers:o.headers})).text()}}function Cp(e,r){switch(typeof r){case"boolean":return{arg:[e,r.toString()],bool:!0};case"string":return{arg:[e,r]};default:return{arg:[e,JSON.stringify(r)],json:!0}}}function so(e){return{getAll:Ca(e),get:Ia(e),set:ka(e),replace:Ta(e),profiles:Ua(e)}}function _a(e){return async function*(t,n={}){yield*(await e.post("dag/export",{signal:n.signal,searchParams:u({arg:t.toString()}),headers:n.headers})).iterator()}}var Ba=Pe(_r(),1);function Ip(e){return e[Symbol.asyncIterator]!=null}function vp(e){if(Ip(e))return(async()=>{for await(let r of e)return r})();for(let r of e)return r}var Na=vp;var io=Pe(_r(),1);async function*ao(e,r,t,n,o){let s=async g=>{let l=await t.getCodec(g.code),m=await n(g,o);return l.decode(m)},i=r.split("/").filter(Boolean),a=await s(e),f=e;for(;i.length>0;){let g=i.shift();if(g==null)throw(0,io.default)(new Error(`Could not resolve path "${r}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,g))a=a[g],yield{value:a,remainderPath:i.join("/")};else throw(0,io.default)(new Error(`no link named "${g}" under ${f}`),"ERR_NO_LINK");let l=p.asCID(a);l!=null&&(f=l,a=await s(a))}yield{value:a,remainderPath:""}}function Ra(e,r){let t=Et(e);return async function(o,s={}){if(s.path!=null){let l=s.localResolve===!0?await Na(ao(o,s.path,r,t,s)):await _e(ao(o,s.path,r,t,s));if(l==null)throw(0,Ba.default)(new Error("Not found"),"ERR_NOT_FOUND");return l}let i=await r.getCodec(o.code),a=await t(o,s);return{value:i.decode(a),remainderPath:""}}}function Da(e){return async function*(t,n={}){let o=new AbortController,s=$([o.signal,n.signal]);try{let{headers:i,body:a}=await j(t,o,n.headers),f=await e.post("dag/import",{signal:s,headers:i,body:a,searchParams:u({"pin-roots":n.pinRoots})});for await(let{Root:g}of f.ndjson())if(g!==void 0){let{Cid:{"/":l},PinErrorMsg:m}=g;yield{root:{cid:p.parse(l),pinErrorMsg:m}}}}finally{s.clear()}}}function $a(e,r){return async function(n,o={}){let s={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o},i;if(s.inputCodec!=null){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");i=n}else i=(await r.getCodec(s.storeCodec??"dag-cbor")).encode(n),s.inputCodec=s.storeCodec;let a=new AbortController,f=$([a.signal,s.signal]);try{let l=await(await e.post("dag/put",{timeout:s.timeout,signal:f,searchParams:u(s),...await j([i],a,s.headers)})).json();return p.parse(l.Cid["/"])}finally{f.clear()}}}function La(e){return async function(t,n={}){let s=await(await e.post("dag/resolve",{signal:n.signal,searchParams:u({arg:`${t}${n.path!=null?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers})).json();return{cid:p.parse(s.Cid["/"]),remainderPath:s.RemPath}}}function co(e,r){return{export:_a(e),get:Ra(e,r),import:Da(e),put:$a(e,r),resolve:La(e)}}function oe(e){if(e.Type===0)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===1)return{from:N(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses??[]).map(({ID:r,Addrs:t})=>({id:N(r),multiaddrs:t.map(n=>I(n)),protocols:[]})),providers:(e.Responses??[]).map(({ID:r,Addrs:t})=>({id:N(r),multiaddrs:t.map(n=>I(n)),protocols:[]}))};if(e.Type===2){let r={id:e.ID??N(e.ID),multiaddrs:[],protocols:[]};return e.Responses?.length>0&&(r={id:N(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(t=>I(t)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:r}}if(e.Type===3)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===4)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:r,Addrs:t})=>({id:N(r),multiaddrs:t.map(n=>I(n)),protocols:[]}))};if(e.Type===5)return{name:"VALUE",type:e.Type,value:we(e.Extra,"base64pad")};if(e.Type===6){let r=e.Responses.map(({ID:t})=>N(t));if(r.length===0)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:r[0]}}if(e.Type===7)return{name:"DIALING_PEER",type:e.Type,peer:N(e.ID)};throw new Error("Unknown DHT event type")}function Fa(e){return async function*(t,n={}){let o=await e.post("dht/query",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers});for await(let s of o.ndjson())yield oe(s)}}var uo;(function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"})(uo||(uo={}));var fo;(function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"})(fo||(fo={}));function lo(e){return{query:Fa(e)}}function Oa(e){return async function(t={}){return(await e.post("diag/cmds",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function ja(e){return async function(t={}){return(await e.post("diag/net",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function Ma(e){return async function(t={}){return(await e.post("diag/sys",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function po(e){return{cmds:Oa(e),net:ja(e),sys:Ma(e)}}function za(e){return async function(t,n,o={}){let s=Array.isArray(t)?t:[t];await(await e.post("files/cp",{signal:o.signal,searchParams:u({arg:s.concat(n).map(a=>p.asCID(a)!=null?`/ipfs/${a}`:a),...o}),headers:o.headers})).text()}}function Va(e){return async function(t,n={}){if(typeof t!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await e.post("files/flush",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return p.parse(s.Cid)}}function Fr(e){let r=S(e);return Object.prototype.hasOwnProperty.call(r,"mode")&&(r.mode=parseInt(r.mode,8)),Object.prototype.hasOwnProperty.call(r,"mtime")&&(r.mtime={secs:r.mtime,nsecs:r.mtimeNsecs??0},delete r.mtimeNsecs),r}function Ga(e){return async function*(t,n={}){if(t==null)throw new Error("ipfs.files.ls requires a path");let o=await e.post("files/ls",{signal:n.signal,searchParams:u({arg:p.asCID(t)!=null?`/ipfs/${t}`:t,long:!0,...n,stream:!0}),headers:n.headers});for await(let s of o.ndjson())if("Entries"in s)for(let i of s.Entries??[])yield Ha(Fr(i));else yield Ha(Fr(s))}}function Ha(e){return e.hash!=null&&(e.cid=p.parse(e.hash)),delete e.hash,e.type=e.type===1?"directory":"file",e}function qa(e){return async function(t,n={}){await(await e.post("files/mkdir",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).text()}}function Wa(e){return async function(t,n,o={}){Array.isArray(t)||(t=[t]),await(await e.post("files/mv",{signal:o.signal,searchParams:u({arg:t.concat(n),...o}),headers:o.headers})).text()}}function mo(e){if(Tp(e))return async function*(){let r=e.getReader();try{for(;;){let{done:t,value:n}=await r.read();if(t)return;yield n}}finally{r.releaseLock()}}();if(Up(e))return e;throw new Error("unknown stream")}function Up(e){return e[Symbol.asyncIterator]!=null}function Tp(e){return typeof e?.getReader=="function"}function Ja(e){return async function*(t,n={}){let o=await e.post("files/read",{signal:n.signal,searchParams:u({arg:t,count:n.length,...n}),headers:n.headers});if(o.body==null)throw new Error("Invalid response body");yield*mo(o.body)}}var St=class extends Error{response;constructor(r){super(r.statusText),this.name="HTTPError",this.response=r}};function Ka(e){return async function(t,n={}){let o=await e.post("files/rm",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),s=await o.text();if(s!==""){let i=new St(o);throw i.message=s,i}}}function Pt(e){return async function(t,n={}){let s=await(await e.post("files/stat",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return s.WithLocality=s.WithLocality??!1,kp(Fr(s))}}function kp(e){return e.cid=p.parse(e.hash),delete e.hash,e}function Xa(e){return async function(t,n,o={}){let s=new AbortController,i=$([s.signal,o.signal]);try{await(await e.post("files/write",{signal:i,searchParams:u({arg:t,streamChannels:!0,count:o.length,...o}),...await j([{content:n,path:"arg",mode:ar(o.mode),mtime:ke(o.mtime)}],s,o.headers)})).text()}finally{i.clear()}}}function ho(e){return{cp:za(e),flush:Va(e),ls:Ga(e),mkdir:qa(e),mv:Wa(e),read:Ja(e),rm:Ka(e),stat:Pt(e),write:Xa(e)}}function Qa(e){return function(){let t=new URL(e.opts.base??"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}}}function Ya(e){return async function*(t,n={}){let o={arg:`${t instanceof Uint8Array?p.decode(t):t}`,...n};yield*(await e.post("get",{signal:n.signal,searchParams:u(o),headers:n.headers})).iterator()}}function At(e){return async function(t={}){let o=await(await e.post("id",{signal:t.signal,searchParams:u({arg:t.peerId!=null?t.peerId.toString():void 0,...t}),headers:t.headers})).json(),s={...S(o)};return s.id=N(s.id),s.addresses!=null&&(s.addresses=s.addresses.map(i=>I(i))),s}}function Za(e){let r=At(e);return async function(n={}){try{return!!(await r(n))?.addresses?.length}catch{return!1}}}var _p={type:"ed25519"};function ec(e){return async function(t,n=_p){let s=await(await e.post("key/gen",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return S(s)}}function rc(e){return async function(t,n,o,s={}){let a=await(await e.post("key/import",{signal:s.signal,searchParams:u({arg:t,pem:n,password:o,...s}),headers:s.headers})).json();return S(a)}}function tc(e){return async function(t={}){return((await(await e.post("key/list",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Keys??[]).map(s=>S(s))}}function nc(e){return async function(t,n,o={}){let s=await e.post("key/rename",{signal:o.signal,searchParams:u({arg:[t,n],...o}),headers:o.headers});return S(await s.json())}}function oc(e){return async function(t,n={}){let s=await(await e.post("key/rm",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return S(s.Keys[0])}}function go(e){return{gen:ec(e),import:rc(e),list:tc(e),rename:nc(e),rm:oc(e)}}var X=Pe(uc(),1);X.default.formatters.b=e=>e==null?"undefined":R.baseEncode(e);X.default.formatters.t=e=>e==null?"undefined":ae.baseEncode(e);X.default.formatters.m=e=>e==null?"undefined":qe.baseEncode(e);X.default.formatters.p=e=>e==null?"undefined":e.toString();X.default.formatters.c=e=>e==null?"undefined":e.toString();X.default.formatters.k=e=>e==null?"undefined":e.toString();X.default.formatters.a=e=>e==null?"undefined":e.toString();function Hp(e){let r=()=>{};return r.enabled=!1,r.color="",r.diff=0,r.log=()=>{},r.namespace=e,r.destroy=()=>!0,r.extend=()=>r,r}function lr(e){let r=Hp(`${e}:trace`);return X.default.enabled(`${e}:trace`)&&X.default.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(r=(0,X.default)(`${e}:trace`)),Object.assign((0,X.default)(e),{error:(0,X.default)(`${e}:error`),trace:r})}var wc=Pe(yc(),1),Tt=wc.default;var Xp=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;b.nanosecond=b.ns=1/1e6;b.\u00B5s=b.\u03BCs=b.us=b.microsecond=1/1e3;b.millisecond=b.ms=b[""]=1;b.second=b.sec=b.s=b.ms*1e3;b.minute=b.min=b.m=b.s*60;b.hour=b.hr=b.h=b.m*60;b.day=b.d=b.h*24;b.week=b.wk=b.w=b.d*7;b.month=b.b=b.d*(365.25/12);b.year=b.yr=b.y=b.d*365.25;function b(e="",r="ms"){var t=null;e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2");var n=e[0]==="-";return e.replace(Xp,function(o,s,i){i=xc(i),i&&(t=(t||0)+Math.abs(parseFloat(s,10))*i)}),t&&t/(xc(r)||1)*(n?-1:1)}function xc(e){return b[e]||b[e.toLowerCase().replace(/s$/,"")]}var bc=b;var Ec=()=>{};var hr=Pe(Uc(),1);var mr=class extends Error{constructor(r="Request timed out"){super(r),this.name="TimeoutError"}},kt=class extends Error{constructor(r="The operation was aborted."){super(r),this.name="AbortError"}},jr=class extends Error{response;constructor(r){super(r.statusText),this.name="HTTPError",this.response=r}};var Tc=globalThis.fetch,Mr=globalThis.Headers,bo=globalThis.Request,Eo=globalThis.Response;var im=async(e,r={})=>{let t=new XMLHttpRequest;t.open(r.method??"GET",e.toString(),!0);let{timeout:n,headers:o}=r,s=Number(n);if(!isNaN(s)&&s>0&&s<1/0&&(t.timeout=s),r.overrideMimeType!=null&&t.overrideMimeType(r.overrideMimeType),o!=null)for(let[i,a]of new Mr(o))t.setRequestHeader(i,a);return r.signal!=null&&(r.signal.onabort=()=>{t.abort()}),r.onUploadProgress!=null&&(t.upload.onprogress=r.onUploadProgress),t.responseType="arraybuffer",new Promise((i,a)=>{let f=g=>{switch(g.type){case"error":{i(Eo.error());break}case"load":{i(new So(t.responseURL,t.response,{status:t.status,statusText:t.statusText,headers:cm(t.getAllResponseHeaders())}));break}case"timeout":{a(new mr);break}case"abort":{a(new kt);break}default:break}};t.onerror=f,t.onload=f,t.ontimeout=f,t.onabort=f,t.send(r.body)})},am=Tc,kc=(e,r={})=>r.onUploadProgress!=null?im(e,r):am(e,r),cm=e=>{let r=new Mr;for(let t of e.trim().split(/[\r\n]+/)){let n=t.indexOf(": ");n>0&&r.set(t.slice(0,n),t.slice(n+1))}return r},So=class extends Eo{constructor(r,t,n){super(t,n),Object.defineProperty(this,"url",{value:r})}};var _c=Tt.bind({ignoreUndefined:!0}),_t=lr("kubo-rpc-client:fetch"),um={throwHttpErrors:!0,credentials:"same-origin"},de=class e{static HTTPError=jr;static TimeoutError=mr;static post=async(r,t)=>new e(t).post(r,t);static get=async(r,t)=>new e(t).get(r,t);static put=async(r,t)=>new e(t).put(r,t);static delete=async(r,t)=>new e(t).delete(r,t);static options=async(r,t)=>new e(t).options(r,t);opts;constructor(r={}){this.opts=_c({},um,r)}async fetch(r,t={}){let n=_c({},this.opts,t),o=new Mr(n.headers);if(typeof r!="string"&&!(r instanceof hr.URL||r instanceof bo))throw new TypeError("`resource` must be a string, URL, or Request");let s=new hr.URL(r.toString(),n.base),{searchParams:i,transformSearchParams:a,json:f}=n;i!=null&&(typeof a=="function"?s.search=a(new hr.URLSearchParams(n.searchParams)):s.search=new hr.URLSearchParams(n.searchParams).toString()),f!=null&&(n.body=JSON.stringify(n.json),o.set("content-type","application/json"));let g=[n.signal];n.timeout!=null&&isNaN(n.timeout)&&n.timeout>0&&g.push(AbortSignal.timeout(n.timeout));let l=$(g);try{globalThis.ReadableStream!=null&&n.body instanceof globalThis.ReadableStream&&(sr||ir)&&(n.body=new Blob(await mt(Ee(n.body)))),_t.trace("outgoing headers",n.headers),_t.trace("%s %s",n.method,s);let m=await kc(s.toString(),{...n,signal:n.signal,timeout:void 0,headers:o,duplex:"half"});if(_t("%s %s %d",n.method,s,m.status),_t.trace("incoming headers",m.headers),!m.ok&&n.throwHttpErrors===!0)throw n.handleError!=null&&await n.handleError(m),new jr(m);return m.iterator=async function*(){yield*lm(m.body)},m.ndjson=async function*(){for await(let E of fm(m.iterator()))t.transform!=null?yield t.transform(E):yield E},m}finally{l.clear()}}async post(r,t={}){return this.fetch(r,{...t,method:"POST"})}async get(r,t={}){return this.fetch(r,{...t,method:"GET"})}async put(r,t={}){return this.fetch(r,{...t,method:"PUT"})}async delete(r,t={}){return this.fetch(r,{...t,method:"DELETE"})}async options(r,t={}){return this.fetch(r,{...t,method:"OPTIONS"})}},fm=async function*(e){let r=new TextDecoder,t="";for await(let n of e){t+=r.decode(n,{stream:!0});let o=t.split(/\r?\n/);for(let s=0;s<o.length-1;s++){let i=o[s].trim();i.length>0&&(yield JSON.parse(i))}t=o[o.length-1]}t+=r.decode(),t=t.trim(),t.length!==0&&(yield JSON.parse(t))},lm=e=>{if(dm(e))return e;if(mm(e)){let r=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:r.next.bind(r),return(t){return e.destroy(),typeof r.return=="function"?r.return():Promise.resolve({done:!0,value:t})}}}}}if(pm(e)){let r=e.getReader();return async function*(){try{for(;;){let{done:t,value:n}=await r.read();if(t)return;n!=null&&(yield n)}}finally{r.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},dm=e=>e!==null&&typeof e[Symbol.asyncIterator]=="function",pm=e=>e!=null&&typeof e.getReader=="function",mm=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");var hm=[w("tcp").code,w("dns").code,w("dnsaddr").code,w("dns4").code,w("dns6").code];function Nc(e){let r;try{r=w("sni").code}catch{return null}for(let[t,n]of e)if(t===r&&n!==void 0)return n;return null}function Bc(e){return e.some(([r,t])=>r===w("tls").code)}function Q(e,r,t){let n=Rc[w(e).name];if(n===void 0)throw new Error(`Can't interpret protocol ${w(e).name}`);let o=n(r,t);return e===w("ip6").code?`[${o}]`:o}var Rc={ip4:(e,r)=>e,ip6:(e,r)=>r.length===0?e:`[${e}]`,tcp:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`tcp://${Q(t[0],t[1]??"",r)}:${e}`},udp:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`udp://${Q(t[0],t[1]??"",r)}:${e}`},dnsaddr:(e,r)=>e,dns4:(e,r)=>e,dns6:(e,r)=>e,dns:(e,r)=>e,ipfs:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${Q(t[0],t[1]??"",r)}/ipfs/${e}`},p2p:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${Q(t[0],t[1]??"",r)}/p2p/${e}`},http:(e,r)=>{let t=Bc(r),n=Nc(r);if(t&&n!==null)return`https://${n}`;let o=t?"https://":"http://",s=r.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=Q(s[0],s[1]??"",r);return i=i.replace("tcp://",""),`${o}${i}`},tls:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return Q(t[0],t[1]??"",r)},sni:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return Q(t[0],t[1]??"",r)},https:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");let n=Q(t[0],t[1]??"",r);return n=n.replace("tcp://",""),`https://${n}`},ws:(e,r)=>{let t=Bc(r),n=Nc(r);if(t&&n!==null)return`wss://${n}`;let o=t?"wss://":"ws://",s=r.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=Q(s[0],s[1]??"",r);return i=i.replace("tcp://",""),`${o}${i}`},wss:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");let n=Q(t[0],t[1]??"",r);return n=n.replace("tcp://",""),`wss://${n}`},"p2p-websocket-star":(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${Q(t[0],t[1]??"",r)}/p2p-websocket-star`},"p2p-webrtc-star":(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${Q(t[0],t[1]??"",r)}/p2p-webrtc-star`},"p2p-webrtc-direct":(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${Q(t[0],t[1]??"",r)}/p2p-webrtc-direct`}};function Dc(e,r){let n=I(e).stringTuples(),o=n.pop();if(o===void 0)throw new Error("Unexpected end of multiaddr");let s=w(o[0]),i=Rc[s.name];if(i==null)throw new Error(`No interpreter found for ${s.name}`);let a=i(o[1]??"",n);return r?.assumeHttp!==!1&&hm.includes(o[0])&&(a=a.replace(/^.*:\/\//,""),o[1]==="443"?a=`https://${a}`:a=`http://${a}`),(a.startsWith("http://")||a.startsWith("https://"))&&(a=new URL(a).toString(),a.endsWith("/")&&(a=a.substring(0,a.length-1))),a}function Po(e){try{e=Dc(I(e))}catch{}return e=e.toString(),e}var $c=lr("js-kubo-rpc-client:lib:error-handler"),gm=Tt.bind({ignoreUndefined:!0}),ym=sr||ir?location.protocol:"http",wm=sr||ir?location.hostname:"localhost",xm=sr||ir?location.port:"5001",bm=(e={})=>{let r,t={},n;if(typeof e=="string"||$e(e))r=new URL(Po(e));else if(e instanceof URL)r=e;else if(typeof e.url=="string"||$e(e.url))r=new URL(Po(e.url)),t=e;else if(e.url instanceof URL)r=e.url,t=e;else{t=e??{};let o=(t.protocol??ym).replace(":",""),s=(t.host??wm).split(":")[0],i=t.port??xm;r=new URL(`${o}://${s}:${i}`)}if(t.apiPath!=null?r.pathname=t.apiPath:(r.pathname==="/"||r.pathname===void 0)&&(r.pathname="api/v0"),ta){let o=Ec(r);n=t.agent??new o({keepAlive:!0,maxSockets:6})}return{...t,host:r.host,protocol:r.protocol.replace(":",""),port:Number(r.port),apiPath:r.pathname,url:r,agent:n}},Em=async e=>{let r;try{if((e.headers.get("Content-Type")??"").startsWith("application/json")){let n=await e.json();$c(n),r=n.Message??n.message}else r=await e.text()}catch(n){$c("Failed to parse error response",n),r=n.message}let t=new de.HTTPError(e);throw r!=null&&(r.includes("deadline has elapsed")&&(t=new de.TimeoutError),r.includes("context deadline exceeded")&&(t=new de.TimeoutError),r.includes("request timed out")&&(t=new de.TimeoutError),t.message=r),t},Sm=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Lc=e=>e.replace(Sm,function(r){return"-"+r.toLowerCase()}),Pm=e=>typeof e=="string"?bc(e)??0:e,Nt=class extends de{constructor(r={}){let t=bm(r);super({timeout:t.timeout!=null?Pm(t.timeout):void 0,headers:t.headers,base:`${t.url}`,handleError:Em,transformSearchParams:o=>{let s=new URLSearchParams;for(let[i,a]of o)a!=="undefined"&&a!=="null"&&i!=="signal"&&i!=="timeout"&&s.append(Lc(i),a),i==="timeout"&&!isNaN(parseInt(a))&&s.append(Lc(i),a);return s},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;let n=this.fetch;this.fetch=async(o,s={})=>(typeof o=="string"&&!o.startsWith("/")&&(o=`${t.url}/${o}`),n.call(this,o,gm(s,{method:"POST"})))}},bS=de.HTTPError;var Am=async e=>Promise.reject(new Error(`No base found for "${e}"`)),Bt=class{_basesByName;_basesByPrefix;_loadBase;constructor(r){this._basesByName={},this._basesByPrefix={},this._loadBase=r.loadBase??Am;for(let t of r.bases)this.addBase(t)}addBase(r){if(this._basesByName[r.name]!=null&&this._basesByPrefix[r.prefix]!=null)throw new Error(`Codec already exists for codec "${r.name}"`);this._basesByName[r.name]=r,this._basesByPrefix[r.prefix]=r}removeBase(r){delete this._basesByName[r.name],delete this._basesByPrefix[r.prefix]}async getBase(r){if(this._basesByName[r]!=null)return this._basesByName[r];if(this._basesByPrefix[r]!=null)return this._basesByPrefix[r];let t=await this._loadBase(r);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}};var Cm=async e=>Promise.reject(new Error(`No codec found for "${e}"`)),Rt=class{_codecsByName;_codecsByCode;_loadCodec;constructor(r){this._codecsByName={},this._codecsByCode={},this._loadCodec=r.loadCodec??Cm;for(let t of r.codecs)this.addCodec(t)}addCodec(r){if(this._codecsByName[r.name]!=null||this._codecsByCode[r.code]!=null)throw new Error(`Resolver already exists for codec "${r.name}"`);this._codecsByName[r.name]=r,this._codecsByCode[r.code]=r}removeCodec(r){delete this._codecsByName[r.name],delete this._codecsByCode[r.code]}async getCodec(r){let t=typeof r=="string"?this._codecsByName:this._codecsByCode;if(t[r]!=null)return t[r];let n=await this._loadCodec(r);return t[r]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}};var Im=async e=>Promise.reject(new Error(`No hasher found for "${e}"`)),Dt=class{_hashersByName;_hashersByCode;_loadHasher;constructor(r){this._hashersByName={},this._hashersByCode={},this._loadHasher=r.loadHasher??Im;for(let t of r.hashers)this.addHasher(t)}addHasher(r){if(this._hashersByName[r.name]!=null||this._hashersByCode[r.code]!=null)throw new Error(`Resolver already exists for codec "${r.name}"`);this._hashersByName[r.name]=r,this._hashersByCode[r.code]=r}removeHasher(r){delete this._hashersByName[r.name],delete this._hashersByCode[r.code]}async getHasher(r){let t=typeof r=="string"?this._hashersByName:this._hashersByCode;if(t[r]!=null)return t[r];let n=await this._loadHasher(r);return t[r]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}};function Fc(e){return async function(r,t,n={}){let o=await e.post("log/level",{signal:n.signal,searchParams:u({arg:[r,t],...n}),headers:n.headers});return S(await o.json())}}function Oc(e){return async function(t={}){return(await(await e.post("log/ls",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Strings}}function jc(e){return async function*(t={}){yield*(await e.post("log/tail",{signal:t.signal,searchParams:u(t),headers:t.headers})).ndjson()}}function Ao(e){return{level:Fc(e),ls:Oc(e),tail:jc(e)}}function Mc(e){return async function*(t,n={}){let o=`${t instanceof Uint8Array?p.decode(t):t}`;async function s(a){let f=a.Hash;if(f.includes("/")===!0){let l=f.startsWith("/ipfs/")===!0?f:`/ipfs/${f}`;f=(await Pt(e)(l)).cid}else f=p.parse(f);return{name:a.Name,path:o+(a.Name!=null?`/${a.Name}`:""),size:a.Size,cid:f,type:vm(a)}}let i=await e.post("ls",{signal:n.signal,searchParams:u({arg:o,...n}),headers:n.headers});for await(let a of i.ndjson()){if(a=a.Objects,a==null)throw new Error("expected .Objects in results");if(a=a[0],a==null)throw new Error("expected one array in results.Objects");let f=a.Links;if(!Array.isArray(f))throw new Error("expected one array in results.Objects[0].Links");if(f.length===0){yield s(a);return}yield*f.map(s)}}}function vm(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}function zc(e){return async function(t={}){let n=await e.post("dns",{signal:t.signal,searchParams:u(t),headers:t.headers});return S(await n.json())}}function Vc(e){return async function(t,n={}){let o=await e.post("name/publish",{signal:n.signal,searchParams:u({arg:`${t}`,...n}),headers:n.headers});return S(await o.json())}}function Hc(e){return async function(t,n={}){let o=await e.post("name/pubsub/cancel",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers});return S(await o.json())}}function Gc(e){return async function(t={}){let n=await e.post("name/pubsub/state",{signal:t.signal,searchParams:u(t),headers:t.headers});return S(await n.json())}}function qc(e){return async function(t={}){return(await(await e.post("name/pubsub/subs",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Strings??[]}}function Wc(e){return{cancel:Hc(e),state:Gc(e),subs:qc(e)}}function Jc(e){return async function*(t,n={}){let o=await e.post("name/resolve",{signal:n.signal,searchParams:u({arg:t,stream:!0,...n}),headers:n.headers});for await(let s of o.ndjson())yield s.Path}}function Co(e){return{publish:Vc(e),resolve:Jc(e),pubsub:Wc(e)}}function Kc(e){return async function(t,n,o={}){let s=await e.post("object/patch/add-link",{signal:o.signal,searchParams:u({arg:[`${t}`,n.Name??n.name??"",(n.Hash??n.cid??"").toString()??null],...o}),headers:o.headers}),{Hash:i}=await s.json();return p.parse(i)}}function Xc(e){return async function(t,n,o={}){let s=await e.post("object/patch/rm-link",{signal:o.signal,searchParams:u({arg:[`${t}`,n.Name??n.name??null],...o}),headers:o.headers}),{Hash:i}=await s.json();return p.parse(i)}}function Qc(e){return{addLink:Kc(e),rmLink:Xc(e)}}function Io(e,r){return{patch:Qc(e)}}function Um(e){return Symbol.iterator in e}function Tm(e){return Symbol.asyncIterator in e}function Yc(e){return p.asCID(e)!=null}async function*$t(e){if(e==null)throw new V(`Unexpected input: ${e}`,"ERR_UNEXPECTED_INPUT");let r=p.asCID(e);if(r!=null){yield z({cid:r});return}if(typeof e=="string"){yield z({path:e});return}if(e.cid!=null||e.path!=null)return yield z(e);if(Um(e)){let t=e[Symbol.iterator](),n=t.next();if(n.done===!0)return t;if(Yc(n.value)){yield z({cid:n.value});for(let o of t)yield z({cid:o});return}if(typeof n.value=="string"){yield z({path:n.value});for(let o of t)yield z({path:o});return}if(n.value.cid!=null||n.value.path!=null){yield z(n.value);for(let o of t)yield z(o);return}throw new V(`Unexpected input: ${typeof e}`,"ERR_UNEXPECTED_INPUT")}if(Tm(e)){let t=e[Symbol.asyncIterator](),n=await t.next();if(n.done===!0)return t;if(Yc(n.value)){yield z({cid:n.value});for await(let o of t)yield z({cid:o});return}if(typeof n.value=="string"){yield z({path:n.value});for await(let o of t)yield z({path:o});return}if(n.value.cid!=null||n.value.path!=null){yield z(n.value);for await(let o of t)yield z(o);return}throw new V(`Unexpected input: ${typeof e}`,"ERR_UNEXPECTED_INPUT")}throw new V(`Unexpected input: ${typeof e}`,"ERR_UNEXPECTED_INPUT")}function z(e){let r=e.cid??`${e.path}`;if(r==null)throw new V("Unexpected input: Please path either a CID or an IPFS path","ERR_UNEXPECTED_INPUT");let t={path:r,recursive:e.recursive!==!1};return e.metadata!=null&&(t.metadata=e.metadata),t}function Lt(e){return async function*(t,n={}){for await(let{path:o,recursive:s,metadata:i}of $t(t)){let a=await e.post("pin/add",{signal:n.signal,searchParams:u({...n,arg:o,recursive:s,metadata:i!=null?JSON.stringify(i):void 0,stream:!0}),headers:n.headers});for await(let f of a.ndjson()){if(f.Pins!=null){for(let g of f.Pins)yield p.parse(g);continue}yield p.parse(f)}}}}function Zc(e){let r=Lt(e);return async function(n,o={}){let s=await _e(r([{path:n.toString(),...o}],o));if(s==null)throw new Error("No response received");return s}}function eu(e,r,t){let n={type:e,cid:p.parse(r)};return t!=null&&(n.metadata=t),n}function ru(e){return async function*(t={}){let n=[];t.paths!=null&&(n=Array.isArray(t.paths)?t.paths:[t.paths]);let o=await e.post("pin/ls",{signal:t.signal,searchParams:u({...t,arg:n.map(s=>`${s}`),stream:!0}),headers:t.headers});for await(let s of o.ndjson()){if(s.Keys!=null){for(let i of Object.keys(s.Keys))yield eu(s.Keys[i].Type,i,s.Keys[i].Metadata);return}yield eu(s.Type,s.Cid,s.Metadata)}}}var Ft=({Name:e,Status:r,Cid:t})=>({cid:p.parse(t),name:e,status:r}),tu=e=>{if(typeof e=="string"&&e!=="")return e;throw new TypeError("service name must be passed")},nu=e=>{if(p.asCID(e)!=null)return e.toString();throw new TypeError(`CID instance expected instead of ${typeof e}`)},gr=({service:e,cid:r,name:t,status:n,all:o})=>{let s=u({service:tu(e),name:t,force:o===!0?!0:void 0});if(r!=null)for(let i of r)s.append("cid",nu(i));if(n!=null)for(let i of n)s.append("status",i);return s},ou=(e,{service:r,background:t,name:n,origins:o})=>{let s=u({arg:nu(e),service:tu(r),name:n,background:t===!0?!0:void 0});if(o!=null)for(let i of o)s.append("origin",i.toString());return s};function su(e){return async function(t,{timeout:n,signal:o,headers:s,...i}){let a=await e.post("pin/remote/add",{timeout:n,signal:o,headers:s,searchParams:ou(t,i)});return Ft(await a.json())}}function iu(e){return async function*({timeout:t,signal:n,headers:o,...s}){let i=await e.post("pin/remote/ls",{timeout:t,signal:n,headers:o,searchParams:gr(s)});for await(let a of i.ndjson())yield Ft(a)}}function au(e){return async function({timeout:t,signal:n,headers:o,...s}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:o,searchParams:gr({...s,all:!0})})}}function cu(e){return async function({timeout:t,signal:n,headers:o,...s}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:o,searchParams:gr({...s,all:!1})})}}function uu(e){let r=String(e);if(r==="undefined")throw Error("endpoint is required");return r[r.length-1]==="/"?r.slice(0,-1):r}function fu(e){let r={service:e.Service,endpoint:new URL(e.ApiEndpoint)};return e.Stat!=null&&(r.stat=km(e.Stat)),r}function km(e){switch(e.Status){case"valid":{let{Pinning:r,Pinned:t,Queued:n,Failed:o}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:r,pinned:t,failed:o}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function lu(e){return async function(t,n){let{endpoint:o,key:s,headers:i,timeout:a,signal:f}=n;await e.post("pin/remote/service/add",{timeout:a,signal:f,searchParams:u({arg:[t,uu(o),s]}),headers:i})}}function du(e){return async function(t={}){let{stat:n,headers:o,timeout:s,signal:i}=t;return(await(await e.post("pin/remote/service/ls",{timeout:s,signal:i,headers:o,searchParams:n===!0?u({stat:n}):void 0})).json()).RemoteServices.map(fu)}}function pu(e){return async function(t,n={}){await e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:u({arg:t})})}}function mu(e){return{add:lu(e),ls:du(e),rm:pu(e)}}function hu(e){return{add:su(e),ls:iu(e),rm:cu(e),rmAll:au(e),service:mu(e)}}function Ot(e){return async function*(t,n={}){for await(let{path:o,recursive:s}of $t(t)){let i=new URLSearchParams(n.searchParams);i.append("arg",`${o}`),s!=null&&i.set("recursive",String(s));let a=await e.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:u({...n,arg:`${o}`,recursive:s})});for await(let f of a.ndjson()){if(f.Pins!=null){yield*f.Pins.map(g=>p.parse(g));continue}yield p.parse(f)}}}}function gu(e){let r=Ot(e);return async function(n,o={}){let s=await _e(r([{path:n.toString(),...o}],o));if(s==null)throw new Error("No response received");return s}}function vo(e){return{addAll:Lt(e),add:Zc(e),ls:ru(e),rmAll:Ot(e),rm:gu(e),remote:hu(e)}}function yu(e){return async function*(t,n={}){yield*(await e.post("ping",{signal:n.signal,searchParams:u({arg:`${t}`,...n}),headers:n.headers,transform:S})).ndjson()}}var wu=e=>Array.isArray(e)?e.map(jt):e,jt=e=>_(yr(e)),yr=e=>Ie.decode(e),xu=e=>BigInt(`0x${_(Ie.decode(e),"base16")}`),wr=e=>Ie.encode(we(e));function bu(e){return async function(t={}){let{Strings:n}=await(await e.post("pubsub/ls",{signal:t.signal,searchParams:u(t),headers:t.headers})).json();return wu(n)??[]}}function Eu(e){return async function(t,n={}){let o=await e.post("pubsub/peers",{signal:n.signal,searchParams:u({arg:wr(t),...n}),headers:n.headers}),{Strings:s}=await o.json();return s??[]}}function Su(e){return async function(t,n,o={}){let s=u({arg:wr(t),...o}),i=new AbortController,a=$([i.signal,o.signal]);try{await(await e.post("pubsub/pub",{signal:a,searchParams:s,...await j([n],i,o.headers)})).text()}finally{a.clear()}}}var _m=lr("js-kubo-rpc-client:pubsub:subscribe");function Pu(e,r){return async function(n,o,s={}){s.signal=r.subscribe(n,o,s.signal);let i,a,f=new Promise((l,m)=>{i=l,a=m}),g=setTimeout(()=>{i()},1e3);return e.post("pubsub/sub",{signal:s.signal,searchParams:u({arg:wr(n),...s}),headers:s.headers}).catch(l=>{r.unsubscribe(n,o),a(l)}).then(l=>{clearTimeout(g),l!=null&&(Nm(l,{onMessage:m=>{if(o!=null){if(typeof o=="function"){o(m);return}typeof o.handleEvent=="function"&&o.handleEvent(m)}},onEnd:()=>{r.unsubscribe(n,o)},onError:s.onError}),i())}),f}}async function Nm(e,{onMessage:r,onEnd:t,onError:n}){n=n??_m;try{for await(let o of e.ndjson())try{if(o.from==null)continue;o.from!=null&&o.seqno!=null?r({type:"signed",from:N(o.from),data:yr(o.data),sequenceNumber:xu(o.seqno),topic:jt(o.topicIDs[0]),key:yr(o.key??"u"),signature:yr(o.signature??"u")}):r({type:"unsigned",data:yr(o.data),topic:jt(o.topicIDs[0])})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,n(s,!1,o)}}catch(o){Bm(o)||n(o,!0)}finally{t()}}var Bm=e=>{switch(e.type){case"aborted":return!0;case"abort":return!0;default:return e.name==="AbortError"}};var Mt=class{_subs;constructor(){this._subs=new Map}subscribe(r,t,n){let o=this._subs.get(r)??[];if(o.find(i=>i.handler===t)!=null)throw new Error(`Already subscribed to ${r} with this handler`);let s=new AbortController;return this._subs.set(r,[{handler:t,controller:s}].concat(o)),n?.addEventListener("abort",()=>{this.unsubscribe(r,t)}),s.signal}unsubscribe(r,t){let n=this._subs.get(r)??[],o;t!=null?(this._subs.set(r,n.filter(s=>s.handler!==t)),o=n.filter(s=>s.handler===t)):(this._subs.set(r,[]),o=n),(this._subs.get(r)??[]).length===0&&this._subs.delete(r),o.forEach(s=>{s.controller.abort()})}};function Au(e,r){return async function(n,o){r.unsubscribe(n,o)}}function Uo(e){let r=new Mt;return{ls:bu(e),peers:Eu(e),publish:Su(e),subscribe:Pu(e,r),unsubscribe:Au(e,r)}}function Cu(e){return async function*(t={}){yield*(await e.post("refs/local",{signal:t.signal,transform:S,searchParams:u(t),headers:t.headers})).ndjson()}}function To(e){async function*r(t,n={}){let o=Array.isArray(t)?t:[t];yield*(await e.post("refs",{signal:n.signal,searchParams:u({arg:o.map(i=>`${i instanceof Uint8Array?p.decode(i):i}`),...n}),headers:n.headers,transform:S})).ndjson()}return Object.assign(r,{local:Cu(e)})}function Iu(e){return async function*(t={}){yield*(await e.post("repo/gc",{signal:t.signal,searchParams:u(t),headers:t.headers,transform:o=>({err:o.Error!=null?new Error(o.Error):null,cid:o.Key?.["/"]!=null?p.parse(o.Key["/"]):null})})).ndjson()}}function zt(e){return async function(t={}){let o=await(await e.post("repo/stat",{signal:t.signal,searchParams:u(t),headers:t.headers})).json();return{numObjects:BigInt(o.NumObjects),repoSize:BigInt(o.RepoSize),repoPath:o.RepoPath,version:o.Version,storageMax:BigInt(o.StorageMax)}}}function vu(e){return async function(t={}){return(await(await e.post("repo/version",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Version}}function ko(e){return{gc:Iu(e),stat:zt(e),version:vu(e)}}function Uu(e){return async function(t,n={}){let o=await e.post("resolve",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Path:s}=await o.json();return s}}function Tu(e){return async function*(t,n={}){let o=await e.post("routing/findpeer",{signal:n.signal,searchParams:u({arg:t.toString(),stream:!0,...n}),headers:n.headers});for await(let s of o.ndjson())yield oe(s)}}function ku(e){return async function*(t,n={}){let o=await e.post("routing/findprovs",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers});for await(let s of o.ndjson())yield oe(s)}}function _u(e){return async function*(t,n={}){let o=await e.post("routing/get",{signal:n.signal,searchParams:u({arg:t instanceof Uint8Array?_(t):t.toString(),...n}),headers:n.headers});for await(let s of o.ndjson())yield oe(s)}}function Nu(e){return async function*(t,n={recursive:!1}){let o=Array.isArray(t)?t:[t],s=await e.post("routing/provide",{signal:n.signal,searchParams:u({arg:o.map(i=>i.toString()),...n}),headers:n.headers});for await(let i of s.ndjson())yield oe(i)}}function Bu(e){return async function*(t,n,o={}){let s=new AbortController,i=$([s.signal,o.signal]);try{let a=await e.post("routing/put",{signal:i,searchParams:u({arg:t instanceof Uint8Array?_(t):t.toString(),stream:!0,...o}),...await j([n],s,o.headers)});for await(let f of a.ndjson())yield oe(f)}finally{i.clear()}}}function _o(e){return{findPeer:Tu(e),findProvs:ku(e),get:_u(e),provide:Nu(e),put:Bu(e)}}function Ru(e){return async function*(t={}){yield*(await e.post("stats/bw",{signal:t.signal,searchParams:u(t),headers:t.headers,transform:o=>({totalIn:BigInt(o.TotalIn),totalOut:BigInt(o.TotalOut),rateIn:parseFloat(o.RateIn),rateOut:parseFloat(o.RateOut)})})).ndjson()}}function No(e){return{bitswap:bt(e),repo:zt(e),bw:Ru(e)}}function Du(e){return async function(t={}){await(await e.post("shutdown",{signal:t.signal,searchParams:u(t),headers:t.headers})).text()}}function $u(e){return async function(t={}){let n=await e.post("swarm/addrs",{signal:t.signal,searchParams:u(t),headers:t.headers}),{Addrs:o}=await n.json();return Object.keys(o).map(s=>({id:N(s),addrs:(o[s]??[]).map(i=>I(i))}))}}function Lu(e){return async function(t,n={}){let o=await e.post("swarm/connect",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Strings:s}=await o.json();return s??[]}}function Fu(e){return async function(t,n={}){let o=await e.post("swarm/disconnect",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Strings:s}=await o.json();return s??[]}}function Ou(e){return async function(t={}){let n=await e.post("swarm/addrs/local",{signal:t.signal,searchParams:u(t),headers:t.headers}),{Strings:o}=await n.json();return(o??[]).map(s=>I(s))}}function ju(e){return async function(t={}){return((await(await e.post("swarm/peers",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Peers??[]).map(s=>({addr:I(s.Addr),peer:N(s.Peer),muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}}function Bo(e){return{addrs:$u(e),connect:Lu(e),disconnect:Fu(e),localAddrs:Ou(e),peers:ju(e)}}function Mu(e){return async function(t={}){let n=await e.post("version",{signal:t.signal,searchParams:u(t),headers:t.headers});return{...S(await n.json()),"ipfs-http-client":"1.0.0"}}}var Ro=class{bases;codecs;hashers;bitswap;block;bootstrap;config;dag;dht;diag;files;key;log;name;object;pin;pubsub;refs;repo;routing;stats;swarm;add;addAll;cat;get;ls;id;version;stop;ping;resolve;commands;mount;isOnline;getEndpointConfig;constructor(r){let t=new Nt(r),n={name:Re.name,code:Re.code,encode:a=>a,decode:a=>a},o=Object.values(me);(r.ipld?.bases??[]).forEach(a=>o.push(a)),this.bases=new Bt({bases:o,loadBase:r.ipld?.loadBase});let s=Object.values(ts);[Qn,ft,qn,Yn,n].concat(r.ipld?.codecs??[]).forEach(a=>{s.push(a)}),this.codecs=new Rt({codecs:s,loadCodec:r.ipld?.loadCodec});let i=Object.values(rs);(r.ipld?.hashers??[]).forEach(a=>i.push(a)),this.hashers=new Dt({hashers:i,loadHasher:r.ipld?.loadHasher}),this.bitswap=to(t),this.block=no(t),this.bootstrap=oo(t),this.config=so(t),this.dag=co(t,this.codecs),this.dht=lo(t),this.diag=po(t),this.files=ho(t),this.key=go(t),this.log=Ao(t),this.name=Co(t),this.object=Io(t,this.codecs),this.pin=vo(t),this.pubsub=Uo(t),this.refs=To(t),this.repo=ko(t),this.routing=_o(t),this.stats=No(t),this.swarm=Bo(t),this.add=fa(t),this.addAll=yt(t),this.cat=Pa(t),this.get=Ya(t),this.ls=Mc(t),this.id=At(t),this.version=Mu(t),this.stop=Du(t),this.ping=yu(t),this.resolve=Uu(t),this.commands=Aa(t),this.mount=zc(t),this.isOnline=Za(t),this.getEndpointConfig=Qa(t)}};function zu(e){return new Ro(e)}function Rm(e={}){return(typeof e=="string"||$e(e)||e instanceof URL)&&(e={url:e}),zu(e)}function Dm(e,r){return{path:decodeURIComponent(new URL(e).pathname.split("/").pop()??""),content:Vu(e,r)}}async function*Vu(e,r){yield*(await de.get(e,r)).iterator()}return Ku($m);})();
return KuboRpcClient}));
