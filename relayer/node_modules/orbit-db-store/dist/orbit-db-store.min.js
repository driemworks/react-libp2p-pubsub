var Store;(()=>{var e={924:(e,t,r)=>{"use strict";var n=r(210),o=r(559),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?o(r):r}},559:(e,t,r)=>{"use strict";var n=r(612),o=r(210),i=o("%Function.prototype.apply%"),s=o("%Function.prototype.call%"),a=o("%Reflect.apply%",!0)||n.call(s,i),c=o("%Object.getOwnPropertyDescriptor%",!0),u=o("%Object.defineProperty%",!0),l=o("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}e.exports=function(e){var t=a(n,s,arguments);if(c&&u){var r=c(t,"length");r.configurable&&u(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var h=function(){return a(n,i,arguments)};u?u(e.exports,"apply",{value:h}):e.exports.apply=h},729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||e,s),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,o=[];if(0===this._eventsCount)return o;for(n in e=this._events)t.call(e,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,s=new Array(i);o<i;o++)s[o]=n[o].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,o,i,s){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,o),!0;case 5:return l.fn.call(l.context,t,n,o,i),!0;case 6:return l.fn.call(l.context,t,n,o,i,s),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var f,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,o);break;default:if(!c)for(f=1,c=new Array(h-1);f<h;f++)c[f-1]=arguments[f];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,o){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||n&&a.context!==n||s(this,i);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||o&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}y(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var o,i,s,u;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(o=c(e))>0&&s.length>o&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=l.bind(n);return o.listener=r,n.wrapFn=o,o}function f(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):d(o,o.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){n.once&&e.removeEventListener(t,o),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,l=d(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,o,i,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return f(this,e,!0)},i.prototype.rawListeners=function(e){return f(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},29:(e,t,r)=>{"use strict";var n=r(320),o=Object.prototype.toString,i=Object.prototype.hasOwnProperty,s=function(e,t,r){for(var n=0,o=e.length;n<o;n++)i.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))},a=function(e,t,r){for(var n=0,o=e.length;n<o;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)},c=function(e,t,r){for(var n in e)i.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))};e.exports=function(e,t,r){if(!n(t))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=r),"[object Array]"===o.call(e)?s(e,t,i):"string"==typeof e?a(e,t,i):c(e,t,i)}},648:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,o="[object Function]";e.exports=function(e){var i=this;if("function"!=typeof i||n.call(i)!==o)throw new TypeError(t+i);for(var s,a=r.call(arguments,1),c=function(){if(this instanceof s){var t=i.apply(this,a.concat(r.call(arguments)));return Object(t)===t?t:this}return i.apply(e,a.concat(r.call(arguments)))},u=Math.max(0,i.length-a.length),l=[],h=0;h<u;h++)l.push("$"+h);if(s=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(c),i.prototype){var f=function(){};f.prototype=i.prototype,s.prototype=new f,f.prototype=null}return s}},612:(e,t,r)=>{"use strict";var n=r(648);e.exports=Function.prototype.bind||n},210:(e,t,r)=>{"use strict";var n,o=SyntaxError,i=Function,s=TypeError,a=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(e){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(e){c=null}var u=function(){throw new s},l=c?function(){try{return u}catch(e){try{return c(arguments,"callee").get}catch(e){return u}}}():u,h=r(405)(),f=Object.getPrototypeOf||function(e){return e.__proto__},p={},d="undefined"==typeof Uint8Array?n:f(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":h?f([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":p,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?f(f([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&h?f((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&h?f((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?f(""[Symbol.iterator]()):n,"%Symbol%":h?Symbol:n,"%SyntaxError%":o,"%ThrowTypeError%":l,"%TypedArray%":d,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},g=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(r=f(o.prototype))}return y[t]=r,r},w={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},m=r(612),b=r(642),v=m.call(Function.call,Array.prototype.concat),E=m.call(Function.apply,Array.prototype.splice),A=m.call(Function.call,String.prototype.replace),x=m.call(Function.call,String.prototype.slice),_=m.call(Function.call,RegExp.prototype.exec),k=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,j=function(e){var t=x(e,0,1),r=x(e,-1);if("%"===t&&"%"!==r)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var n=[];return A(e,k,(function(e,t,r,o){n[n.length]=r?A(o,S,"$1"):t||e})),n},I=function(e,t){var r,n=e;if(b(w,n)&&(n="%"+(r=w[n])[0]+"%"),b(y,n)){var i=y[n];if(i===p&&(i=g(n)),void 0===i&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new o("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');if(null===_(/^%?[^%]*%?$/,e))throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=j(e),n=r.length>0?r[0]:"",i=I("%"+n+"%",t),a=i.name,u=i.value,l=!1,h=i.alias;h&&(n=h[0],E(r,v([0,1],h)));for(var f=1,p=!0;f<r.length;f+=1){var d=r[f],g=x(d,0,1),w=x(d,-1);if(('"'===g||"'"===g||"`"===g||'"'===w||"'"===w||"`"===w)&&g!==w)throw new o("property names with quotes must have matching quotes");if("constructor"!==d&&p||(l=!0),b(y,a="%"+(n+="."+d)+"%"))u=y[a];else if(null!=u){if(!(d in u)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&f+1>=r.length){var m=c(u,d);u=(p=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:u[d]}else p=b(u,d),u=u[d];p&&!l&&(y[a]=u)}}return u}},296:(e,t,r)=>{"use strict";var n=r(210)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},405:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,o=r(419);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&o()}},419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},410:(e,t,r)=>{"use strict";var n=r(419);e.exports=function(){return n()&&!!Symbol.toStringTag}},642:(e,t,r)=>{"use strict";var n=r(612);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},584:(e,t,r)=>{"use strict";var n=r(410)(),o=r(924)("Object.prototype.toString"),i=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o(e)},s=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==o(e)&&"[object Function]"===o(e.callee)},a=function(){return i(arguments)}();i.isLegacyArguments=s,e.exports=a?i:s},320:e=>{"use strict";var t,r,n=Function.prototype.toString,o="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof o&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},o((function(){throw 42}),null,t)}catch(e){e!==r&&(o=null)}else o=null;var i=/^\s*class\b/,s=function(e){try{var t=n.call(e);return i.test(t)}catch(e){return!1}},a=function(e){try{return!s(e)&&(n.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,l=!(0 in[,]),h=function(){return!1};if("object"==typeof document){var f=document.all;c.call(f)===c.call(document.all)&&(h=function(e){if((l||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=o?function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{o(e,null,t)}catch(e){if(e!==r)return!1}return!s(e)&&a(e)}:function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(u)return a(e);if(s(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&a(e)}},662:(e,t,r)=>{"use strict";var n,o=Object.prototype.toString,i=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=r(410)(),c=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(s.test(i.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===o.call(e);if(!c)return!1;if(void 0===n){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&c(t)}return c(e)===n}},692:(e,t,r)=>{"use strict";var n=r(29),o=r(83),i=r(924),s=i("Object.prototype.toString"),a=r(410)(),c=r(296),u="undefined"==typeof globalThis?r.g:globalThis,l=o(),h=i("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},f=i("String.prototype.slice"),p={},d=Object.getPrototypeOf;a&&c&&d&&n(l,(function(e){var t=new u[e];if(Symbol.toStringTag in t){var r=d(t),n=c(r,Symbol.toStringTag);if(!n){var o=d(r);n=c(o,Symbol.toStringTag)}p[e]=n.get}})),e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!a||!(Symbol.toStringTag in e)){var t=f(s(e),8,-1);return h(l,t)>-1}return!!c&&function(e){var t=!1;return n(p,(function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}})),t}(e)}},136:e=>{e.exports={space:"",cycles:!1,replacer:(e,t)=>t,stringify:JSON.stringify}},299:(e,t,r)=>{"use strict";const n=r(136),o=r(572).isFunction,i=r(572).isBoolean,s=r(572).isObject,a=r(572).isArray,c=r(572).isRegex,u=r(572).assign,l=r(572).keys;e.exports=function(e,t){t=t||u({},n),o(t)&&(t={compare:t});const r=t.space||n.space,h=i(t.cycles)?t.cycles:n.cycles,f=t.replacer||n.replacer,p=t.stringify||n.stringify,d=t.compare&&(y=t.compare,function(e){return function(t,r){const n={key:t,value:e[t]},o={key:r,value:e[r]};return y(n,o)}});var y;h||p(e);const g=[];return function e(t,n,o,i){const u=r?"\n"+new Array(i+1).join(r):"",y=r?": ":":";if(o=function(e){return null==e?e:c(e)?e.toString():e.toJSON?e.toJSON():e}(o),void 0!==(o=f.call(t,n,o))){if(!s(o)||null===o)return p(o);if(a(o)){const t=[];for(let n=0;n<o.length;n++){const s=e(o,n,o[n],i+1)||p(null);t.push(u+r+s)}return"["+t.join(",")+u+"]"}{if(h){if(-1!==g.indexOf(o))return p("[Circular]");g.push(o)}const t=l(o).sort(d&&d(o)),n=[];for(let s=0;s<t.length;s++){const a=t[s],c=e(o,a,o[a],i+1);if(!c)continue;const l=p(a)+y+c;n.push(u+r+l)}return g.splice(g.indexOf(o),1),"{"+n.join(",")+u+"}"}}}({"":e},"",e,0)}},572:e=>{"use strict";e.exports={isArray:Array.isArray,assign:Object.assign,isObject:e=>"object"==typeof e,isFunction:e=>"function"==typeof e,isBoolean:e=>"boolean"==typeof e,isRegex:e=>e instanceof RegExp,keys:Object.keys}},506:(e,t,r)=>{"use strict";const n=r(651),o=r(539).format,i=r(187).EventEmitter;let s=!(process.type&&"renderer"===process.type||!process.version);const a={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"};let c=a.DEBUG,u=null,l=new i,h={Black:0,Red:1,Green:2,Yellow:3,Blue:4,Magenta:5,Cyan:6,Grey:7,White:9,Default:9};s||(h={Black:"Black",Red:"IndianRed",Green:"LimeGreen",Yellow:"Orange",Blue:"RoyalBlue",Magenta:"Orchid",Cyan:"SkyBlue",Grey:"DimGrey",White:"White",Default:"Black"});const f=[h.Cyan,h.Green,h.Yellow,h.Red,h.Default],p={useColors:!0,color:h.Default,showTimestamp:!0,useLocalTime:!1,showLevel:!0,filename:u,appendFile:!0};class d{constructor(e,t){this.category=e;let r={};Object.assign(r,p),Object.assign(r,t),this.options=r,this.debug=this.debug.bind(this),this.log=this.log.bind(this),this.info=this.info.bind(this),this.warn=this.warn.bind(this),this.error=this.error.bind(this)}debug(){this._shouldLog(a.DEBUG)&&this._write(a.DEBUG,o.apply(null,arguments))}log(){this._shouldLog(a.DEBUG)&&this.debug.apply(this,arguments)}info(){this._shouldLog(a.INFO)&&this._write(a.INFO,o.apply(null,arguments))}warn(){this._shouldLog(a.WARN)&&this._write(a.WARN,o.apply(null,arguments))}error(){this._shouldLog(a.ERROR)&&this._write(a.ERROR,o.apply(null,arguments))}_write(e,t){(this.options.filename||u)&&!this.fileWriter&&s&&(this.fileWriter=n.openSync(this.options.filename||u,this.options.appendFile?"a+":"w+"));let r=this._format(e,t),o=this._createLogMessage(e,t),i=this._createLogMessage(e,t,r.timestamp,r.level,r.category,r.text);this.fileWriter&&s&&n.writeSync(this.fileWriter,o+"\n",null,"utf-8"),s||!this.options.useColors?(console.log(i),l.emit("data",this.category,e,t)):e===a.ERROR?this.options.showTimestamp&&this.options.showLevel?console.error(i,r.timestamp,r.level,r.category,r.text):this.options.showTimestamp&&!this.options.showLevel?console.error(i,r.timestamp,r.category,r.text):!this.options.showTimestamp&&this.options.showLevel?console.error(i,r.level,r.category,r.text):console.error(i,r.category,r.text):this.options.showTimestamp&&this.options.showLevel?console.log(i,r.timestamp,r.level,r.category,r.text):this.options.showTimestamp&&!this.options.showLevel?console.log(i,r.timestamp,r.category,r.text):!this.options.showTimestamp&&this.options.showLevel?console.log(i,r.level,r.category,r.text):console.log(i,r.category,r.text)}_format(e,t){let r="",n="",o="",i=": ";if(this.options.useColors){const t=Object.keys(a).map((e=>a[e])).indexOf(e),c=this.options.color;s?(this.options.showTimestamp&&(r="[3"+h.Grey+"m"),this.options.showLevel&&(n="[3"+f[t]+";22m"),o="[3"+c+";1m",i="[0m: "):(this.options.showTimestamp&&(r="color:"+h.Grey),this.options.showLevel&&(n="color:"+f[t]),o="color:"+c+"; font-weight: bold")}return{timestamp:r,level:n,category:o,text:i}}_createLogMessage(e,t,r,n,o,i){r=r||"",n=n||"",o=o||"",i=i||": ",!s&&this.options.useColors&&(this.options.showTimestamp&&(r="%c"),this.options.showLevel&&(n="%c"),o="%c",i=": %c");let c="";return this.options.showTimestamp&&!this.options.useLocalTime&&(c+=(new Date).toISOString()+" "),this.options.showTimestamp&&this.options.useLocalTime&&(c+=(new Date).toLocaleString()+" "),c=r+c,this.options.showLevel&&(c+=n+"["+e+"]"+(e===a.INFO||e===a.WARN?" ":"")+" "),c+=o+this.category,c+=i+t,c}_shouldLog(e){let t="undefined"!=typeof process&&void 0!==process.env&&void 0!==process.env.LOG?process.env.LOG.toUpperCase():null;t="undefined"!=typeof window&&window.LOG?window.LOG.toUpperCase():t;const r=t||c,n=Object.keys(a).map((e=>a[e]));return n.indexOf(e)>=n.indexOf(r)}}e.exports={Colors:h,LogLevels:a,setLogLevel:e=>{c=e},setLogfile:e=>{u=e},create:(e,t)=>new d(e,t),forceBrowserMode:e=>s=!e,events:l}},470:e=>{"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function r(e,t){for(var r,n="",o=0,i=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(i===a-1||1===s);else if(i!==a-1&&2===s){if(n.length<2||2!==o||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var c=n.lastIndexOf("/");if(c!==n.length-1){-1===c?(n="",o=0):o=(n=n.slice(0,c)).length-1-n.lastIndexOf("/"),i=a,s=0;continue}}else if(2===n.length||1===n.length){n="",o=0,i=a,s=0;continue}t&&(n.length>0?n+="/..":n="..",o=2)}else n.length>0?n+="/"+e.slice(i+1,a):n=e.slice(i+1,a),o=a-i-1;i=a,s=0}else 46===r&&-1!==s?++s:s=-1}return n}var n={resolve:function(){for(var e,n="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var s;i>=0?s=arguments[i]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(n=s+"/"+n,o=47===s.charCodeAt(0))}return n=r(n,!o),o?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(e){if(t(e),0===e.length)return".";var n=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=r(e,!n)).length||n||(e="."),e.length>0&&o&&(e+="/"),n?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,r=0;r<arguments.length;++r){var o=arguments[r];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":n.normalize(e)},relative:function(e,r){if(t(e),t(r),e===r)return"";if((e=n.resolve(e))===(r=n.resolve(r)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var i=e.length,s=i-o,a=1;a<r.length&&47===r.charCodeAt(a);++a);for(var c=r.length-a,u=s<c?s:c,l=-1,h=0;h<=u;++h){if(h===u){if(c>u){if(47===r.charCodeAt(a+h))return r.slice(a+h+1);if(0===h)return r.slice(a+h)}else s>u&&(47===e.charCodeAt(o+h)?l=h:0===h&&(l=0));break}var f=e.charCodeAt(o+h);if(f!==r.charCodeAt(a+h))break;47===f&&(l=h)}var p="";for(h=o+l+1;h<=i;++h)h!==i&&47!==e.charCodeAt(h)||(0===p.length?p+="..":p+="/..");return p.length>0?p+r.slice(a+l):(a+=l,47===r.charCodeAt(a)&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var r=e.charCodeAt(0),n=47===r,o=-1,i=!0,s=e.length-1;s>=1;--s)if(47===(r=e.charCodeAt(s))){if(!i){o=s;break}}else i=!1;return-1===o?n?"/":".":n&&1===o?"//":e.slice(0,o)},basename:function(e,r){if(void 0!==r&&"string"!=typeof r)throw new TypeError('"ext" argument must be a string');t(e);var n,o=0,i=-1,s=!0;if(void 0!==r&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var a=r.length-1,c=-1;for(n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(47===u){if(!s){o=n+1;break}}else-1===c&&(s=!1,c=n+1),a>=0&&(u===r.charCodeAt(a)?-1==--a&&(i=n):(a=-1,i=c))}return o===i?i=c:-1===i&&(i=e.length),e.slice(o,i)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!s){o=n+1;break}}else-1===i&&(s=!1,i=n+1);return-1===i?"":e.slice(o,i)},extname:function(e){t(e);for(var r=-1,n=0,o=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===o&&(i=!1,o=a+1),46===c?-1===r?r=a:1!==s&&(s=1):-1!==r&&(s=-1);else if(!i){n=a+1;break}}return-1===r||-1===o||0===s||1===s&&r===o-1&&r===n+1?"":e.slice(r,o)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var r=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+n:r+"/"+n:n}(0,e)},parse:function(e){t(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var n,o=e.charCodeAt(0),i=47===o;i?(r.root="/",n=1):n=0;for(var s=-1,a=0,c=-1,u=!0,l=e.length-1,h=0;l>=n;--l)if(47!==(o=e.charCodeAt(l)))-1===c&&(u=!1,c=l+1),46===o?-1===s?s=l:1!==h&&(h=1):-1!==s&&(h=-1);else if(!u){a=l+1;break}return-1===s||-1===c||0===h||1===h&&s===c-1&&s===a+1?-1!==c&&(r.base=r.name=0===a&&i?e.slice(1,c):e.slice(a,c)):(0===a&&i?(r.name=e.slice(1,s),r.base=e.slice(1,c)):(r.name=e.slice(a,s),r.base=e.slice(a,c)),r.ext=e.slice(s,c)),a>0?r.dir=e.slice(0,a-1):i&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};n.posix=n,e.exports=n},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},955:(e,t,r)=>{"use strict";var n=r(584),o=r(662),i=r(430),s=r(692);function a(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,l=a(Object.prototype.toString),h=a(Number.prototype.valueOf),f=a(String.prototype.valueOf),p=a(Boolean.prototype.valueOf);if(c)var d=a(BigInt.prototype.valueOf);if(u)var y=a(Symbol.prototype.valueOf);function g(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function w(e){return"[object Map]"===l(e)}function m(e){return"[object Set]"===l(e)}function b(e){return"[object WeakMap]"===l(e)}function v(e){return"[object WeakSet]"===l(e)}function E(e){return"[object ArrayBuffer]"===l(e)}function A(e){return"undefined"!=typeof ArrayBuffer&&(E.working?E(e):e instanceof ArrayBuffer)}function x(e){return"[object DataView]"===l(e)}function _(e){return"undefined"!=typeof DataView&&(x.working?x(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=o,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||_(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},w.working="undefined"!=typeof Map&&w(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(w.working?w(e):e instanceof Map)},m.working="undefined"!=typeof Set&&m(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(m.working?m(e):e instanceof Set)},b.working="undefined"!=typeof WeakMap&&b(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},v.working="undefined"!=typeof WeakSet&&v(new WeakSet),t.isWeakSet=function(e){return v(e)},E.working="undefined"!=typeof ArrayBuffer&&E(new ArrayBuffer),t.isArrayBuffer=A,x.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&x(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=_;var k="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function S(e){return"[object SharedArrayBuffer]"===l(e)}function j(e){return void 0!==k&&(void 0===S.working&&(S.working=S(new k)),S.working?S(e):e instanceof k)}function I(e){return g(e,h)}function O(e){return g(e,f)}function P(e){return g(e,p)}function T(e){return c&&g(e,d)}function C(e){return u&&g(e,y)}t.isSharedArrayBuffer=j,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=I,t.isStringObject=O,t.isBooleanObject=P,t.isBigIntObject=T,t.isSymbolObject=C,t.isBoxedPrimitive=function(e){return I(e)||O(e)||P(e)||T(e)||C(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(A(e)||j(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},539:(e,t,r)=>{var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(c(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,s=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),a=n[r];r<i;a=n[++r])g(a)||!E(a)?s+=" "+a:s+=" "+c(a);return s},t.deprecate=function(e,r){if("undefined"!=typeof process&&!0===process.noDeprecation)return e;if("undefined"==typeof process)return function(){return t.deprecate(e,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}};var i={},s=/^$/;if(process.env.NODE_DEBUG){var a=process.env.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+a+"$","i")}function c(e,r){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(r)?n.showHidden=r:r&&t._extend(n,r),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),h(n,e,n.depth)}function u(e,t){var r=c.styles[t];return r?"["+c.colors[r][0]+"m"+e+"["+c.colors[r][1]+"m":e}function l(e,t){return e}function h(e,r,n){if(e.customInspect&&r&&_(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return m(o)||(o=h(e,o,n)),o}var i=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(m(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return w(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,r);if(i)return i;var s=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),x(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(r);if(0===s.length){if(_(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(v(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(A(r))return e.stylize(Date.prototype.toString.call(r),"date");if(x(r))return f(r)}var u,l="",E=!1,k=["{","}"];return d(r)&&(E=!0,k=["[","]"]),_(r)&&(l=" [Function"+(r.name?": "+r.name:"")+"]"),v(r)&&(l=" "+RegExp.prototype.toString.call(r)),A(r)&&(l=" "+Date.prototype.toUTCString.call(r)),x(r)&&(l=" "+f(r)),0!==s.length||E&&0!=r.length?n<0?v(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=E?function(e,t,r,n,o){for(var i=[],s=0,a=t.length;s<a;++s)O(t,String(s))?i.push(p(e,t,r,n,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(p(e,t,r,n,o,!0))})),i}(e,r,n,a,s):s.map((function(t){return p(e,r,n,a,t,E)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(u,l,k)):k[0]+l+k[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),O(n,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=g(r)?h(e,c.value,null):h(e,c.value,r-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),b(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.slice(1,-1),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function d(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function g(e){return null===e}function w(e){return"number"==typeof e}function m(e){return"string"==typeof e}function b(e){return void 0===e}function v(e){return E(e)&&"[object RegExp]"===k(e)}function E(e){return"object"==typeof e&&null!==e}function A(e){return E(e)&&"[object Date]"===k(e)}function x(e){return E(e)&&("[object Error]"===k(e)||e instanceof Error)}function _(e){return"function"==typeof e}function k(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!i[e])if(s.test(e)){var r=process.pid;i[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else i[e]=function(){};return i[e]},t.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(955),t.isArray=d,t.isBoolean=y,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=w,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=v,t.types.isRegExp=v,t.isObject=E,t.isDate=A,t.types.isDate=A,t.isError=x,t.types.isNativeError=x,t.isFunction=_,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(384);var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),j[e.getMonth()],t].join(" ")}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",I(),t.format.apply(t,arguments))},t.inherits=r(717),t._extend=function(e,t){if(!t||!E(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function T(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=P,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var o=this,i=function(){return n.apply(o,arguments)};e.apply(this,t).then((function(e){process.nextTick(i.bind(null,null,e))}),(function(e){process.nextTick(T.bind(null,e,i))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,n(e)),t}},430:(e,t,r)=>{"use strict";var n=r(29),o=r(83),i=r(924),s=r(296),a=i("Object.prototype.toString"),c=r(410)(),u="undefined"==typeof globalThis?r.g:globalThis,l=o(),h=i("String.prototype.slice"),f={},p=Object.getPrototypeOf;c&&s&&p&&n(l,(function(e){if("function"==typeof u[e]){var t=new u[e];if(Symbol.toStringTag in t){var r=p(t),n=s(r,Symbol.toStringTag);if(!n){var o=p(r);n=s(o,Symbol.toStringTag)}f[e]=n.get}}}));var d=r(692);e.exports=function(e){return!!d(e)&&(c&&Symbol.toStringTag in e?function(e){var t=!1;return n(f,(function(r,n){if(!t)try{var o=r.call(e);o===n&&(t=o)}catch(e){}})),t}(e):h(a(e),8,-1))}},651:e=>{"use strict";e.exports={}},696:()=>{},83:(e,t,r)=>{"use strict";var n=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],o="undefined"==typeof globalThis?r.g:globalThis;e.exports=function(){for(var e=[],t=0;t<n.length;t++)"function"==typeof o[n[t]]&&(e[e.length]=n[t]);return e}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{DefaultOptions:()=>no,default:()=>oo});var e={};r.r(e),r.d(e,{code:()=>At,createLink:()=>vt,createNode:()=>bt,decode:()=>_t,encode:()=>xt,name:()=>Et,prepare:()=>wt,validate:()=>mt});var t={};r.r(t),r.d(t,{code:()=>Qr,decode:()=>Zr,encode:()=>Yr,name:()=>Kr});var o=r(470),i=r(187);const s=async(e,t)=>{let r=0;for(const n of e)if(await t(await n,r++)===s.stop)break;return e};s.stop=Symbol("pEachSeries.stop");const a=s;var c=r(729);class u extends Error{constructor(e){super(e),this.name="TimeoutError"}}class l extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const h=e=>void 0===globalThis.DOMException?new l(e):new DOMException(e),f=e=>{const t=void 0===e.reason?h("This operation was aborted."):e.reason;return t instanceof Error?t:h(t)};var p,d=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class y{constructor(){p.set(this,[])}enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&d(this,p,"f")[this.size-1].priority>=t.priority)return void d(this,p,"f").push(r);const n=function(e,t,r){let n=0,o=e.length;for(;o>0;){const r=Math.trunc(o/2);let s=n+r;i=e[s],t.priority-i.priority<=0?(n=++s,o-=r+1):o=r}var i;return n}(d(this,p,"f"),r);d(this,p,"f").splice(n,0,r)}dequeue(){const e=d(this,p,"f").shift();return null==e?void 0:e.run}filter(e){return d(this,p,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return d(this,p,"f").length}}p=new WeakMap;var g,w,m,b,v,E,A,x,_,k,S,j,I,O,P,T,C,N,B,L,D,M,U,R,F,$,z=function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},H=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};const G=new u;class W extends Error{}class q extends c{constructor(e){var t,r,n,o;if(super(),g.add(this),w.set(this,void 0),m.set(this,void 0),b.set(this,0),v.set(this,void 0),E.set(this,void 0),A.set(this,0),x.set(this,void 0),_.set(this,void 0),k.set(this,void 0),S.set(this,void 0),j.set(this,0),I.set(this,void 0),O.set(this,void 0),P.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:y,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(o=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==o?o:""}\` (${typeof e.interval})`);z(this,w,e.carryoverConcurrencyCount,"f"),z(this,m,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),z(this,v,e.intervalCap,"f"),z(this,E,e.interval,"f"),z(this,k,new e.queueClass,"f"),z(this,S,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,z(this,P,!0===e.throwOnTimeout,"f"),z(this,O,!1===e.autoStart,"f")}get concurrency(){return H(this,I,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);z(this,I,e,"f"),H(this,g,"m",F).call(this)}async add(e,t={}){return new Promise(((r,n)=>{H(this,k,"f").enqueue((async()=>{var o,i,s;z(this,j,(i=H(this,j,"f"),++i),"f"),z(this,b,(s=H(this,b,"f"),++s),"f");try{if(null===(o=t.signal)||void 0===o?void 0:o.aborted)return void n(new W("The task was aborted."));const i=void 0===this.timeout&&void 0===t.timeout?e({signal:t.signal}):function(e,t,r,n){let o;const i=new Promise(((i,s)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if((n={customTimers:{setTimeout,clearTimeout},...n}).signal){const{signal:e}=n;e.aborted&&s(f(e)),e.addEventListener("abort",(()=>{s(f(e))}))}o=n.customTimers.setTimeout.call(void 0,(()=>{try{i(r())}catch(e){s(e)}}),t),(async()=>{try{i(await e)}catch(e){s(e)}finally{n.customTimers.clearTimeout.call(void 0,o)}})()}else i(e)}));return i.clear=()=>{clearTimeout(o),o=void 0},i}(Promise.resolve(e({signal:t.signal})),void 0===t.timeout?this.timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?H(this,P,"f"):t.throwOnTimeout)&&n(G)})),s=await i;r(s),this.emit("completed",s)}catch(e){n(e),this.emit("error",e)}H(this,g,"m",N).call(this)}),t),H(this,g,"m",M).call(this),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return H(this,O,"f")?(z(this,O,!1,"f"),H(this,g,"m",F).call(this),this):this}pause(){z(this,O,!0,"f")}clear(){z(this,k,new(H(this,S,"f")),"f")}async onEmpty(){0!==H(this,k,"f").size&&await H(this,g,"m",$).call(this,"empty")}async onSizeLessThan(e){H(this,k,"f").size<e||await H(this,g,"m",$).call(this,"next",(()=>H(this,k,"f").size<e))}async onIdle(){0===H(this,j,"f")&&0===H(this,k,"f").size||await H(this,g,"m",$).call(this,"idle")}get size(){return H(this,k,"f").size}sizeBy(e){return H(this,k,"f").filter(e).length}get pending(){return H(this,j,"f")}get isPaused(){return H(this,O,"f")}}w=new WeakMap,m=new WeakMap,b=new WeakMap,v=new WeakMap,E=new WeakMap,A=new WeakMap,x=new WeakMap,_=new WeakMap,k=new WeakMap,S=new WeakMap,j=new WeakMap,I=new WeakMap,O=new WeakMap,P=new WeakMap,g=new WeakSet,T=function(){return H(this,m,"f")||H(this,b,"f")<H(this,v,"f")},C=function(){return H(this,j,"f")<H(this,I,"f")},N=function(){var e;z(this,j,(e=H(this,j,"f"),--e),"f"),H(this,g,"m",M).call(this),this.emit("next")},B=function(){this.emit("empty"),0===H(this,j,"f")&&this.emit("idle")},L=function(){H(this,g,"m",R).call(this),H(this,g,"m",U).call(this),z(this,_,void 0,"f")},D=function(){const e=Date.now();if(void 0===H(this,x,"f")){const t=H(this,A,"f")-e;if(!(t<0))return void 0===H(this,_,"f")&&z(this,_,setTimeout((()=>{H(this,g,"m",L).call(this)}),t),"f"),!0;z(this,b,H(this,w,"f")?H(this,j,"f"):0,"f")}return!1},M=function(){if(0===H(this,k,"f").size)return H(this,x,"f")&&clearInterval(H(this,x,"f")),z(this,x,void 0,"f"),H(this,g,"m",B).call(this),!1;if(!H(this,O,"f")){const e=!H(this,g,"a",D);if(H(this,g,"a",T)&&H(this,g,"a",C)){const t=H(this,k,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&H(this,g,"m",U).call(this),!0)}}return!1},U=function(){H(this,m,"f")||void 0!==H(this,x,"f")||(z(this,x,setInterval((()=>{H(this,g,"m",R).call(this)}),H(this,E,"f")),"f"),z(this,A,Date.now()+H(this,E,"f"),"f"))},R=function(){0===H(this,b,"f")&&0===H(this,j,"f")&&H(this,x,"f")&&(clearInterval(H(this,x,"f")),z(this,x,void 0,"f")),z(this,b,H(this,w,"f")?H(this,j,"f"):0,"f"),H(this,g,"m",F).call(this)},F=function(){for(;H(this,g,"m",M).call(this););},$=async function(e,t){return new Promise((r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)}))};var V=r(696);const J=/\s+at.*[(\s](.*)\)?/,K=/^(?:(?:(?:node|node:[\w/]+|(?:(?:node:)?internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)(?:\.js)?:\d+:\d+)|native)/,Q=void 0===V.homedir?"":V.homedir().replace(/\\/g,"/");class Y extends Error{#e;name="AggregateError";constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t=(e=e.map((e=>e instanceof Error?e:null!==e&&"object"==typeof e?Object.assign(new Error(e.message),e):new Error(e)))).map((e=>"string"==typeof e.stack&&e.stack.length>0?function(e,{pretty:t=!1,basePath:r}={}){const n=r&&new RegExp(`(at | \\()${function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(r.replace(/\\/g,"/"))}`,"g");if("string"==typeof e)return e.replace(/\\/g,"/").split("\n").filter((e=>{const t=e.match(J);if(null===t||!t[1])return!0;const r=t[1];return!(r.includes(".app/Contents/Resources/electron.asar")||r.includes(".app/Contents/Resources/default_app.asar")||r.includes("node_modules/electron/dist/resources/electron.asar")||r.includes("node_modules/electron/dist/resources/default_app.asar")||K.test(r))})).filter((e=>""!==e.trim())).map((e=>(n&&(e=e.replace(n,"$1")),t&&(e=e.replace(J,((e,t)=>e.replace(t,t.replace(Q,"~"))))),e))).join("\n")}(e.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(e))).join("\n");t="\n"+function(e,t=1,r={}){const{indent:n=" ",includeEmptyLines:o=!1}=r;if("string"!=typeof e)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if("number"!=typeof t)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(t<0)throw new RangeError(`Expected \`count\` to be at least 0, got \`${t}\``);if("string"!=typeof n)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n}\``);if(0===t)return e;const i=o?/^/gm:/^(?!\s*$)/gm;return e.replace(i,n.repeat(t))}(t,4),super(t),this.#e=e}get errors(){return this.#e.slice()}}class Z extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const X=e=>void 0===globalThis.DOMException?new Z(e):new DOMException(e),ee=e=>{const t=void 0===e.reason?X("This operation was aborted."):e.reason;return t instanceof Error?t:X(t)};async function te(e,t,{concurrency:r=Number.POSITIVE_INFINITY,stopOnError:n=!0,signal:o}={}){return new Promise(((i,s)=>{if(void 0===e[Symbol.iterator]&&void 0===e[Symbol.asyncIterator])throw new TypeError(`Expected \`input\` to be either an \`Iterable\` or \`AsyncIterable\`, got (${typeof e})`);if("function"!=typeof t)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(r)&&r!==Number.POSITIVE_INFINITY||!(r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);const a=[],c=[],u=new Map;let l=!1,h=!1,f=!1,p=0,d=0;const y=void 0===e[Symbol.iterator]?e[Symbol.asyncIterator]():e[Symbol.iterator](),g=e=>{l=!0,h=!0,s(e)};o&&(o.aborted&&g(ee(o)),o.addEventListener("abort",(()=>{g(ee(o))})));const w=async()=>{if(h)return;const e=await y.next(),r=d;if(d++,e.done){if(f=!0,0===p&&!h){if(!n&&c.length>0)return void g(new Y(c));if(h=!0,0===u.size)return void i(a);const e=[];for(const[t,r]of a.entries())u.get(t)!==re&&e.push(r);i(e)}}else p++,(async()=>{try{const n=await e.value;if(h)return;const o=await t(n,r);o===re&&u.set(r,o),a[r]=o,p--,await w()}catch(e){if(n)g(e);else{c.push(e),p--;try{await w()}catch(e){g(e)}}}})()};(async()=>{for(let e=0;e<r;e++){try{await w()}catch(e){g(e);break}if(f||l)break}})()}))}const re=Symbol("skip"),ne=class{constructor(e){}append(e){}merge(e){}get(e){}has(e){}get values(){}get length(){}};class oe{constructor(e,t){this.id=e,this.time=t||0}tick(){return new oe(this.id,++this.time)}merge(e){return this.time=Math.max(this.time,e.time),new oe(this.id,this.time)}clone(){return new oe(this.id,this.time)}static compare(e,t){const r=e.time-t.time;return 0===r&&e.id!==t.id?e.id<t.id?-1:1:r}}const ie=oe;var se=Math.pow(2,31),ae=Math.pow(2,7),ce=Math.pow(2,14),ue=Math.pow(2,21),le=Math.pow(2,28),he=Math.pow(2,35),fe=Math.pow(2,42),pe=Math.pow(2,49),de=Math.pow(2,56),ye=Math.pow(2,63);const ge={encode:function e(t,r,n){r=r||[];for(var o=n=n||0;t>=se;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-o+1,r},decode:function e(t,r){var n,o=0,i=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],o+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=s-r,o},encodingLength:function(e){return e<ae?1:e<ce?2:e<ue?3:e<le?4:e<he?5:e<fe?6:e<pe?7:e<de?8:e<ye?9:10}},we=(e,t=0)=>[ge.decode(e,t),ge.decode.bytes],me=(e,t,r=0)=>(ge.encode(e,t,r),t),be=e=>ge.encodingLength(e),ve=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),Ee=(e,t)=>{const r=t.byteLength,n=be(e),o=n+be(r),i=new Uint8Array(o+r);return me(e,i,0),me(r,i,n),i.set(t,o),new Ae(e,r,t,i)};class Ae{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const xe=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(255!==r[s])throw new TypeError(i+" is ambiguous");r[s]=o}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,o=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*u+1>>>0,s=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=i-1;(0!==l||h<o)&&-1!==f;f--,h++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=h,t++}if(" "!==e[t]){for(var p=i-o;p!==i&&0===s[p];)p++;for(var d=new Uint8Array(n+(i-p)),y=n;p!==i;)d[y++]=s[p++];return d}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,o=0,i=t.length;o!==i&&0===t[o];)o++,r++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var h=t[o],f=0,p=s-1;(0!==h||f<n)&&-1!==p;p--,f++)h+=256*u[p]>>>0,u[p]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,o++}for(var d=s-n;d!==s&&0===u[d];)d++;for(var y=c.repeat(r);d<s;++d)y+=e.charAt(u[d]);return y},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class _e{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ke{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return je(this,e)}}class Se{constructor(e){this.decoders=e}or(e){return je(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const je=(e,t)=>new Se({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ie{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new _e(e,t,r),this.decoder=new ke(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Oe=({name:e,prefix:t,encode:r,decode:n})=>new Ie(e,t,r,n),Pe=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:o}=xe(r,t);return Oe({prefix:e,name:t,encode:n,decode:e=>ve(o(e))})},Te=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Oe({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],o=(1<<r)-1;let i="",s=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],s+=8;s>r;)s-=r,i+=t[o&a>>s];if(s&&(i+=t[o&a<<r-s]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const o={};for(let e=0;e<t.length;++e)o[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const s=new Uint8Array(i*r/8|0);let a=0,c=0,u=0;for(let t=0;t<i;++t){const i=o[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(t,n,r,e)}),Ce=Pe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ne=(Pe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Te({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),Be=(Te({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Te({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Te({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Te({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Te({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Te({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Te({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Te({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),(e,t)=>{const{bytes:r,version:n}=e;return 0===n?Re(r,De(e),t||Ce.encoder):Fe(r,De(e),t||Ne.encoder)}),Le=new WeakMap,De=e=>{const t=Le.get(e);if(null==t){const t=new Map;return Le.set(e,t),t}return t};class Me{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==$e)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ze)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Me.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Ee(e,t);return Me.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Me.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return Be(this,e)}toJSON(){return{"/":Be(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Me)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:o}=t;return new Me(e,r,n,o||He(e,r,n.bytes))}if(!0===t[Ge]){const{version:e,multihash:r,code:n}=t,o=(e=>{const t=ve(e),[r,n]=we(t),[o,i]=we(t.subarray(n)),s=t.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Ae(r,o,s,t)})(r);return Me.create(e,n,o)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==$e)throw new Error(`Version 0 CID must use dag-pb (code: ${$e}) block encoding`);return new Me(e,t,r,r.bytes);case 1:{const n=He(e,t,r.bytes);return new Me(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Me.create(0,$e,e)}static createV1(e,t){return Me.create(1,e,t)}static decode(e){const[t,r]=Me.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Me.inspectBytes(e),r=t.size-t.multihashSize,n=ve(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const o=n.subarray(t.multihashSize-t.digestSize),i=new Ae(t.multihashCode,t.digestSize,o,n);return[0===t.version?Me.createV0(i):Me.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=we(e.subarray(t));return t+=n,r};let n=r(),o=$e;if(18===n?(n=0,t=0):o=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,s=r(),a=r(),c=t+a;return{version:n,codec:o,multihashCode:s,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=Ue(e,t),o=Me.decode(n);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return De(o).set(r,e),o}}const Ue=(e,t)=>{switch(e[0]){case"Q":{const r=t||Ce;return[Ce.prefix,r.decode(`${Ce.prefix}${e}`)]}case Ce.prefix:{const r=t||Ce;return[Ce.prefix,r.decode(e)]}case Ne.prefix:{const r=t||Ne;return[Ne.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Re=(e,t,r)=>{const{prefix:n}=r;if(n!==Ce.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(null==o){const o=r.encode(e).slice(1);return t.set(n,o),o}return o},Fe=(e,t,r)=>{const{prefix:n}=r,o=t.get(n);if(null==o){const o=r.encode(e);return t.set(n,o),o}return o},$e=112,ze=18,He=(e,t,r)=>{const n=be(e),o=n+be(t),i=new Uint8Array(o+r.byteLength);return me(e,i,0),me(t,i,n),i.set(r,o),i},Ge=Symbol.for("@ipld/js-cid/CID"),We=({name:e,code:t,encode:r})=>new qe(e,t,r);class qe{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ee(this.code,t):t.then((e=>Ee(this.code,e)))}throw Error("Unknown type, must be binary type")}}function Ve({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*Je(e,t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r],o=Me.asCID(n);o?yield[t.join("/"),o]:"object"==typeof n&&(yield*Ke(n,t))}else{const r=Me.asCID(t);r?yield[e.join("/"),r]:yield*Ke(t,e)}}function*Ke(e,t){if(null==e||e instanceof Uint8Array)return;const r=Me.asCID(e);r&&(yield[t.join("/"),r]);for(const[r,n]of Object.entries(e)){const e=[...t,r];yield*Je(e,n)}}function*Qe(e,t){if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r];yield t.join("/"),"object"!=typeof n||Me.asCID(n)||(yield*Ye(n,t))}else yield*Ye(t,e)}function*Ye(e,t){if(null!=e&&"object"==typeof e)for(const[r,n]of Object.entries(e)){const e=[...t,r];yield e.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||Me.asCID(n)||(yield*Qe(e,n))}}class Ze{constructor({cid:e,bytes:t,value:r}){if(!e||!t||void 0===r)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:Ve(),bytes:Ve(),value:Ve(),asBlock:Ve()})}links(){return Ke(this.value,[])}tree(){return Ye(this.value,[])}get(e="/"){return function(e,t){let r=e;for(const[e,n]of t.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${t.slice(0,e+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const o=Me.asCID(r);if(o)return{value:o,remaining:t.slice(e+1).join("/")}}return{value:r}}(this.value,e.split("/").filter(Boolean))}}const Xe=new TextDecoder;function et(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const o=e[t++];if(r+=n<28?(127&o)<<n:(127&o)*2**n,o<128)break}return[r,t]}function tt(e,t){let r;[r,t]=et(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function rt(e,t){let r;return[r,t]=et(e,t),[7&r,r>>3,t]}function nt(e){const t={},r=e.length;let n=0;for(;n<r;){let r,o;if([r,o,n]=rt(e,n),1===o){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=tt(e,n)}else if(2===o){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,n]=tt(e,n),t.Name=Xe.decode(o)}else{if(3!==o)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=et(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}const ot=new TextEncoder,it=2**32;function st(e,t){let r=t.length;if("number"==typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=ct(t,r,e.Tsize)-1,t[r]=24}if("string"==typeof e.Name){const n=ot.encode(e.Name);r-=n.length,t.set(n,r),r=ct(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=ct(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function at(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+ut(r)}if("string"==typeof e.Name){const r=ot.encode(e.Name).length;t+=1+r+ut(r)}return"number"==typeof e.Tsize&&(t+=1+ut(e.Tsize)),t}function ct(e,t,r){const n=t-=ut(r);for(;r>=2147483648;)e[t++]=127&r|128,r/=128;for(;r>=128;)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function ut(e){return e%2==0&&e++,Math.floor((function(e){let t=0;return e>=it&&(e=Math.floor(e/it),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+lt[e]}(e)+6)/7)}const lt=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],ht=["Data","Links"],ft=["Hash","Name","Tsize"],pt=new TextEncoder;function dt(e,t){if(e===t)return 0;const r=e.Name?pt.encode(e.Name):[],n=t.Name?pt.encode(t.Name):[];let o=r.length,i=n.length;for(let e=0,t=Math.min(o,i);e<t;++e)if(r[e]!==n[e]){o=r[e],i=n[e];break}return o<i?-1:i<o?1:0}function yt(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function gt(e){if("object"==typeof e.asCID){const t=Me.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=Me.asCID(e.Hash);try{r||("string"==typeof e.Hash?r=Me.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=Me.decode(e.Hash)))}catch(e){throw new TypeError(`Invalid DAG-PB form: ${e.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof e.Name&&(t.Name=e.Name),"number"==typeof e.Tsize&&(t.Tsize=e.Tsize),t}function wt(e){if((e instanceof Uint8Array||"string"==typeof e)&&(e={Data:e}),"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"==typeof e.Data)t.Data=pt.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(gt),t.Links.sort(dt)}else t.Links=[];return t}function mt(e){if(!e||"object"!=typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!yt(e,ht))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||"object"!=typeof r||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!yt(r,ft))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==r.Hash||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!=typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize){if("number"!=typeof r.Tsize||r.Tsize%1!=0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===dt(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function bt(e,t=[]){return wt({Data:e,Links:t})}function vt(e,t,r){return gt({Hash:r,Name:e,Tsize:t})}const Et="dag-pb",At=112;function xt(e){mt(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),function(e){const t=function(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+ut(r)}if(e.Links)for(const r of e.Links){const e=at(r);t+=1+e+ut(e)}return t}(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=ct(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let t=e.Links.length-1;t>=0;t--){const o=st(e.Links[t],r.subarray(0,n));n-=o,n=ct(r,n,o)-1,r[n]=18}return r}(t)}function _t(e){const t=function(e){const t=e.length;let r,n,o=0,i=!1;for(;o<t;){let t,s;if([t,s,o]=rt(e,o),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===s){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,o]=tt(e,o),r&&(i=!0)}else{if(2!==s)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${s}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,o]=tt(e,o),r.push(nt(t))}}}if(o>t)throw new Error("protobuf: (PBNode) unexpected end of data");const s={};return n&&(s.Data=n),s.Links=r||[],s}(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((e=>{const t={};try{t.Hash=Me.decode(e.Hash)}catch(e){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}const kt=["string","number","bigint","symbol"],St=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];class jt{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}jt.uint=new jt(0,"uint",!0),jt.negint=new jt(1,"negint",!0),jt.bytes=new jt(2,"bytes",!0),jt.string=new jt(3,"string",!0),jt.array=new jt(4,"array",!1),jt.map=new jt(5,"map",!1),jt.tag=new jt(6,"tag",!1),jt.float=new jt(7,"float",!0),jt.false=new jt(7,"false",!0),jt.true=new jt(7,"true",!0),jt.null=new jt(7,"null",!0),jt.undefined=new jt(7,"undefined",!0),jt.break=new jt(7,"break",!0);class It{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const Ot=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,Pt=new TextDecoder,Tt=new TextEncoder;function Ct(e){return Ot&&globalThis.Buffer.isBuffer(e)}function Nt(e){return e instanceof Uint8Array?Ct(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const Bt=Ot?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):$t(e,t,r):(e,t,r)=>r-t>64?Pt.decode(e.subarray(t,r)):$t(e,t,r),Lt=Ot?e=>e.length>64?globalThis.Buffer.from(e):Ft(e):e=>e.length>64?Tt.encode(e):Ft(e),Dt=e=>Uint8Array.from(e),Mt=Ot?(e,t,r)=>Ct(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),Ut=Ot?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),Nt(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},Rt=Ot?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Ft(e,t=1/0){let r;const n=e.length;let o=null;const i=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function $t(e,t,r){const n=[];for(;t<r;){const o=e[t];let i=null,s=o>239?4:o>223?3:o>191?2:1;if(t+s<=r){let r,n,a,c;switch(s){case 1:o<128&&(i=o);break;case 2:r=e[t+1],128==(192&r)&&(c=(31&o)<<6|63&r,c>127&&(i=c));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(c=(15&o)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&o)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),t+=s}return function(e){const t=e.length;if(t<=zt)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=zt));return r}(n)}const zt=4096;class Ht{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Rt(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Mt(r,0,this.cursor)}else t=Ut(this.chunks,this.cursor);return e&&this.reset(),t}}const Gt="CBOR decode error:",Wt="CBOR encode error:",qt=[];function Vt(e,t,r){if(e.length-t<r)throw new Error(`${Gt} not enough data for type`)}qt[23]=1,qt[24]=2,qt[25]=3,qt[26]=5,qt[27]=9;const Jt=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Kt(e,t,r){Vt(e,t,1);const n=e[t];if(!0===r.strict&&n<Jt[0])throw new Error(`${Gt} integer encoded in more bytes than necessary (strict decode)`);return n}function Qt(e,t,r){Vt(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<Jt[1])throw new Error(`${Gt} integer encoded in more bytes than necessary (strict decode)`);return n}function Yt(e,t,r){Vt(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<Jt[2])throw new Error(`${Gt} integer encoded in more bytes than necessary (strict decode)`);return n}function Zt(e,t,r){Vt(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(!0===r.strict&&i<Jt[3])throw new Error(`${Gt} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===r.allowBigInt)return i;throw new Error(`${Gt} integers outside of the safe integer range are not supported`)}function Xt(e,t){return er(e,0,t.value)}function er(e,t,r){if(r<Jt[0]){const n=Number(r);e.push([t|n])}else if(r<Jt[1]){const n=Number(r);e.push([24|t,n])}else if(r<Jt[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<Jt[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<Jt[4]))throw new Error(`${Gt} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let o=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&o,o>>=8,r[7]=255&o,o>>=8,r[6]=255&o,o>>=8,r[5]=255&o,r[4]=255&i,i>>=8,r[3]=255&i,i>>=8,r[2]=255&i,i>>=8,r[1]=255&i,e.push(r)}}}Xt.encodedSize=function(e){return er.encodedSize(e.value)},er.encodedSize=function(e){return e<Jt[0]?1:e<Jt[1]?2:e<Jt[2]?3:e<Jt[3]?5:9},Xt.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const tr=BigInt(-1),rr=BigInt(1);function nr(e,t){const r=t.value,n="bigint"==typeof r?r*tr-rr:-1*r-1;er(e,t.type.majorEncoded,n)}function or(e,t,r,n){Vt(e,t,r+n);const o=Mt(e,t+r,t+r+n);return new It(jt.bytes,o,r+n)}function ir(e,t,r,n){return or(e,t,1,r)}function sr(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===jt.string?Lt(e.value):e.value),e.encodedBytes}function ar(e,t){const r=sr(t);er(e,t.type.majorEncoded,r.length),e.push(r)}function cr(e,t,r,n,o){const i=r+n;Vt(e,t,i);const s=new It(jt.string,Bt(e,t+r,t+i),i);return!0===o.retainStringBytes&&(s.byteValue=Mt(e,t+r,t+i)),s}function ur(e,t,r,n){return cr(e,t,1,r,n)}nr.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*tr-rr:-1*t-1;return r<Jt[0]?1:r<Jt[1]?2:r<Jt[2]?3:r<Jt[3]?5:9},nr.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},ar.encodedSize=function(e){const t=sr(e);return er.encodedSize(t.length)+t.length},ar.compareTokens=function(e,t){return r=sr(e),n=sr(t),r.length<n.length?-1:r.length>n.length?1:function(e,t){if(Ct(e)&&Ct(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}(r,n);var r,n};const lr=ar;function hr(e,t,r,n){return new It(jt.array,n,r)}function fr(e,t,r,n){return hr(0,0,1,r)}function pr(e,t){er(e,jt.array.majorEncoded,t.value)}function dr(e,t,r,n){return new It(jt.map,n,r)}function yr(e,t,r,n){return dr(0,0,1,r)}function gr(e,t){er(e,jt.map.majorEncoded,t.value)}function wr(e,t,r,n){return new It(jt.tag,r,1)}function mr(e,t){er(e,jt.tag.majorEncoded,t.value)}function br(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${Gt} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${Gt} Infinity values are not supported`)}return new It(jt.float,e,t)}function vr(e,t,r){const n=t.value;if(!1===n)e.push([20|jt.float.majorEncoded]);else if(!0===n)e.push([21|jt.float.majorEncoded]);else if(null===n)e.push([22|jt.float.majorEncoded]);else if(void 0===n)e.push([23|jt.float.majorEncoded]);else{let t,i=!1;r&&!0===r.float64||(_r(n),t=kr(xr,1),n===t||Number.isNaN(n)?(xr[0]=249,e.push(xr.slice(0,3)),i=!0):(Sr(n),t=jr(xr,1),n===t&&(xr[0]=250,e.push(xr.slice(0,5)),i=!0))),i||(o=n,Ar.setFloat64(0,o,!1),t=Ir(xr,1),xr[0]=251,e.push(xr.slice(0,9)))}var o}pr.compareTokens=Xt.compareTokens,pr.encodedSize=function(e){return er.encodedSize(e.value)},gr.compareTokens=Xt.compareTokens,gr.encodedSize=function(e){return er.encodedSize(e.value)},mr.compareTokens=Xt.compareTokens,mr.encodedSize=function(e){return er.encodedSize(e.value)},vr.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){_r(r);let e=kr(xr,1);if(r===e||Number.isNaN(r))return 3;if(Sr(r),e=jr(xr,1),r===e)return 5}return 9};const Er=new ArrayBuffer(9),Ar=new DataView(Er,1),xr=new Uint8Array(Er,0);function _r(e){if(e===1/0)Ar.setUint16(0,31744,!1);else if(e===-1/0)Ar.setUint16(0,64512,!1);else if(Number.isNaN(e))Ar.setUint16(0,32256,!1);else{Ar.setFloat32(0,e);const t=Ar.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)Ar.setUint16(0,31744,!1);else if(0===r)Ar.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?Ar.setUint16(0,0):e<-14?Ar.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):Ar.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function kr(e,t){if(e.length-t<2)throw new Error(`${Gt} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,o=1023&r;let i;return i=0===n?o*2**-24:31!==n?(o+1024)*2**(n-25):0===o?1/0:NaN,32768&r?-i:i}function Sr(e){Ar.setFloat32(0,e,!1)}function jr(e,t){if(e.length-t<4)throw new Error(`${Gt} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function Ir(e,t){if(e.length-t<8)throw new Error(`${Gt} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function Or(e,t,r){throw new Error(`${Gt} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function Pr(e){return()=>{throw new Error(`${Gt} ${e}`)}}vr.compareTokens=Xt.compareTokens;const Tr=[];for(let e=0;e<=23;e++)Tr[e]=Or;Tr[24]=function(e,t,r,n){return new It(jt.uint,Kt(e,t+1,n),2)},Tr[25]=function(e,t,r,n){return new It(jt.uint,Qt(e,t+1,n),3)},Tr[26]=function(e,t,r,n){return new It(jt.uint,Yt(e,t+1,n),5)},Tr[27]=function(e,t,r,n){return new It(jt.uint,Zt(e,t+1,n),9)},Tr[28]=Or,Tr[29]=Or,Tr[30]=Or,Tr[31]=Or;for(let e=32;e<=55;e++)Tr[e]=Or;Tr[56]=function(e,t,r,n){return new It(jt.negint,-1-Kt(e,t+1,n),2)},Tr[57]=function(e,t,r,n){return new It(jt.negint,-1-Qt(e,t+1,n),3)},Tr[58]=function(e,t,r,n){return new It(jt.negint,-1-Yt(e,t+1,n),5)},Tr[59]=function(e,t,r,n){const o=Zt(e,t+1,n);if("bigint"!=typeof o){const e=-1-o;if(e>=Number.MIN_SAFE_INTEGER)return new It(jt.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${Gt} integers outside of the safe integer range are not supported`);return new It(jt.negint,tr-BigInt(o),9)},Tr[60]=Or,Tr[61]=Or,Tr[62]=Or,Tr[63]=Or;for(let e=64;e<=87;e++)Tr[e]=ir;Tr[88]=function(e,t,r,n){return or(e,t,2,Kt(e,t+1,n))},Tr[89]=function(e,t,r,n){return or(e,t,3,Qt(e,t+1,n))},Tr[90]=function(e,t,r,n){return or(e,t,5,Yt(e,t+1,n))},Tr[91]=function(e,t,r,n){const o=Zt(e,t+1,n);if("bigint"==typeof o)throw new Error(`${Gt} 64-bit integer bytes lengths not supported`);return or(e,t,9,o)},Tr[92]=Or,Tr[93]=Or,Tr[94]=Or,Tr[95]=Pr("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)Tr[e]=ur;Tr[120]=function(e,t,r,n){return cr(e,t,2,Kt(e,t+1,n),n)},Tr[121]=function(e,t,r,n){return cr(e,t,3,Qt(e,t+1,n),n)},Tr[122]=function(e,t,r,n){return cr(e,t,5,Yt(e,t+1,n),n)},Tr[123]=function(e,t,r,n){const o=Zt(e,t+1,n);if("bigint"==typeof o)throw new Error(`${Gt} 64-bit integer string lengths not supported`);return cr(e,t,9,o,n)},Tr[124]=Or,Tr[125]=Or,Tr[126]=Or,Tr[127]=Pr("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)Tr[e]=fr;Tr[152]=function(e,t,r,n){return hr(0,0,2,Kt(e,t+1,n))},Tr[153]=function(e,t,r,n){return hr(0,0,3,Qt(e,t+1,n))},Tr[154]=function(e,t,r,n){return hr(0,0,5,Yt(e,t+1,n))},Tr[155]=function(e,t,r,n){const o=Zt(e,t+1,n);if("bigint"==typeof o)throw new Error(`${Gt} 64-bit integer array lengths not supported`);return hr(0,0,9,o)},Tr[156]=Or,Tr[157]=Or,Tr[158]=Or,Tr[159]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${Gt} indefinite length items not allowed`);return hr(0,0,1,1/0)};for(let e=160;e<=183;e++)Tr[e]=yr;Tr[184]=function(e,t,r,n){return dr(0,0,2,Kt(e,t+1,n))},Tr[185]=function(e,t,r,n){return dr(0,0,3,Qt(e,t+1,n))},Tr[186]=function(e,t,r,n){return dr(0,0,5,Yt(e,t+1,n))},Tr[187]=function(e,t,r,n){const o=Zt(e,t+1,n);if("bigint"==typeof o)throw new Error(`${Gt} 64-bit integer map lengths not supported`);return dr(0,0,9,o)},Tr[188]=Or,Tr[189]=Or,Tr[190]=Or,Tr[191]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${Gt} indefinite length items not allowed`);return dr(0,0,1,1/0)};for(let e=192;e<=215;e++)Tr[e]=wr;Tr[216]=function(e,t,r,n){return new It(jt.tag,Kt(e,t+1,n),2)},Tr[217]=function(e,t,r,n){return new It(jt.tag,Qt(e,t+1,n),3)},Tr[218]=function(e,t,r,n){return new It(jt.tag,Yt(e,t+1,n),5)},Tr[219]=function(e,t,r,n){return new It(jt.tag,Zt(e,t+1,n),9)},Tr[220]=Or,Tr[221]=Or,Tr[222]=Or,Tr[223]=Or;for(let e=224;e<=243;e++)Tr[e]=Pr("simple values are not supported");Tr[244]=Or,Tr[245]=Or,Tr[246]=Or,Tr[247]=function(e,t,r,n){if(!1===n.allowUndefined)throw new Error(`${Gt} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new It(jt.null,null,1):new It(jt.undefined,void 0,1)},Tr[248]=Pr("simple values are not supported"),Tr[249]=function(e,t,r,n){return br(kr(e,t+1),3,n)},Tr[250]=function(e,t,r,n){return br(jr(e,t+1),5,n)},Tr[251]=function(e,t,r,n){return br(Ir(e,t+1),9,n)},Tr[252]=Or,Tr[253]=Or,Tr[254]=Or,Tr[255]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${Gt} indefinite length items not allowed`);return new It(jt.break,void 0,1)};const Cr=[];for(let e=0;e<24;e++)Cr[e]=new It(jt.uint,e,1);for(let e=-1;e>=-24;e--)Cr[31-e]=new It(jt.negint,e,1);Cr[64]=new It(jt.bytes,new Uint8Array(0),1),Cr[96]=new It(jt.string,"",1),Cr[128]=new It(jt.array,0,1),Cr[160]=new It(jt.map,0,1),Cr[244]=new It(jt.false,!1,1),Cr[245]=new It(jt.true,!0,1),Cr[246]=new It(jt.null,null,1);const Nr={float64:!1,mapSorter:function(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const o=r.type.major,i=Br[o].compareTokens(r,n);return 0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i},quickEncodeToken:function(e){switch(e.type){case jt.false:return Dt([244]);case jt.true:return Dt([245]);case jt.null:return Dt([246]);case jt.bytes:return e.value.length?void 0:Dt([64]);case jt.string:return""===e.value?Dt([96]):void 0;case jt.array:return 0===e.value?Dt([128]):void 0;case jt.map:return 0===e.value?Dt([160]):void 0;case jt.uint:return e.value<24?Dt([Number(e.value)]):void 0;case jt.negint:if(e.value>=-24)return Dt([31-Number(e.value)])}}},Br=function(){const e=[];return e[jt.uint.major]=Xt,e[jt.negint.major]=nr,e[jt.bytes.major]=ar,e[jt.string.major]=lr,e[jt.array.major]=pr,e[jt.map.major]=gr,e[jt.tag.major]=mr,e[jt.float.major]=vr,e}(),Lr=new Ht;class Dr{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Wt} object contains circular references`);return new Dr(t,e)}}const Mr={null:new It(jt.null,null),undefined:new It(jt.undefined,void 0),true:new It(jt.true,!0),false:new It(jt.false,!1),emptyArray:new It(jt.array,0),emptyMap:new It(jt.map,0)},Ur={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new It(e>=0?jt.uint:jt.negint,e):new It(jt.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new It(jt.uint,e):new It(jt.negint,e),Uint8Array:(e,t,r,n)=>new It(jt.bytes,e),string:(e,t,r,n)=>new It(jt.string,e),boolean:(e,t,r,n)=>e?Mr.true:Mr.false,null:(e,t,r,n)=>Mr.null,undefined:(e,t,r,n)=>Mr.undefined,ArrayBuffer:(e,t,r,n)=>new It(jt.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new It(jt.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[Mr.emptyArray,new It(jt.break)]:Mr.emptyArray;n=Dr.createCheck(n,e);const o=[];let i=0;for(const t of e)o[i++]=Rr(t,r,n);return r.addBreakTokens?[new It(jt.array,e.length),o,new It(jt.break)]:[new It(jt.array,e.length),o]},Object(e,t,r,n){const o="Object"!==t,i=o?e.keys():Object.keys(e),s=o?e.size:i.length;if(!s)return!0===r.addBreakTokens?[Mr.emptyMap,new It(jt.break)]:Mr.emptyMap;n=Dr.createCheck(n,e);const a=[];let c=0;for(const t of i)a[c++]=[Rr(t,r,n),Rr(o?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,r),r.addBreakTokens?[new It(jt.map,s),a,new It(jt.break)]:[new It(jt.map,s),a]}};Ur.Map=Ur.Object,Ur.Buffer=Ur.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ur[`${e}Array`]=Ur.DataView;function Rr(e,t={},r){const n=function(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(kt.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";return function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(St.includes(t))return t}(e)||"Object"}(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||Ur[n];if("function"==typeof o){const i=o(e,n,t,r);if(null!=i)return i}const i=Ur[n];if(!i)throw new Error(`${Wt} unsupported type: ${n}`);return i(e,n,t,r)}function Fr(e,t,r,n){if(Array.isArray(t))for(const o of t)Fr(e,o,r,n);else r[t.type.major](e,t,n)}function $r(e,t,r){const n=Rr(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const o=t[n.type.major];if(o.encodedSize){const e=o.encodedSize(n,r),t=new Ht(e);if(o(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Nt(t.chunks[0])}}return Lr.reset(),Fr(Lr,n,t,r),Lr.toBytes(!0)}const zr={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Hr{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=Cr[e];if(void 0===t){const r=Tr[e];if(!r)throw new Error(`${Gt} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}}const Gr=Symbol.for("DONE"),Wr=Symbol.for("BREAK");function qr(e,t){if(e.done())return Gr;const r=e.next();if(r.type===jt.break)return Wr;if(r.type.terminal)return r.value;if(r.type===jt.array)return function(e,t,r){const n=[];for(let o=0;o<e.value;o++){const i=qr(t,r);if(i===Wr){if(e.value===1/0)break;throw new Error(`${Gt} got unexpected break to lengthed array`)}if(i===Gr)throw new Error(`${Gt} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=i}return n}(r,e,t);if(r.type===jt.map)return function(e,t,r){const n=!0===r.useMaps,o=n?void 0:{},i=n?new Map:void 0;for(let s=0;s<e.value;s++){const a=qr(t,r);if(a===Wr){if(e.value===1/0)break;throw new Error(`${Gt} got unexpected break to lengthed map`)}if(a===Gr)throw new Error(`${Gt} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${Gt} non-string keys not supported (got ${typeof a})`);if(!0===r.rejectDuplicateMapKeys&&(n&&i.has(a)||!n&&a in o))throw new Error(`${Gt} found repeat map key "${a}"`);const c=qr(t,r);if(c===Gr)throw new Error(`${Gt} found map but not enough entries (got ${s} [no value], expected ${e.value})`);n?i.set(a,c):o[a]=c}return n?i:o}(r,e,t);if(r.type===jt.tag){if(t.tags&&"function"==typeof t.tags[r.value]){const n=qr(e,t);return t.tags[r.value](n)}throw new Error(`${Gt} tag not supported (${r.value})`)}throw new Error("unsupported")}const Vr={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=Me.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new It(jt.tag,42),new It(jt.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},Jr={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Jr.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Me.decode(e.subarray(1))};const Kr="dag-cbor",Qr=113,Yr=e=>{return t=e,r=Vr,r=Object.assign({},Nr,r),$r(t,Br,r);var t,r},Zr=e=>function(e,t){if(!(e instanceof Uint8Array))throw new Error(`${Gt} data to decode must be a Uint8Array`);const r=(t=Object.assign({},zr,t)).tokenizer||new Hr(e,t),n=qr(r,t);if(n===Gr)throw new Error(`${Gt} did not find any content to decode`);if(n===Wr)throw new Error(`${Gt} got unexpected break`);if(!r.done())throw new Error(`${Gt} too many terminals, data makes no sense`);return n}(e,Jr),Xr=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),en=We({name:"sha2-256",code:18,encode:Xr("SHA-256")}),tn=(We({name:"sha2-512",code:19,encode:Xr("SHA-512")}),Ce),rn=()=>new Error("unsupported codec"),nn=e=>e?Array.isArray(e)?e.map(nn):Me.parse(e):e,on=(e,t={})=>{if(!e||"string"==typeof e)return e;if(Array.isArray(e))return e.map(on);const r=t.base||tn;return e.toString(r)},sn={[At]:e,[Qr]:t},an={raw:t,"dag-pb":e,"dag-cbor":t};async function cn(e,t,r={}){t=nn(on(t));const n=sn[t.code];if(!n)throw rn();const o=await e.block.get(t,{timeout:r.timeout}),i=await async function({bytes:e,codec:t,hasher:r}){if(!e)throw new Error('Missing required argument "bytes"');if(!t||!r)throw new Error("Missing required argument: codec or hasher");const n=t.decode(e),o=await r.digest(e),i=Me.create(1,t.code,o);return new Ze({value:n,bytes:e,cid:i})}({bytes:o,codec:n,hasher:en});if(i.cid.code===At)return JSON.parse((new TextDecoder).decode(i.value.Data));if(i.cid.code===Qr){const e=i.value;return(r.links||[]).forEach((t=>{e[t]&&(e[t]=on(e[t],r))})),e}}async function un(e,t,r,n={}){"dag-pb"===n.format&&(t=n.format);const o=an[t];if(!o)throw rn();o.code===At&&(r="string"==typeof r?r:JSON.stringify(r),r={Data:(new TextEncoder).encode(r),Links:[]}),o.code===Qr&&(n.links||[]).forEach((e=>{r[e]&&(r[e]=nn(r[e]))}));const i=await async function({value:e,codec:t,hasher:r}){if(void 0===e)throw new Error('Missing required argument "value"');if(!t||!r)throw new Error("Missing required argument: codec or hasher");const n=t.encode(e),o=await r.digest(n),i=Me.create(1,t.code,o);return new Ze({value:e,bytes:n,cid:i})}({value:r,codec:o,hasher:en});return await e.block.put(i.bytes,{cid:i.cid.bytes,version:i.cid.version,format:t,mhtype:"sha2-256",pin:n.pin,timeout:n.timeout}),(o.code===At?i.cid.toV0():i.cid).toString(n.base||tn)}const ln=e=>null!=e;var hn=r(299);const fn=()=>new Error("Ipfs instance not defined"),pn=["next","refs"],dn=e=>0===e?"dag-pb":"dag-cbor",yn=e=>gn.isEntry(e)?dn(e.v):dn(e);class gn{static async create(e,t,r,n,o=[],i,s=[],a){if(!ln(e))throw fn();if(!ln(t))throw new Error("Identity is required, cannot create entry");if(!ln(r))throw new Error("Entry requires an id");if(!ln(n))throw new Error("Entry requires data");if(!ln(o)||!Array.isArray(o))throw new Error("'next' argument is not an array");const c={hash:null,id:r,payload:n,next:o.filter(ln).map((e=>e.hash?e.hash:e)),refs:s,v:2,clock:i||new ie(t.publicKey)},u=await t.provider.sign(t,gn.toBuffer(c));return c.key=t.publicKey,c.identity=t.toJSON(),c.sig=u,c.hash=await gn.toMultihash(e,c,a),c}static async verify(e,t){if(!e)throw new Error("Identity-provider is required, cannot verify entry");if(!gn.isEntry(t))throw new Error("Invalid Log entry");if(!t.key)throw new Error("Entry doesn't have a key");if(!t.sig)throw new Error("Entry doesn't have a signature");const r=gn.toEntry(t,{presigned:!0}),n=t.v<1?"v0":"v1";return e.verify(t.sig,t.key,gn.toBuffer(r),n)}static toBuffer(e){const t=0===e.v?JSON.stringify(e):hn(e);return Buffer.from(t)}static async toMultihash(e,t,r=!1){if(!e)throw fn();if(!gn.isEntry(t))throw new Error("Invalid object format, cannot generate entry hash");const n=gn.toEntry(t);return un(e,yn(n.v),n,{links:pn,pin:r})}static toEntry(e,{presigned:t=!1,includeHash:r=!1}={}){const n={hash:r?e.hash:null,id:e.id,payload:e.payload,next:e.next},o=e.v;return o>1&&(n.refs=e.refs),n.v=e.v,n.clock=new ie(e.clock.id,e.clock.time),t||(n.key=e.key,o>0&&(n.identity=e.identity),n.sig=e.sig),n}static async fromMultihash(e,t){if(!e)throw fn();if(!t)throw new Error(`Invalid hash: ${t}`);const r=await cn(e,t,{links:pn}),n=gn.toEntry(r);return n.hash=t,n}static isEntry(e){return e&&void 0!==e.id&&void 0!==e.next&&void 0!==e.payload&&void 0!==e.v&&void 0!==e.hash&&void 0!==e.clock&&(void 0!==e.refs||e.v<2)}static compare(e,t){const r=ie.compare(e.clock,t.clock);return 0===r?e.clock.id<t.clock.id?-1:1:r}static isEqual(e,t){return e.hash===t.hash}static isParent(e,t){return t.next.indexOf(e.hash)>-1}static findChildren(e,t){let r=[],n=t.find((t=>gn.isParent(e,t))),o=e;for(;n;)r.push(n),o=n,n=t.find((e=>gn.isParent(o,e)));return r=r.sort(((e,t)=>e.clock.time>t.clock.time)),r}}const wn=gn;async function mn(e,t){if(t(await e()))return mn(e,t)}const{isEntry:bn,fromMultihash:vn}=wn,En=e=>e&&e.length>0;class An{static async fetchParallel(e,t,{length:r,exclude:n=[],shouldExclude:o,timeout:i,concurrency:s,onProgressCallback:a}){return(await te(t,(async t=>An.fetchAll(e,t,{length:r,exclude:n,shouldExclude:o,timeout:i,onProgressCallback:a,concurrency:s})),{concurrency:Math.max(s||t.length,1)})).reduce(((e,t)=>e.concat(t)),[])}static async fetchAll(e,t,{length:r=-1,exclude:n=[],shouldExclude:o,timeout:i,onProgressCallback:s,onStartProgressCallback:a,concurrency:c=32,delay:u=0}={}){const l=[],h={},f={},p=Array.isArray(t)?{0:t.slice()}:{0:[t]};let d=0,y=0,g=0;o=o||(()=>!1);const w=(e,t)=>{f[e]||o(e)||(p[t]||(p[t]=[]),p[t].includes(e)||p[t].push(e),f[e]=!0)},m=async t=>{if(t&&!h[t]&&!o(t))return new Promise((async(n,c)=>{const f=i&&i>0?setTimeout((()=>{console.warn(`Warning: Couldn't fetch entry '${t}', request timed out (${i}ms)`),n()}),i):null;a&&a(t,null,0,l.length);try{const i=await vn(e,t);if(u>0){const e=(e=0)=>new Promise((t=>setTimeout(t,e)));await e(u)}(e=>{if(bn(e)&&!h[e.hash]&&!o(e.hash)){const t=e.clock.time;y=Math.max(y,t),g=l.length>0?Math.min(l[l.length-1].clock.time,g):y;const n=l.length>=r&&t>=g,i=e=>y-t+(e+1)*e;!(r<0||l.length<r||n)||o(e.hash)||h[e.hash]||(l.push(e),h[e.hash]=!0,s&&s(e)),r<0?(e.next.forEach(w),e.refs&&e.refs.forEach(w)):((l.length<r||t>g||t===g&&!h[e.hash]&&!o(e.hash))&&e.next.forEach((e=>w(e,i(0)))),e.refs&&l.length+e.refs.length<=r&&e.refs.forEach(((e,t)=>w(e,i(t)))))}})(i),n()}catch(e){c(e)}finally{clearTimeout(f)}}))};return n.forEach((e=>{h[e.hash||e]=!0})),await mn((async()=>{if(d<c){const e=((e=1)=>Object.keys(p).reduce(((t,r,n)=>{const o=p[r];for(;o.length>0&&t.length<e;){const e=o.shift();t.push(e)}return 0===o.length&&delete p[r],t}),[]))(c);d+=e.length,await te(e,m,{concurrency:c}),d-=e.length}}),(()=>void 0!==Object.values(p).find(En))),l}}const xn=An;function _n(e,t,r){const n=ie.compare(e.clock,t.clock);return 0===n?r(e,t):n}function kn(e,t,r){return e.clock.id===t.clock.id?r(e,t):e.clock.id<t.clock.id?-1:1}const Sn={SortByClocks:_n,SortByClockId:kn,LastWriteWins:function(e,t){const r=(e,t)=>e,n=(e,t)=>kn(e,t,r);return((e,t)=>_n(e,t,n))(e,t)},SortByEntryHash:function(e,t){const r=(e,t)=>e.hash<t.hash?-1:1,n=(e,t)=>kn(e,t,r);return((e,t)=>_n(e,t,n))(e,t)},NoZeroes:function(e){const t=`Your log's tiebreaker function, ${e.name}, has returned zero and therefore cannot be`;return(r,n)=>{const o=e(r,n);if(0===o)throw Error(t);return o}}},jn=()=>new Error("IPFS instance not defined"),In=()=>new Error("Log instance not defined"),On=()=>new Error("Given argument is not an instance of Log"),Pn=()=>new Error("lt or lte must be a string or array of Entries"),Tn=function(e,t){const r={};return e.forEach((e=>r[t?e[t]:e]=e)),Object.keys(r).map((e=>r[e]))},{LastWriteWins:Cn,NoZeroes:Nn}=Sn,{fetchAll:Bn,fetchParallel:Ln}=xn,{compare:Dn,isEntry:Mn}=wn,Un=["heads"],Rn=(e,t)=>e.slice(e.length-Math.min(e.length,t),e.length),Fn=class{static async toMultihash(e,t,{format:r}={}){if(!ln(e))throw jn();if(!ln(t))throw In();if(ln(r)||(r="dag-cbor"),t.values.length<1)throw new Error("Can't serialize an empty log");return un(e,r,t.toJSON(),{links:Un})}static async fromMultihash(e,t,{length:r=-1,exclude:n=[],shouldExclude:o,timeout:i,concurrency:s,sortFn:a,onProgressCallback:c}){if(!ln(e))throw jn();if(!ln(t))throw new Error(`Invalid hash: ${t}`);const u=await cn(e,t,{links:Un});if(!u.heads||!u.id)throw On();a=a||Nn(Cn);const l=await Bn(e,u.heads,{length:r,exclude:n,shouldExclude:o,timeout:i,concurrency:s,onProgressCallback:c}),h=u.id,f=r>-1?Rn(l.sort(a),r):l,p=f.filter((e=>u.heads.includes(e.hash)));return{logId:h,entries:f,heads:p}}static async fromEntryHash(e,t,{length:r=-1,exclude:n=[],shouldExclude:o,timeout:i,concurrency:s,sortFn:a,onProgressCallback:c}){if(!ln(e))throw jn();if(!ln(t))throw new Error("'hash' must be defined");const u=Array.isArray(t)?t:[t];r=r>-1?Math.max(r,1):r;const l=await Ln(e,u,{length:r,exclude:n,shouldExclude:o,timeout:i,concurrency:s,onProgressCallback:c});return a=a||Nn(Cn),{entries:r>-1?Rn(l.sort(a),r):l}}static async fromJSON(e,t,{length:r=-1,timeout:n,concurrency:o,onProgressCallback:i}){if(!ln(e))throw jn();const{id:s,heads:a}=t,c=a.map((e=>e.hash));return{logId:s,entries:(await Ln(e,c,{length:r,timeout:n,concurrency:o,onProgressCallback:i})).sort(Dn),heads:a}}static async fromEntry(e,t,{length:r=-1,exclude:n=[],shouldExclude:o,timeout:i,concurrency:s,onProgressCallback:a}){if(!ln(e))throw jn();if(!ln(t))throw new Error("'sourceEntries' must be defined");if(!Array.isArray(t)&&!Mn(t))throw new Error("'sourceEntries' argument must be an array of Entry instances or a single Entry");Array.isArray(t)||(t=[t]),r=r>-1?Math.max(r,t.length):r;const c=t.map((e=>e.hash)),u=await Ln(e,c,{length:r,exclude:n,shouldExclude:o,timeout:i,concurrency:s,onProgressCallback:a}),l=t.concat(u).concat(n),h=Tn(l,"hash").sort(Dn),f=h.slice(r>-1?-r:-h.length),p=((e,t)=>{const r=e.slice(t.length,e.length);return t.concat(r)})(f,function(e,t,r){const n={},o={};return e.forEach((e=>o[r?e[r]:e]=!0)),t.reduce(((e,t)=>{const i=void 0!==o[r?t[r]:t],s=void 0!==n[r?t[r]:t];return i||s||(e.push(t),n[r?t[r]:t]=!0),e}),[])}(f,t,"hash"));return{logId:p[p.length-1].id,entries:p}}},$n=class{constructor(e={}){this._cache=e}set(e,t){this._cache[e]=t}get(e){return this._cache[e]}delete(e){return delete this._cache[e]}add(e){this._cache=Object.assign(this._cache,e)}get length(){return Object.values(this._cache).length}},{LastWriteWins:zn,NoZeroes:Hn}=Sn,Gn=e=>e.hash,Wn=(e,t)=>e.concat(t),qn=e=>e.next,Vn=(e,t)=>Math.max(e,t.clock.time),Jn=(e,t)=>(e[t.hash]=t,e);class Kn extends ne{constructor(e,t,{logId:r,access:n,entries:o,heads:i,clock:s,sortFn:a,concurrency:c}={}){if(!ln(e))throw jn();if(!ln(t))throw new Error("Identity is required");if(ln(n)||(n=new class{async canAppend(e,t){return!0}}),ln(o)&&!Array.isArray(o))throw new Error("'entries' argument must be an array of Entry instances");if(ln(i)&&!Array.isArray(i))throw new Error("'heads' argument must be an array");ln(a)||(a=zn),super(),this._sortFn=Hn(a),this._storage=e,this._id=r||(new Date).getTime().toString(),this._access=n,this._identity=t;const u=(o||[]).reduce(Jn,{});this._entryIndex=new $n(u),o=Object.values(u)||[],i=i||Kn.findHeads(o),this._headsIndex=i.reduce(Jn,{}),this._nextsIndex={},o.forEach((e=>e.next.forEach((t=>this._nextsIndex[t]=e.hash)))),this._length=o.length;const l=Math.max(s?s.time:0,this.heads.reduce(Vn,0));this._clock=new ie(this._identity.publicKey,l),this.joinConcurrency=c||16}get id(){return this._id}get clock(){return this._clock}get length(){return this._length}get values(){return Object.values(this.traverse(this.heads)).reverse()}get heads(){return Object.values(this._headsIndex).sort(this._sortFn).reverse()}get tails(){return Kn.findTails(this.values)}get tailHashes(){return Kn.findTailHashes(this.values)}setIdentity(e){this._identity=e;const t=Math.max(this.clock.time,this.heads.reduce(Vn,0));this._clock=new ie(this._identity.publicKey,t)}get(e){return this._entryIndex.get(e)}has(e){return void 0!==this._entryIndex.get(e.hash||e)}traverse(e,t=-1,r){let n=e.sort(this._sortFn).reverse(),o={};const i={};let s=0;const a=e=>this.get(e),c=e=>{e&&!o[e.hash]&&(n=[e,...n].sort(this._sortFn).reverse(),o[e.hash]=!0)};for(;n.length>0&&(s<t||t<0);){const e=n.shift();if(i[(u=e).hash]=u,o[u.hash]=!0,s++,r&&r===e.hash)break;e.next.map(a).filter(ln).forEach(c)}var u;return n=[],o={},i}async append(e,t=1,r=!1){const n=Math.max(this.clock.time,this.heads.reduce(Vn,0))+1;this._clock=new ie(this.clock.id,n);const o=Object.values(this.traverse(this.heads,Math.max(t,this.heads.length))),i=(e=>{const t=new Set;for(let r=1;r<=e;r*=2){const e=Math.min(r-1,o.length-1);t.add(o[e])}return t})(Math.min(t,o.length));o.length<t&&o[o.length-1]&&i.add(o[o.length-1]);const s=Object.keys(this.heads.reverse().reduce(Jn,{})),a=Array.from(i).map(Gn).filter((e=>!s.includes(e))),c=await wn.create(this._storage,this._identity,this.id,e,s,this.clock,a,r);if(!await this._access.canAppend(c,this._identity.provider))throw new Error(`Could not append entry, key "${this._identity.id}" is not allowed to write to the log`);return this._entryIndex.set(c.hash,c),s.forEach((e=>this._nextsIndex[e]=c.hash)),this._headsIndex={},this._headsIndex[c.hash]=c,this._length++,c}iterator({gt:e,gte:t,lt:r,lte:n,amount:o=-1}={}){if(0===o)return function*(){}();if("string"==typeof n&&(n=[this.get(n)]),"string"==typeof r&&(r=[this.get(this.get(r).next[0])]),n&&!Array.isArray(n))throw Pn();if(r&&!Array.isArray(r))throw Pn();const i=(n||r||this.heads).filter(ln),s=t?this.get(t).hash:e?this.get(e).hash:null,a=s?-1:o||-1,c=this.traverse(i,a,s);let u=Object.values(c);return e&&u.pop(),(e||t)&&o>-1&&(u=u.slice(u.length-o,u.length)),function*(){for(const e in u)yield u[e]}()}async join(e,t=-1){if(!ln(e))throw In();if(!Kn.isLog(e))throw On();if(this.id!==e.id)return;const r=Kn.difference(e,this),n=this._identity.provider,o=async e=>{if(!await this._access.canAppend(e,n))throw new Error(`Could not append entry, key "${e.identity.id}" is not allowed to write to the log`)},i=Object.values(r);await te(i,(async e=>{await o(e),await(async e=>{const t=await wn.verify(n,e),r=e.identity?e.identity.publicKey:e.key;if(!t)throw new Error(`Could not validate signature "${e.sig}" for entry "${e.hash}" and key "${r}"`)})(e)}),{concurrency:this.joinConcurrency}),Object.values(r).forEach((e=>{this.get(e.hash)||this._length++,e.next.forEach((t=>this._nextsIndex[t]=e.hash))})),this._entryIndex.add(r);const s=Object.values(r).map(qn).reduce(Wn,[]),a=Kn.findHeads(Object.values(Object.assign({},this._headsIndex,e._headsIndex))).filter((e=>!s.find((t=>t===e.hash)))).filter((e=>!this._nextsIndex[e.hash])).reduce(Jn,{});if(this._headsIndex=a,t>-1){let e=this.values;e=e.slice(-t),this._entryIndex=null,this._entryIndex=new $n(e.reduce(Jn,{})),this._headsIndex=Kn.findHeads(e).reduce(Jn,{}),this._length=this._entryIndex.length}const c=Object.values(this._headsIndex).reduce(Vn,0);return this._clock=new ie(this.clock.id,Math.max(this.clock.time,c)),this}toJSON(){return{id:this.id,heads:this.heads.sort(this._sortFn).reverse().map(Gn)}}toSnapshot(){return{id:this.id,heads:this.heads,values:this.values}}toBuffer(){return Buffer.from(JSON.stringify(this.toJSON()))}toString(e){return this.values.slice().reverse().map(((t,r)=>{const n=wn.findChildren(t,this.values).length;let o=new Array(Math.max(n-1,0));return o=n>1?o.fill("  "):o,o=n>0?o.concat(["└─"]):o,o.join("")+(e?e(t.payload):t.payload)})).join("\n")}static isLog(e){return void 0!==e.id&&void 0!==e.heads&&void 0!==e._entryIndex}toMultihash({format:e}={}){return Fn.toMultihash(this._storage,this,{format:e})}static async fromMultihash(e,t,r,{access:n,length:o=-1,exclude:i=[],shouldExclude:s,timeout:a,concurrency:c,sortFn:u,onProgressCallback:l}={}){const{logId:h,entries:f,heads:p}=await Fn.fromMultihash(e,r,{length:o,exclude:i,shouldExclude:s,timeout:a,onProgressCallback:l,concurrency:c,sortFn:u});return new Kn(e,t,{logId:h,access:n,entries:f,heads:p,sortFn:u})}static async fromEntryHash(e,t,r,{logId:n,access:o,length:i=-1,exclude:s=[],shouldExclude:a,timeout:c,concurrency:u,sortFn:l,onProgressCallback:h}={}){const{entries:f}=await Fn.fromEntryHash(e,r,{length:i,exclude:s,shouldExclude:a,timeout:c,concurrency:u,onProgressCallback:h});return new Kn(e,t,{logId:n,access:o,entries:f,sortFn:l})}static async fromJSON(e,t,r,{access:n,length:o=-1,timeout:i,sortFn:s,onProgressCallback:a}={}){const{logId:c,entries:u}=await Fn.fromJSON(e,r,{length:o,timeout:i,onProgressCallback:a});return new Kn(e,t,{logId:c,access:n,entries:u,sortFn:s})}static async fromEntry(e,t,r,{access:n,length:o=-1,exclude:i=[],timeout:s,concurrency:a,sortFn:c,onProgressCallback:u}={}){const{logId:l,entries:h}=await Fn.fromEntry(e,r,{length:o,exclude:i,timeout:s,concurrency:a,onProgressCallback:u});return new Kn(e,t,{logId:l,access:n,entries:h,sortFn:c})}static findHeads(e){const t=e.reduce(((e,t,r,n)=>(t.next.forEach((r=>e[r]=t.hash)),e)),{});return e.filter((e=>void 0===t[e.hash])).sort(((e,t)=>e.clock.id>t.clock.id))}static findTails(e){const t={},r=[],n={};let o=[];e.forEach((e=>{0===e.next.length&&r.push(e),e.next.forEach((r=>{t[r]||(t[r]=[]),t[r].push(e)})),o=o.concat(e.next),n[e.hash]=!0}));const i=o.filter((e=>void 0===n[e])).map((e=>t[e])).reduce(((e,t,r,n)=>e.concat(Tn(t,"hash"))),[]).concat(r);return Tn(i,"hash").sort(wn.compare)}static findTailHashes(e){const t={};return e.forEach((e=>t[e.hash]=!0)),e.reduce(((e,r,n,o)=>(r.next.reverse().forEach((r=>{void 0===t[r]&&e.splice(0,0,r)})),e)),[])}static difference(e,t){const r=Object.keys(e._headsIndex),n={},o={},i=e=>{n[e]||t.get(e)||(r.push(e),n[e]=!0)};for(;r.length>0;){const s=r.shift(),a=e.get(s);a&&!t.get(s)&&a.id===t.id&&(o[a.hash]=a,n[a.hash]=!0,a.next.concat(a.refs).forEach(i))}return o}}const Qn=Kn,Yn=e=>[...new Set([...e.next,...e.refs])],Zn=(e,t)=>e.concat(t);class Xn{constructor(e,t){this._store=e,this._concurrency=t||32,this._q=new q({concurrency:this._concurrency}),this._logs=[],this._fetching={},this._fetched={},this._q.on("idle",(async()=>{const e=this._logs.slice();if(this._logs=[],this.onReplicationComplete&&e.length>0&&this._store._oplog)try{await this.onReplicationComplete(e),e.forEach((e=>e.values.forEach((e=>delete this._fetched[e.hash]))))}catch(e){console.error(e)}}))}get tasksRunning(){return this._q.pending}get tasksQueued(){return this._q.size}get unfinished(){return Object.keys(this._fetching)}async load(e){try{this._addToQueue(e)}catch(e){console.error(e)}}async _addToQueue(e){const t=e=>e&&this._store._oplog&&(this._store._oplog.has(e)||void 0!==this._fetching[e]||this._fetched[e]),r=e=>(this._fetching[e.hash||e]=!0,async()=>{e.hash&&this.onReplicationQueued&&this.onReplicationQueued(e);try{const t=await this._replicateLog(e);this._logs.push(t)}catch(e){throw console.error(e),e}delete this._fetching[e.hash||e]});if(e.length>0){const n=e.filter((e=>!t(e.hash||e))).map((e=>r(e)));n.length>0&&this._q.addAll(n)}}async stop(){this._q.pause(),this._q.clear(),await this._q.onIdle(),this._logs=[],this._fetching={},this._fetched={}}async _replicateLog(e){const t=e.hash||e,r=await Qn.fromEntryHash(this._store._ipfs,this._store.identity,t,{logId:this._store.id,access:this._store.access,length:-1,exclude:[],shouldExclude:e=>e&&e!==t&&this._store._oplog&&(this._store._oplog.has(e)||void 0!==this._fetching[e]||void 0!==this._fetched[e]),concurrency:this._concurrency,onProgressCallback:e=>{this._fetched[e.hash]=!0,this.onReplicationProgress&&this.onReplicationProgress(e)}}),n=r.values.map(Yn).reduce(Zn,[]);try{this._addToQueue(n)}catch(e){throw console.error(e),e}return r}}class eo{constructor(){this.progress=0,this.max=0}reset(){this.progress=0,this.max=0}}var to=r(506);const ro=to.create("orbit-db.store",{color:to.Colors.Blue});to.setLogLevel("ERROR");const no={Index:class{constructor(e){this.id=e,this._index=[]}get(){return this._index}async updateIndex(e,t){this._index=e.values}},maxHistory:-1,fetchEntryTimeout:null,referenceCount:32,replicationConcurrency:32,syncLocal:!1,sortFn:void 0};class oo{constructor(e,t,r,n){if(!t)throw new Error("Identity required");const s=Object.assign({},no);Object.assign(s,n),this.options=s,this._type="store",this.id=r.toString(),this.identity=t,this.address=r,this.dbname=r.path||"",this.events=new i.EventEmitter,this.remoteHeadsPath=o.join(this.id,"_remoteHeads"),this.localHeadsPath=o.join(this.id,"_localHeads"),this.snapshotPath=o.join(this.id,"snapshot"),this.queuePath=o.join(this.id,"queue"),this.manifestPath=o.join(this.id,"_manifest"),this._ipfs=e,this._cache=n.cache;const a={canAppend:e=>e.identity.publicKey===t.publicKey};this.access=n.accessController||a,this._oplog=new Qn(this._ipfs,this.identity,{logId:this.id,access:this.access,sortFn:this.options.sortFn}),this._queue=new q({concurrency:1}),this._index=new this.options.Index(this.address.root),this._replicationStatus=new eo,this._stats={snapshot:{bytesLoaded:-1},syncRequestsReceieved:0};try{const e=async e=>{this._recalculateReplicationMax(e.clock?e.clock.time:0),this.events.emit("replicate",this.address.toString(),e)},t=async e=>{const t=this.replicationStatus.progress,r=this.replicationStatus.max;this._recalculateReplicationStatus(e.clock.time),(this._oplog.length+1>this.replicationStatus.progress||this.replicationStatus.progress>t||this.replicationStatus.max>r)&&this.events.emit("replicate.progress",this.address.toString(),e.hash,e,this.replicationStatus.progress,this.replicationStatus.max)},r=async e=>{await this._queue.add((async()=>{try{if(this._oplog&&e.length>0){for(const t of e)await this._oplog.join(t);const t=this._oplog.heads;await this._cache.set(this.remoteHeadsPath,t),ro.debug(`Saved heads ${t.length} [${t.map((e=>e.hash)).join(", ")}]`),await this._updateIndex(),this._oplog.length>this.replicationStatus.progress&&this._recalculateReplicationStatus(this._oplog.length),this.events.emit("replicated",this.address.toString(),e.length,this)}}catch(e){console.error(e)}}).bind(this))};this._replicator=new Xn(this,this.options.replicationConcurrency),this._loader=this._replicator,this._replicator.onReplicationQueued=e,this._replicator.onReplicationProgress=t,this._replicator.onReplicationComplete=r}catch(e){console.error("Store Error:",e)}this.events.on("replicated.progress",((e,t,r,n,o)=>{this._procEntry(r)})),this.events.on("write",((e,t,r)=>{this._procEntry(t)}))}get all(){return Array.isArray(this._index._index)?this._index._index:Object.keys(this._index._index).map((e=>this._index._index[e]))}get index(){return this._index._index}get type(){return this._type}get key(){return this._key}get replicationStatus(){return this._replicationStatus}setIdentity(e){this.identity=e,this._oplog.setIdentity(e)}async close(){await this._replicator.stop(),await this._queue.onIdle(),this._replicationStatus.reset(),this._stats={snapshot:{bytesLoaded:-1},syncRequestsReceieved:0},this.options.onClose&&await this.options.onClose(this),this.access.close&&await this.access.close();for(const e in this.events._events)this.events.removeAllListeners(e);return this._oplog=null,this.events.emit("closed",this.address.toString()),Promise.resolve()}async drop(){this.options.onDrop&&await this.options.onDrop(this),await this._cache.del(this.localHeadsPath),await this._cache.del(this.remoteHeadsPath),await this._cache.del(this.snapshotPath),await this._cache.del(this.queuePath),await this._cache.del(this.manifestPath),await this.close(),this._index=new this.options.Index(this.address.root),this._oplog=new Qn(this._ipfs,this.identity,{logId:this.id,access:this.access,sortFn:this.options.sortFn}),this._cache=this.options.cache}async load(e,t={}){"object"==typeof e&&(t=e,e=void 0),e=e||this.options.maxHistory;const r=t.fetchEntryTimeout||this.options.fetchEntryTimeout;this.options.onLoad&&await this.options.onLoad(this);const n=await this._cache.get(this.localHeadsPath)||[],o=await this._cache.get(this.remoteHeadsPath)||[],i=n.concat(o);i.length>0&&this.events.emit("load",this.address.toString(),i),i.forEach((e=>this._recalculateReplicationMax(e.clock.time)));const s=await Qn.fromEntryHash(this._ipfs,this.identity,i.map((e=>e.hash)),{logId:this.id,access:this.access,sortFn:this.options.sortFn,length:e,onProgressCallback:this._onLoadProgress.bind(this),timeout:r,concurrency:this.options.replicationConcurrency});this._oplog=s,i.length>0&&await this._updateIndex(),this.events.emit("ready",this.address.toString(),this._oplog.heads)}async sync(e){if(this._stats.syncRequestsReceieved+=1,ro.debug(`Sync request #${this._stats.syncRequestsReceieved} ${e.length}`),0!==e.length)return a(e,(async e=>{if(!e)return console.warn("Warning: Given input entry was 'null'."),Promise.resolve(null);const t=this.identity.provider;if(!t)throw new Error("Identity-provider is required, cannot verify entry");if(!await this.access.canAppend(e,t))return console.warn("Warning: Given input entry is not allowed in this log and was discarded (no write access)."),Promise.resolve(null);const r=wn.toEntry(e);return await un(this._ipfs,yn(r),r,{links:pn,onlyHash:!0})!==e.hash&&console.warn("\"WARNING! Head hash didn't match the contents"),e})).then((async e=>this._replicator.load(e.filter((e=>null!==e)))))}loadMoreFrom(e,t){this._replicator.load(t)}async saveSnapshot(){const e=this._replicator.unfinished,t=this._oplog.toSnapshot(),r=Buffer.from(JSON.stringify({id:t.id,heads:t.heads,size:t.values.length,values:t.values,type:this.type})),n=await this._ipfs.add(r);return n.hash=n.cid.toString(),await this._cache.set(this.snapshotPath,n),await this._cache.set(this.queuePath,e),ro.debug(`Saved snapshot: ${n.hash}, queue length: ${e.length}`),[n]}async loadFromSnapshot(e){this.options.onLoad&&await this.options.onLoad(this),this.events.emit("load",this.address.toString());const t=(e,t)=>Math.max(e,t.clock.time),r=await this._cache.get(this.queuePath);this.sync(r||[]);const n=await this._cache.get(this.snapshotPath);if(!n)throw new Error(`Snapshot for ${this.address} not found!`);{const e=[];for await(const t of this._ipfs.cat(n.hash))e.push(t);const r=Buffer.concat(e),o=JSON.parse(r.toString());this._recalculateReplicationMax(o.values.reduce(t,0)),o&&(this._oplog=await Qn.fromJSON(this._ipfs,this.identity,o,{access:this.access,sortFn:this.options.sortFn,length:-1,timeout:1e3,onProgressCallback:this._onLoadProgress.bind(this)}),await this._updateIndex(),this.events.emit("replicated",this.address.toString())),this.events.emit("ready",this.address.toString(),this._oplog.heads)}return this}async _updateIndex(){await this._index.updateIndex(this._oplog)}async syncLocal(){const e=await this._cache.get(this.localHeadsPath)||[],t=await this._cache.get(this.remoteHeadsPath)||[],r=e.concat(t);for(let e=0;e<r.length;e++){const t=r[e];if(!this._oplog.heads.includes(t)){await this.load();break}}}async _addOperation(e,{onProgressCallback:t,pin:r=!1}={}){return this._queue.add(async function(){if(this._oplog){this.options.syncLocal&&await this.syncLocal();const n=await this._oplog.append(e,this.options.referenceCount,r);return this._recalculateReplicationStatus(n.clock.time),await this._cache.set(this.localHeadsPath,[n]),await this._updateIndex(),this.events.emit("write",this.address.toString(),n,this._oplog.heads),t&&t(n),n.hash}}.bind(this))}_addOperationBatch(e,t,r,n){throw new Error("Not implemented!")}_procEntry(e){const{payload:t,hash:r}=e,{op:n}=t;n?this.events.emit(`log.op.${n}`,this.address.toString(),r,t):this.events.emit("log.op.none",this.address.toString(),r,t),this.events.emit("log.op",n,this.address.toString(),r,t)}_recalculateReplicationProgress(){this._replicationStatus.progress=Math.max(Math.min(this._replicationStatus.progress+1,this._replicationStatus.max),this._oplog?this._oplog.length:0)}_recalculateReplicationMax(e){this._replicationStatus.max=Math.max.apply(null,[this.replicationStatus.max,this._oplog?this._oplog.length:0,e||0])}_recalculateReplicationStatus(e){this._recalculateReplicationMax(e),this._recalculateReplicationProgress()}_onLoadProgress(e){this._recalculateReplicationStatus(e.clock.time),this.events.emit("load.progress",this.address.toString(),e.hash,e,this.replicationStatus.progress,this.replicationStatus.max)}}})(),Store=n})();
//# sourceMappingURL=orbit-db-store.min.js.map